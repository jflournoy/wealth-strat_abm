(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function s(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(i){if(i.ep)return;i.ep=!0;const l=s(i);fetch(i.href,l)}})();function Hn(n,o){return n==null||o==null?NaN:n<o?-1:n>o?1:n>=o?0:NaN}function Sr(n,o){return n==null||o==null?NaN:o<n?-1:o>n?1:o>=n?0:NaN}function cr(n){let o,s,r;n.length!==2?(o=Hn,s=(h,d)=>Hn(n(h),d),r=(h,d)=>n(h)-d):(o=n===Hn||n===Sr?n:jr,s=n,r=n);function i(h,d,f=0,e=h.length){if(f<e){if(o(d,d)!==0)return e;do{const t=f+e>>>1;s(h[t],d)<0?f=t+1:e=t}while(f<e)}return f}function l(h,d,f=0,e=h.length){if(f<e){if(o(d,d)!==0)return e;do{const t=f+e>>>1;s(h[t],d)<=0?f=t+1:e=t}while(f<e)}return f}function c(h,d,f=0,e=h.length){const t=i(h,d,f,e-1);return t>f&&r(h[t-1],d)>-r(h[t],d)?t-1:t}return{left:i,center:c,right:l}}function jr(){return 0}function nt(n){return n===null?NaN:+n}const et=cr(Hn),lr=et.right;cr(nt).center;function rt(n,o){let s=0;for(let r of n)r!=null&&(r=+r)>=r&&++s;return s}function Nn(n,o){let s,r;if(o===void 0)for(const i of n)i!=null&&(s===void 0?i>=i&&(s=r=i):(s>i&&(s=i),r<i&&(r=i)));else{let i=-1;for(let l of n)(l=o(l,++i,n))!=null&&(s===void 0?l>=l&&(s=r=l):(s>l&&(s=l),r<l&&(r=l)))}return[s,r]}function tt(n){return n}var it=Array.prototype,ot=it.slice;function ae(n){return()=>n}const ft=Math.sqrt(50),ut=Math.sqrt(10),at=Math.sqrt(2);function Wn(n,o,s){const r=(o-n)/Math.max(0,s),i=Math.floor(Math.log10(r)),l=r/Math.pow(10,i),c=l>=ft?10:l>=ut?5:l>=at?2:1;let h,d,f;return i<0?(f=Math.pow(10,-i)/c,h=Math.round(n*f),d=Math.round(o*f),h/f<n&&++h,d/f>o&&--d,f=-f):(f=Math.pow(10,i)*c,h=Math.round(n/f),d=Math.round(o/f),h*f<n&&++h,d*f>o&&--d),d<h&&.5<=s&&s<2?Wn(n,o,s*2):[h,d,f]}function dr(n,o,s){if(o=+o,n=+n,s=+s,!(s>0))return[];if(n===o)return[n];const r=o<n,[i,l,c]=r?Wn(o,n,s):Wn(n,o,s);if(!(l>=i))return[];const h=l-i+1,d=new Array(h);if(r)if(c<0)for(let f=0;f<h;++f)d[f]=(l-f)/-c;else for(let f=0;f<h;++f)d[f]=(l-f)*c;else if(c<0)for(let f=0;f<h;++f)d[f]=(i+f)/-c;else for(let f=0;f<h;++f)d[f]=(i+f)*c;return d}function hn(n,o,s){return o=+o,n=+n,s=+s,Wn(n,o,s)[2]}function st(n,o,s){o=+o,n=+n,s=+s;const r=o<n,i=r?hn(o,n,s):hn(n,o,s);return(r?-1:1)*(i<0?1/-i:i)}function ct(n,o,s){let r;for(;;){const i=hn(n,o,s);if(i===r||i===0||!isFinite(i))return[n,o];i>0?(n=Math.floor(n/i)*i,o=Math.ceil(o/i)*i):i<0&&(n=Math.ceil(n*i)/i,o=Math.floor(o*i)/i),r=i}}function lt(n){return Math.max(1,Math.ceil(Math.log(rt(n))/Math.LN2)+1)}function dt(){var n=tt,o=Nn,s=lt;function r(i){Array.isArray(i)||(i=Array.from(i));var l,c=i.length,h,d,f=new Array(c);for(l=0;l<c;++l)f[l]=n(i[l],l,i);var e=o(f),t=e[0],u=e[1],a=s(f,t,u);if(!Array.isArray(a)){const p=u,b=+a;if(o===Nn&&([t,u]=ct(t,u,b)),a=dr(t,u,b),a[0]<=t&&(d=hn(t,u,b)),a[a.length-1]>=u)if(p>=u&&o===Nn){const _=hn(t,u,b);isFinite(_)&&(_>0?u=(Math.floor(u/_)+1)*_:_<0&&(u=(Math.ceil(u*-_)+1)/-_))}else a.pop()}for(var m=a.length,v=0,g=m;a[v]<=t;)++v;for(;a[g-1]>u;)--g;(v||g<m)&&(a=a.slice(v,g),m=g-v);var y=new Array(m+1),w;for(l=0;l<=m;++l)w=y[l]=[],w.x0=l>0?a[l-1]:t,w.x1=l<m?a[l]:u;if(isFinite(d)){if(d>0)for(l=0;l<c;++l)(h=f[l])!=null&&t<=h&&h<=u&&y[Math.min(m,Math.floor((h-t)/d))].push(i[l]);else if(d<0){for(l=0;l<c;++l)if((h=f[l])!=null&&t<=h&&h<=u){const p=Math.floor((t-h)*d);y[Math.min(m,p+(a[p]<=h))].push(i[l])}}}else for(l=0;l<c;++l)(h=f[l])!=null&&t<=h&&h<=u&&y[lr(a,h,0,m)].push(i[l]);return y}return r.value=function(i){return arguments.length?(n=typeof i=="function"?i:ae(i),r):n},r.domain=function(i){return arguments.length?(o=typeof i=="function"?i:ae([i[0],i[1]]),r):o},r.thresholds=function(i){return arguments.length?(s=typeof i=="function"?i:ae(Array.isArray(i)?ot.call(i):i),r):s},r}function Oe(n,o){let s;if(o===void 0)for(const r of n)r!=null&&(s<r||s===void 0&&r>=r)&&(s=r);else{let r=-1;for(let i of n)(i=o(i,++r,n))!=null&&(s<i||s===void 0&&i>=i)&&(s=i)}return s}function ht(n,o){let s;for(const r of n)r!=null&&(s>r||s===void 0&&r>=r)&&(s=r);return s}function mt(n,o,s){n=+n,o=+o,s=(i=arguments.length)<2?(o=n,n=0,1):i<3?1:+s;for(var r=-1,i=Math.max(0,Math.ceil((o-n)/s))|0,l=new Array(i);++r<i;)l[r]=n+r*s;return l}function vt(n,o){let s=0;if(o===void 0)for(let r of n)(r=+r)&&(s+=r);else{let r=-1;for(let i of n)(i=+o(i,++r,n))&&(s+=i)}return s}function gt(n){return n}var se=1,ce=2,he=3,xn=4,Ge=1e-6;function pt(n){return"translate("+n+",0)"}function yt(n){return"translate(0,"+n+")"}function wt(n){return o=>+n(o)}function bt(n,o){return o=Math.max(0,n.bandwidth()-o*2)/2,n.round()&&(o=Math.round(o)),s=>+n(s)+o}function _t(){return!this.__axis}function hr(n,o){var s=[],r=null,i=null,l=6,c=6,h=3,d=typeof window<"u"&&window.devicePixelRatio>1?0:.5,f=n===se||n===xn?-1:1,e=n===xn||n===ce?"x":"y",t=n===se||n===he?pt:yt;function u(a){var m=r??(o.ticks?o.ticks.apply(o,s):o.domain()),v=i??(o.tickFormat?o.tickFormat.apply(o,s):gt),g=Math.max(l,0)+h,y=o.range(),w=+y[0]+d,p=+y[y.length-1]+d,b=(o.bandwidth?bt:wt)(o.copy(),d),_=a.selection?a.selection():a,x=_.selectAll(".domain").data([null]),k=_.selectAll(".tick").data(m,o).order(),E=k.exit(),N=k.enter().append("g").attr("class","tick"),$=k.select("line"),A=k.select("text");x=x.merge(x.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),k=k.merge(N),$=$.merge(N.append("line").attr("stroke","currentColor").attr(e+"2",f*l)),A=A.merge(N.append("text").attr("fill","currentColor").attr(e,f*g).attr("dy",n===se?"0em":n===he?"0.71em":"0.32em")),a!==_&&(x=x.transition(a),k=k.transition(a),$=$.transition(a),A=A.transition(a),E=E.transition(a).attr("opacity",Ge).attr("transform",function(q){return isFinite(q=b(q))?t(q+d):this.getAttribute("transform")}),N.attr("opacity",Ge).attr("transform",function(q){var I=this.parentNode.__axis;return t((I&&isFinite(I=I(q))?I:b(q))+d)})),E.remove(),x.attr("d",n===xn||n===ce?c?"M"+f*c+","+w+"H"+d+"V"+p+"H"+f*c:"M"+d+","+w+"V"+p:c?"M"+w+","+f*c+"V"+d+"H"+p+"V"+f*c:"M"+w+","+d+"H"+p),k.attr("opacity",1).attr("transform",function(q){return t(b(q)+d)}),$.attr(e+"2",f*l),A.attr(e,f*g).text(v),_.filter(_t).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",n===ce?"start":n===xn?"end":"middle"),_.each(function(){this.__axis=b})}return u.scale=function(a){return arguments.length?(o=a,u):o},u.ticks=function(){return s=Array.from(arguments),u},u.tickArguments=function(a){return arguments.length?(s=a==null?[]:Array.from(a),u):s.slice()},u.tickValues=function(a){return arguments.length?(r=a==null?null:Array.from(a),u):r&&r.slice()},u.tickFormat=function(a){return arguments.length?(i=a,u):i},u.tickSize=function(a){return arguments.length?(l=c=+a,u):l},u.tickSizeInner=function(a){return arguments.length?(l=+a,u):l},u.tickSizeOuter=function(a){return arguments.length?(c=+a,u):c},u.tickPadding=function(a){return arguments.length?(h=+a,u):h},u.offset=function(a){return arguments.length?(d=+a,u):d},u}function Dn(n){return hr(he,n)}function Ee(n){return hr(xn,n)}var xt={value:()=>{}};function mr(){for(var n=0,o=arguments.length,s={},r;n<o;++n){if(!(r=arguments[n]+"")||r in s||/[\s.]/.test(r))throw new Error("illegal type: "+r);s[r]=[]}return new On(s)}function On(n){this._=n}function kt(n,o){return n.trim().split(/^|\s+/).map(function(s){var r="",i=s.indexOf(".");if(i>=0&&(r=s.slice(i+1),s=s.slice(0,i)),s&&!o.hasOwnProperty(s))throw new Error("unknown type: "+s);return{type:s,name:r}})}On.prototype=mr.prototype={constructor:On,on:function(n,o){var s=this._,r=kt(n+"",s),i,l=-1,c=r.length;if(arguments.length<2){for(;++l<c;)if((i=(n=r[l]).type)&&(i=Et(s[i],n.name)))return i;return}if(o!=null&&typeof o!="function")throw new Error("invalid callback: "+o);for(;++l<c;)if(i=(n=r[l]).type)s[i]=Be(s[i],n.name,o);else if(o==null)for(i in s)s[i]=Be(s[i],n.name,null);return this},copy:function(){var n={},o=this._;for(var s in o)n[s]=o[s].slice();return new On(n)},call:function(n,o){if((i=arguments.length-2)>0)for(var s=new Array(i),r=0,i,l;r<i;++r)s[r]=arguments[r+2];if(!this._.hasOwnProperty(n))throw new Error("unknown type: "+n);for(l=this._[n],r=0,i=l.length;r<i;++r)l[r].value.apply(o,s)},apply:function(n,o,s){if(!this._.hasOwnProperty(n))throw new Error("unknown type: "+n);for(var r=this._[n],i=0,l=r.length;i<l;++i)r[i].value.apply(o,s)}};function Et(n,o){for(var s=0,r=n.length,i;s<r;++s)if((i=n[s]).name===o)return i.value}function Be(n,o,s){for(var r=0,i=n.length;r<i;++r)if(n[r].name===o){n[r]=xt,n=n.slice(0,r).concat(n.slice(r+1));break}return s!=null&&n.push({name:o,value:s}),n}var me="http://www.w3.org/1999/xhtml";const Ve={svg:"http://www.w3.org/2000/svg",xhtml:me,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function ee(n){var o=n+="",s=o.indexOf(":");return s>=0&&(o=n.slice(0,s))!=="xmlns"&&(n=n.slice(s+1)),Ve.hasOwnProperty(o)?{space:Ve[o],local:n}:n}function At(n){return function(){var o=this.ownerDocument,s=this.namespaceURI;return s===me&&o.documentElement.namespaceURI===me?o.createElement(n):o.createElementNS(s,n)}}function Nt(n){return function(){return this.ownerDocument.createElementNS(n.space,n.local)}}function vr(n){var o=ee(n);return(o.local?Nt:At)(o)}function $t(){}function Ae(n){return n==null?$t:function(){return this.querySelector(n)}}function qt(n){typeof n!="function"&&(n=Ae(n));for(var o=this._groups,s=o.length,r=new Array(s),i=0;i<s;++i)for(var l=o[i],c=l.length,h=r[i]=new Array(c),d,f,e=0;e<c;++e)(d=l[e])&&(f=n.call(d,d.__data__,e,l))&&("__data__"in d&&(f.__data__=d.__data__),h[e]=f);return new F(r,this._parents)}function It(n){return n==null?[]:Array.isArray(n)?n:Array.from(n)}function Rt(){return[]}function gr(n){return n==null?Rt:function(){return this.querySelectorAll(n)}}function Pt(n){return function(){return It(n.apply(this,arguments))}}function Tt(n){typeof n=="function"?n=Pt(n):n=gr(n);for(var o=this._groups,s=o.length,r=[],i=[],l=0;l<s;++l)for(var c=o[l],h=c.length,d,f=0;f<h;++f)(d=c[f])&&(r.push(n.call(d,d.__data__,f,c)),i.push(d));return new F(r,i)}function pr(n){return function(){return this.matches(n)}}function yr(n){return function(o){return o.matches(n)}}var Ct=Array.prototype.find;function zt(n){return function(){return Ct.call(this.children,n)}}function Ft(){return this.firstElementChild}function Lt(n){return this.select(n==null?Ft:zt(typeof n=="function"?n:yr(n)))}var Ht=Array.prototype.filter;function Ot(){return Array.from(this.children)}function Gt(n){return function(){return Ht.call(this.children,n)}}function Bt(n){return this.selectAll(n==null?Ot:Gt(typeof n=="function"?n:yr(n)))}function Vt(n){typeof n!="function"&&(n=pr(n));for(var o=this._groups,s=o.length,r=new Array(s),i=0;i<s;++i)for(var l=o[i],c=l.length,h=r[i]=[],d,f=0;f<c;++f)(d=l[f])&&n.call(d,d.__data__,f,l)&&h.push(d);return new F(r,this._parents)}function wr(n){return new Array(n.length)}function Wt(){return new F(this._enter||this._groups.map(wr),this._parents)}function Un(n,o){this.ownerDocument=n.ownerDocument,this.namespaceURI=n.namespaceURI,this._next=null,this._parent=n,this.__data__=o}Un.prototype={constructor:Un,appendChild:function(n){return this._parent.insertBefore(n,this._next)},insertBefore:function(n,o){return this._parent.insertBefore(n,o)},querySelector:function(n){return this._parent.querySelector(n)},querySelectorAll:function(n){return this._parent.querySelectorAll(n)}};function Dt(n){return function(){return n}}function Ut(n,o,s,r,i,l){for(var c=0,h,d=o.length,f=l.length;c<f;++c)(h=o[c])?(h.__data__=l[c],r[c]=h):s[c]=new Un(n,l[c]);for(;c<d;++c)(h=o[c])&&(i[c]=h)}function Qt(n,o,s,r,i,l,c){var h,d,f=new Map,e=o.length,t=l.length,u=new Array(e),a;for(h=0;h<e;++h)(d=o[h])&&(u[h]=a=c.call(d,d.__data__,h,o)+"",f.has(a)?i[h]=d:f.set(a,d));for(h=0;h<t;++h)a=c.call(n,l[h],h,l)+"",(d=f.get(a))?(r[h]=d,d.__data__=l[h],f.delete(a)):s[h]=new Un(n,l[h]);for(h=0;h<e;++h)(d=o[h])&&f.get(u[h])===d&&(i[h]=d)}function Yt(n){return n.__data__}function Kt(n,o){if(!arguments.length)return Array.from(this,Yt);var s=o?Qt:Ut,r=this._parents,i=this._groups;typeof n!="function"&&(n=Dt(n));for(var l=i.length,c=new Array(l),h=new Array(l),d=new Array(l),f=0;f<l;++f){var e=r[f],t=i[f],u=t.length,a=Jt(n.call(e,e&&e.__data__,f,r)),m=a.length,v=h[f]=new Array(m),g=c[f]=new Array(m),y=d[f]=new Array(u);s(e,t,v,g,y,a,o);for(var w=0,p=0,b,_;w<m;++w)if(b=v[w]){for(w>=p&&(p=w+1);!(_=g[p])&&++p<m;);b._next=_||null}}return c=new F(c,r),c._enter=h,c._exit=d,c}function Jt(n){return typeof n=="object"&&"length"in n?n:Array.from(n)}function Zt(){return new F(this._exit||this._groups.map(wr),this._parents)}function Xt(n,o,s){var r=this.enter(),i=this,l=this.exit();return typeof n=="function"?(r=n(r),r&&(r=r.selection())):r=r.append(n+""),o!=null&&(i=o(i),i&&(i=i.selection())),s==null?l.remove():s(l),r&&i?r.merge(i).order():i}function Mt(n){for(var o=n.selection?n.selection():n,s=this._groups,r=o._groups,i=s.length,l=r.length,c=Math.min(i,l),h=new Array(i),d=0;d<c;++d)for(var f=s[d],e=r[d],t=f.length,u=h[d]=new Array(t),a,m=0;m<t;++m)(a=f[m]||e[m])&&(u[m]=a);for(;d<i;++d)h[d]=s[d];return new F(h,this._parents)}function St(){for(var n=this._groups,o=-1,s=n.length;++o<s;)for(var r=n[o],i=r.length-1,l=r[i],c;--i>=0;)(c=r[i])&&(l&&c.compareDocumentPosition(l)^4&&l.parentNode.insertBefore(c,l),l=c);return this}function jt(n){n||(n=ni);function o(t,u){return t&&u?n(t.__data__,u.__data__):!t-!u}for(var s=this._groups,r=s.length,i=new Array(r),l=0;l<r;++l){for(var c=s[l],h=c.length,d=i[l]=new Array(h),f,e=0;e<h;++e)(f=c[e])&&(d[e]=f);d.sort(o)}return new F(i,this._parents).order()}function ni(n,o){return n<o?-1:n>o?1:n>=o?0:NaN}function ei(){var n=arguments[0];return arguments[0]=this,n.apply(null,arguments),this}function ri(){return Array.from(this)}function ti(){for(var n=this._groups,o=0,s=n.length;o<s;++o)for(var r=n[o],i=0,l=r.length;i<l;++i){var c=r[i];if(c)return c}return null}function ii(){let n=0;for(const o of this)++n;return n}function oi(){return!this.node()}function fi(n){for(var o=this._groups,s=0,r=o.length;s<r;++s)for(var i=o[s],l=0,c=i.length,h;l<c;++l)(h=i[l])&&n.call(h,h.__data__,l,i);return this}function ui(n){return function(){this.removeAttribute(n)}}function ai(n){return function(){this.removeAttributeNS(n.space,n.local)}}function si(n,o){return function(){this.setAttribute(n,o)}}function ci(n,o){return function(){this.setAttributeNS(n.space,n.local,o)}}function li(n,o){return function(){var s=o.apply(this,arguments);s==null?this.removeAttribute(n):this.setAttribute(n,s)}}function di(n,o){return function(){var s=o.apply(this,arguments);s==null?this.removeAttributeNS(n.space,n.local):this.setAttributeNS(n.space,n.local,s)}}function hi(n,o){var s=ee(n);if(arguments.length<2){var r=this.node();return s.local?r.getAttributeNS(s.space,s.local):r.getAttribute(s)}return this.each((o==null?s.local?ai:ui:typeof o=="function"?s.local?di:li:s.local?ci:si)(s,o))}function br(n){return n.ownerDocument&&n.ownerDocument.defaultView||n.document&&n||n.defaultView}function mi(n){return function(){this.style.removeProperty(n)}}function vi(n,o,s){return function(){this.style.setProperty(n,o,s)}}function gi(n,o,s){return function(){var r=o.apply(this,arguments);r==null?this.style.removeProperty(n):this.style.setProperty(n,r,s)}}function pi(n,o,s){return arguments.length>1?this.each((o==null?mi:typeof o=="function"?gi:vi)(n,o,s??"")):mn(this.node(),n)}function mn(n,o){return n.style.getPropertyValue(o)||br(n).getComputedStyle(n,null).getPropertyValue(o)}function yi(n){return function(){delete this[n]}}function wi(n,o){return function(){this[n]=o}}function bi(n,o){return function(){var s=o.apply(this,arguments);s==null?delete this[n]:this[n]=s}}function _i(n,o){return arguments.length>1?this.each((o==null?yi:typeof o=="function"?bi:wi)(n,o)):this.node()[n]}function _r(n){return n.trim().split(/^|\s+/)}function Ne(n){return n.classList||new xr(n)}function xr(n){this._node=n,this._names=_r(n.getAttribute("class")||"")}xr.prototype={add:function(n){var o=this._names.indexOf(n);o<0&&(this._names.push(n),this._node.setAttribute("class",this._names.join(" ")))},remove:function(n){var o=this._names.indexOf(n);o>=0&&(this._names.splice(o,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(n){return this._names.indexOf(n)>=0}};function kr(n,o){for(var s=Ne(n),r=-1,i=o.length;++r<i;)s.add(o[r])}function Er(n,o){for(var s=Ne(n),r=-1,i=o.length;++r<i;)s.remove(o[r])}function xi(n){return function(){kr(this,n)}}function ki(n){return function(){Er(this,n)}}function Ei(n,o){return function(){(o.apply(this,arguments)?kr:Er)(this,n)}}function Ai(n,o){var s=_r(n+"");if(arguments.length<2){for(var r=Ne(this.node()),i=-1,l=s.length;++i<l;)if(!r.contains(s[i]))return!1;return!0}return this.each((typeof o=="function"?Ei:o?xi:ki)(s,o))}function Ni(){this.textContent=""}function $i(n){return function(){this.textContent=n}}function qi(n){return function(){var o=n.apply(this,arguments);this.textContent=o??""}}function Ii(n){return arguments.length?this.each(n==null?Ni:(typeof n=="function"?qi:$i)(n)):this.node().textContent}function Ri(){this.innerHTML=""}function Pi(n){return function(){this.innerHTML=n}}function Ti(n){return function(){var o=n.apply(this,arguments);this.innerHTML=o??""}}function Ci(n){return arguments.length?this.each(n==null?Ri:(typeof n=="function"?Ti:Pi)(n)):this.node().innerHTML}function zi(){this.nextSibling&&this.parentNode.appendChild(this)}function Fi(){return this.each(zi)}function Li(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Hi(){return this.each(Li)}function Oi(n){var o=typeof n=="function"?n:vr(n);return this.select(function(){return this.appendChild(o.apply(this,arguments))})}function Gi(){return null}function Bi(n,o){var s=typeof n=="function"?n:vr(n),r=o==null?Gi:typeof o=="function"?o:Ae(o);return this.select(function(){return this.insertBefore(s.apply(this,arguments),r.apply(this,arguments)||null)})}function Vi(){var n=this.parentNode;n&&n.removeChild(this)}function Wi(){return this.each(Vi)}function Di(){var n=this.cloneNode(!1),o=this.parentNode;return o?o.insertBefore(n,this.nextSibling):n}function Ui(){var n=this.cloneNode(!0),o=this.parentNode;return o?o.insertBefore(n,this.nextSibling):n}function Qi(n){return this.select(n?Ui:Di)}function Yi(n){return arguments.length?this.property("__data__",n):this.node().__data__}function Ki(n){return function(o){n.call(this,o,this.__data__)}}function Ji(n){return n.trim().split(/^|\s+/).map(function(o){var s="",r=o.indexOf(".");return r>=0&&(s=o.slice(r+1),o=o.slice(0,r)),{type:o,name:s}})}function Zi(n){return function(){var o=this.__on;if(o){for(var s=0,r=-1,i=o.length,l;s<i;++s)l=o[s],(!n.type||l.type===n.type)&&l.name===n.name?this.removeEventListener(l.type,l.listener,l.options):o[++r]=l;++r?o.length=r:delete this.__on}}}function Xi(n,o,s){return function(){var r=this.__on,i,l=Ki(o);if(r){for(var c=0,h=r.length;c<h;++c)if((i=r[c]).type===n.type&&i.name===n.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=l,i.options=s),i.value=o;return}}this.addEventListener(n.type,l,s),i={type:n.type,name:n.name,value:o,listener:l,options:s},r?r.push(i):this.__on=[i]}}function Mi(n,o,s){var r=Ji(n+""),i,l=r.length,c;if(arguments.length<2){var h=this.node().__on;if(h){for(var d=0,f=h.length,e;d<f;++d)for(i=0,e=h[d];i<l;++i)if((c=r[i]).type===e.type&&c.name===e.name)return e.value}return}for(h=o?Xi:Zi,i=0;i<l;++i)this.each(h(r[i],o,s));return this}function Ar(n,o,s){var r=br(n),i=r.CustomEvent;typeof i=="function"?i=new i(o,s):(i=r.document.createEvent("Event"),s?(i.initEvent(o,s.bubbles,s.cancelable),i.detail=s.detail):i.initEvent(o,!1,!1)),n.dispatchEvent(i)}function Si(n,o){return function(){return Ar(this,n,o)}}function ji(n,o){return function(){return Ar(this,n,o.apply(this,arguments))}}function no(n,o){return this.each((typeof o=="function"?ji:Si)(n,o))}function*eo(){for(var n=this._groups,o=0,s=n.length;o<s;++o)for(var r=n[o],i=0,l=r.length,c;i<l;++i)(c=r[i])&&(yield c)}var Nr=[null];function F(n,o){this._groups=n,this._parents=o}function Rn(){return new F([[document.documentElement]],Nr)}function ro(){return this}F.prototype=Rn.prototype={constructor:F,select:qt,selectAll:Tt,selectChild:Lt,selectChildren:Bt,filter:Vt,data:Kt,enter:Wt,exit:Zt,join:Xt,merge:Mt,selection:ro,order:St,sort:jt,call:ei,nodes:ri,node:ti,size:ii,empty:oi,each:fi,attr:hi,style:pi,property:_i,classed:Ai,text:Ii,html:Ci,raise:Fi,lower:Hi,append:Oi,insert:Bi,remove:Wi,clone:Qi,datum:Yi,on:Mi,dispatch:no,[Symbol.iterator]:eo};function $e(n){return typeof n=="string"?new F([[document.querySelector(n)]],[document.documentElement]):new F([[n]],Nr)}function qe(n,o,s){n.prototype=o.prototype=s,s.constructor=n}function $r(n,o){var s=Object.create(n.prototype);for(var r in o)s[r]=o[r];return s}function Pn(){}var $n=.7,Qn=1/$n,cn="\\s*([+-]?\\d+)\\s*",qn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Q="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",to=/^#([0-9a-f]{3,8})$/,io=new RegExp(`^rgb\\(${cn},${cn},${cn}\\)$`),oo=new RegExp(`^rgb\\(${Q},${Q},${Q}\\)$`),fo=new RegExp(`^rgba\\(${cn},${cn},${cn},${qn}\\)$`),uo=new RegExp(`^rgba\\(${Q},${Q},${Q},${qn}\\)$`),ao=new RegExp(`^hsl\\(${qn},${Q},${Q}\\)$`),so=new RegExp(`^hsla\\(${qn},${Q},${Q},${qn}\\)$`),We={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};qe(Pn,tn,{copy(n){return Object.assign(new this.constructor,this,n)},displayable(){return this.rgb().displayable()},hex:De,formatHex:De,formatHex8:co,formatHsl:lo,formatRgb:Ue,toString:Ue});function De(){return this.rgb().formatHex()}function co(){return this.rgb().formatHex8()}function lo(){return qr(this).formatHsl()}function Ue(){return this.rgb().formatRgb()}function tn(n){var o,s;return n=(n+"").trim().toLowerCase(),(o=to.exec(n))?(s=o[1].length,o=parseInt(o[1],16),s===6?Qe(o):s===3?new z(o>>8&15|o>>4&240,o>>4&15|o&240,(o&15)<<4|o&15,1):s===8?Tn(o>>24&255,o>>16&255,o>>8&255,(o&255)/255):s===4?Tn(o>>12&15|o>>8&240,o>>8&15|o>>4&240,o>>4&15|o&240,((o&15)<<4|o&15)/255):null):(o=io.exec(n))?new z(o[1],o[2],o[3],1):(o=oo.exec(n))?new z(o[1]*255/100,o[2]*255/100,o[3]*255/100,1):(o=fo.exec(n))?Tn(o[1],o[2],o[3],o[4]):(o=uo.exec(n))?Tn(o[1]*255/100,o[2]*255/100,o[3]*255/100,o[4]):(o=ao.exec(n))?Je(o[1],o[2]/100,o[3]/100,1):(o=so.exec(n))?Je(o[1],o[2]/100,o[3]/100,o[4]):We.hasOwnProperty(n)?Qe(We[n]):n==="transparent"?new z(NaN,NaN,NaN,0):null}function Qe(n){return new z(n>>16&255,n>>8&255,n&255,1)}function Tn(n,o,s,r){return r<=0&&(n=o=s=NaN),new z(n,o,s,r)}function ho(n){return n instanceof Pn||(n=tn(n)),n?(n=n.rgb(),new z(n.r,n.g,n.b,n.opacity)):new z}function ve(n,o,s,r){return arguments.length===1?ho(n):new z(n,o,s,r??1)}function z(n,o,s,r){this.r=+n,this.g=+o,this.b=+s,this.opacity=+r}qe(z,ve,$r(Pn,{brighter(n){return n=n==null?Qn:Math.pow(Qn,n),new z(this.r*n,this.g*n,this.b*n,this.opacity)},darker(n){return n=n==null?$n:Math.pow($n,n),new z(this.r*n,this.g*n,this.b*n,this.opacity)},rgb(){return this},clamp(){return new z(rn(this.r),rn(this.g),rn(this.b),Yn(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ye,formatHex:Ye,formatHex8:mo,formatRgb:Ke,toString:Ke}));function Ye(){return`#${en(this.r)}${en(this.g)}${en(this.b)}`}function mo(){return`#${en(this.r)}${en(this.g)}${en(this.b)}${en((isNaN(this.opacity)?1:this.opacity)*255)}`}function Ke(){const n=Yn(this.opacity);return`${n===1?"rgb(":"rgba("}${rn(this.r)}, ${rn(this.g)}, ${rn(this.b)}${n===1?")":`, ${n})`}`}function Yn(n){return isNaN(n)?1:Math.max(0,Math.min(1,n))}function rn(n){return Math.max(0,Math.min(255,Math.round(n)||0))}function en(n){return n=rn(n),(n<16?"0":"")+n.toString(16)}function Je(n,o,s,r){return r<=0?n=o=s=NaN:s<=0||s>=1?n=o=NaN:o<=0&&(n=NaN),new B(n,o,s,r)}function qr(n){if(n instanceof B)return new B(n.h,n.s,n.l,n.opacity);if(n instanceof Pn||(n=tn(n)),!n)return new B;if(n instanceof B)return n;n=n.rgb();var o=n.r/255,s=n.g/255,r=n.b/255,i=Math.min(o,s,r),l=Math.max(o,s,r),c=NaN,h=l-i,d=(l+i)/2;return h?(o===l?c=(s-r)/h+(s<r)*6:s===l?c=(r-o)/h+2:c=(o-s)/h+4,h/=d<.5?l+i:2-l-i,c*=60):h=d>0&&d<1?0:c,new B(c,h,d,n.opacity)}function vo(n,o,s,r){return arguments.length===1?qr(n):new B(n,o,s,r??1)}function B(n,o,s,r){this.h=+n,this.s=+o,this.l=+s,this.opacity=+r}qe(B,vo,$r(Pn,{brighter(n){return n=n==null?Qn:Math.pow(Qn,n),new B(this.h,this.s,this.l*n,this.opacity)},darker(n){return n=n==null?$n:Math.pow($n,n),new B(this.h,this.s,this.l*n,this.opacity)},rgb(){var n=this.h%360+(this.h<0)*360,o=isNaN(n)||isNaN(this.s)?0:this.s,s=this.l,r=s+(s<.5?s:1-s)*o,i=2*s-r;return new z(le(n>=240?n-240:n+120,i,r),le(n,i,r),le(n<120?n+240:n-120,i,r),this.opacity)},clamp(){return new B(Ze(this.h),Cn(this.s),Cn(this.l),Yn(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const n=Yn(this.opacity);return`${n===1?"hsl(":"hsla("}${Ze(this.h)}, ${Cn(this.s)*100}%, ${Cn(this.l)*100}%${n===1?")":`, ${n})`}`}}));function Ze(n){return n=(n||0)%360,n<0?n+360:n}function Cn(n){return Math.max(0,Math.min(1,n||0))}function le(n,o,s){return(n<60?o+(s-o)*n/60:n<180?s:n<240?o+(s-o)*(240-n)/60:o)*255}const Ie=n=>()=>n;function go(n,o){return function(s){return n+s*o}}function po(n,o,s){return n=Math.pow(n,s),o=Math.pow(o,s)-n,s=1/s,function(r){return Math.pow(n+r*o,s)}}function yo(n){return(n=+n)==1?Ir:function(o,s){return s-o?po(o,s,n):Ie(isNaN(o)?s:o)}}function Ir(n,o){var s=o-n;return s?go(n,s):Ie(isNaN(n)?o:n)}const Kn=function n(o){var s=yo(o);function r(i,l){var c=s((i=ve(i)).r,(l=ve(l)).r),h=s(i.g,l.g),d=s(i.b,l.b),f=Ir(i.opacity,l.opacity);return function(e){return i.r=c(e),i.g=h(e),i.b=d(e),i.opacity=f(e),i+""}}return r.gamma=n,r}(1);function wo(n,o){o||(o=[]);var s=n?Math.min(o.length,n.length):0,r=o.slice(),i;return function(l){for(i=0;i<s;++i)r[i]=n[i]*(1-l)+o[i]*l;return r}}function bo(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function _o(n,o){var s=o?o.length:0,r=n?Math.min(s,n.length):0,i=new Array(r),l=new Array(s),c;for(c=0;c<r;++c)i[c]=re(n[c],o[c]);for(;c<s;++c)l[c]=o[c];return function(h){for(c=0;c<r;++c)l[c]=i[c](h);return l}}function xo(n,o){var s=new Date;return n=+n,o=+o,function(r){return s.setTime(n*(1-r)+o*r),s}}function G(n,o){return n=+n,o=+o,function(s){return n*(1-s)+o*s}}function ko(n,o){var s={},r={},i;(n===null||typeof n!="object")&&(n={}),(o===null||typeof o!="object")&&(o={});for(i in o)i in n?s[i]=re(n[i],o[i]):r[i]=o[i];return function(l){for(i in s)r[i]=s[i](l);return r}}var ge=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,de=new RegExp(ge.source,"g");function Eo(n){return function(){return n}}function Ao(n){return function(o){return n(o)+""}}function Rr(n,o){var s=ge.lastIndex=de.lastIndex=0,r,i,l,c=-1,h=[],d=[];for(n=n+"",o=o+"";(r=ge.exec(n))&&(i=de.exec(o));)(l=i.index)>s&&(l=o.slice(s,l),h[c]?h[c]+=l:h[++c]=l),(r=r[0])===(i=i[0])?h[c]?h[c]+=i:h[++c]=i:(h[++c]=null,d.push({i:c,x:G(r,i)})),s=de.lastIndex;return s<o.length&&(l=o.slice(s),h[c]?h[c]+=l:h[++c]=l),h.length<2?d[0]?Ao(d[0].x):Eo(o):(o=d.length,function(f){for(var e=0,t;e<o;++e)h[(t=d[e]).i]=t.x(f);return h.join("")})}function re(n,o){var s=typeof o,r;return o==null||s==="boolean"?Ie(o):(s==="number"?G:s==="string"?(r=tn(o))?(o=r,Kn):Rr:o instanceof tn?Kn:o instanceof Date?xo:bo(o)?wo:Array.isArray(o)?_o:typeof o.valueOf!="function"&&typeof o.toString!="function"||isNaN(o)?ko:G)(n,o)}function Pr(n,o){return n=+n,o=+o,function(s){return Math.round(n*(1-s)+o*s)}}var Xe=180/Math.PI,pe={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Tr(n,o,s,r,i,l){var c,h,d;return(c=Math.sqrt(n*n+o*o))&&(n/=c,o/=c),(d=n*s+o*r)&&(s-=n*d,r-=o*d),(h=Math.sqrt(s*s+r*r))&&(s/=h,r/=h,d/=h),n*r<o*s&&(n=-n,o=-o,d=-d,c=-c),{translateX:i,translateY:l,rotate:Math.atan2(o,n)*Xe,skewX:Math.atan(d)*Xe,scaleX:c,scaleY:h}}var zn;function No(n){const o=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(n+"");return o.isIdentity?pe:Tr(o.a,o.b,o.c,o.d,o.e,o.f)}function $o(n){return n==null||(zn||(zn=document.createElementNS("http://www.w3.org/2000/svg","g")),zn.setAttribute("transform",n),!(n=zn.transform.baseVal.consolidate()))?pe:(n=n.matrix,Tr(n.a,n.b,n.c,n.d,n.e,n.f))}function Cr(n,o,s,r){function i(f){return f.length?f.pop()+" ":""}function l(f,e,t,u,a,m){if(f!==t||e!==u){var v=a.push("translate(",null,o,null,s);m.push({i:v-4,x:G(f,t)},{i:v-2,x:G(e,u)})}else(t||u)&&a.push("translate("+t+o+u+s)}function c(f,e,t,u){f!==e?(f-e>180?e+=360:e-f>180&&(f+=360),u.push({i:t.push(i(t)+"rotate(",null,r)-2,x:G(f,e)})):e&&t.push(i(t)+"rotate("+e+r)}function h(f,e,t,u){f!==e?u.push({i:t.push(i(t)+"skewX(",null,r)-2,x:G(f,e)}):e&&t.push(i(t)+"skewX("+e+r)}function d(f,e,t,u,a,m){if(f!==t||e!==u){var v=a.push(i(a)+"scale(",null,",",null,")");m.push({i:v-4,x:G(f,t)},{i:v-2,x:G(e,u)})}else(t!==1||u!==1)&&a.push(i(a)+"scale("+t+","+u+")")}return function(f,e){var t=[],u=[];return f=n(f),e=n(e),l(f.translateX,f.translateY,e.translateX,e.translateY,t,u),c(f.rotate,e.rotate,t,u),h(f.skewX,e.skewX,t,u),d(f.scaleX,f.scaleY,e.scaleX,e.scaleY,t,u),f=e=null,function(a){for(var m=-1,v=u.length,g;++m<v;)t[(g=u[m]).i]=g.x(a);return t.join("")}}}var qo=Cr(No,"px, ","px)","deg)"),Io=Cr($o,", ",")",")"),vn=0,kn=0,bn=0,zr=1e3,Jn,En,Zn=0,on=0,te=0,In=typeof performance=="object"&&performance.now?performance:Date,Fr=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(n){setTimeout(n,17)};function Re(){return on||(Fr(Ro),on=In.now()+te)}function Ro(){on=0}function Xn(){this._call=this._time=this._next=null}Xn.prototype=Lr.prototype={constructor:Xn,restart:function(n,o,s){if(typeof n!="function")throw new TypeError("callback is not a function");s=(s==null?Re():+s)+(o==null?0:+o),!this._next&&En!==this&&(En?En._next=this:Jn=this,En=this),this._call=n,this._time=s,ye()},stop:function(){this._call&&(this._call=null,this._time=1/0,ye())}};function Lr(n,o,s){var r=new Xn;return r.restart(n,o,s),r}function Po(){Re(),++vn;for(var n=Jn,o;n;)(o=on-n._time)>=0&&n._call.call(void 0,o),n=n._next;--vn}function Me(){on=(Zn=In.now())+te,vn=kn=0;try{Po()}finally{vn=0,Co(),on=0}}function To(){var n=In.now(),o=n-Zn;o>zr&&(te-=o,Zn=n)}function Co(){for(var n,o=Jn,s,r=1/0;o;)o._call?(r>o._time&&(r=o._time),n=o,o=o._next):(s=o._next,o._next=null,o=n?n._next=s:Jn=s);En=n,ye(r)}function ye(n){if(!vn){kn&&(kn=clearTimeout(kn));var o=n-on;o>24?(n<1/0&&(kn=setTimeout(Me,n-In.now()-te)),bn&&(bn=clearInterval(bn))):(bn||(Zn=In.now(),bn=setInterval(To,zr)),vn=1,Fr(Me))}}function Se(n,o,s){var r=new Xn;return o=o==null?0:+o,r.restart(i=>{r.stop(),n(i+o)},o,s),r}var zo=mr("start","end","cancel","interrupt"),Fo=[],Hr=0,je=1,we=2,Gn=3,nr=4,be=5,Bn=6;function ie(n,o,s,r,i,l){var c=n.__transition;if(!c)n.__transition={};else if(s in c)return;Lo(n,s,{name:o,index:r,group:i,on:zo,tween:Fo,time:l.time,delay:l.delay,duration:l.duration,ease:l.ease,timer:null,state:Hr})}function Pe(n,o){var s=V(n,o);if(s.state>Hr)throw new Error("too late; already scheduled");return s}function Y(n,o){var s=V(n,o);if(s.state>Gn)throw new Error("too late; already running");return s}function V(n,o){var s=n.__transition;if(!s||!(s=s[o]))throw new Error("transition not found");return s}function Lo(n,o,s){var r=n.__transition,i;r[o]=s,s.timer=Lr(l,0,s.time);function l(f){s.state=je,s.timer.restart(c,s.delay,s.time),s.delay<=f&&c(f-s.delay)}function c(f){var e,t,u,a;if(s.state!==je)return d();for(e in r)if(a=r[e],a.name===s.name){if(a.state===Gn)return Se(c);a.state===nr?(a.state=Bn,a.timer.stop(),a.on.call("interrupt",n,n.__data__,a.index,a.group),delete r[e]):+e<o&&(a.state=Bn,a.timer.stop(),a.on.call("cancel",n,n.__data__,a.index,a.group),delete r[e])}if(Se(function(){s.state===Gn&&(s.state=nr,s.timer.restart(h,s.delay,s.time),h(f))}),s.state=we,s.on.call("start",n,n.__data__,s.index,s.group),s.state===we){for(s.state=Gn,i=new Array(u=s.tween.length),e=0,t=-1;e<u;++e)(a=s.tween[e].value.call(n,n.__data__,s.index,s.group))&&(i[++t]=a);i.length=t+1}}function h(f){for(var e=f<s.duration?s.ease.call(null,f/s.duration):(s.timer.restart(d),s.state=be,1),t=-1,u=i.length;++t<u;)i[t].call(n,e);s.state===be&&(s.on.call("end",n,n.__data__,s.index,s.group),d())}function d(){s.state=Bn,s.timer.stop(),delete r[o];for(var f in r)return;delete n.__transition}}function Ho(n,o){var s=n.__transition,r,i,l=!0,c;if(s){o=o==null?null:o+"";for(c in s){if((r=s[c]).name!==o){l=!1;continue}i=r.state>we&&r.state<be,r.state=Bn,r.timer.stop(),r.on.call(i?"interrupt":"cancel",n,n.__data__,r.index,r.group),delete s[c]}l&&delete n.__transition}}function Oo(n){return this.each(function(){Ho(this,n)})}function Go(n,o){var s,r;return function(){var i=Y(this,n),l=i.tween;if(l!==s){r=s=l;for(var c=0,h=r.length;c<h;++c)if(r[c].name===o){r=r.slice(),r.splice(c,1);break}}i.tween=r}}function Bo(n,o,s){var r,i;if(typeof s!="function")throw new Error;return function(){var l=Y(this,n),c=l.tween;if(c!==r){i=(r=c).slice();for(var h={name:o,value:s},d=0,f=i.length;d<f;++d)if(i[d].name===o){i[d]=h;break}d===f&&i.push(h)}l.tween=i}}function Vo(n,o){var s=this._id;if(n+="",arguments.length<2){for(var r=V(this.node(),s).tween,i=0,l=r.length,c;i<l;++i)if((c=r[i]).name===n)return c.value;return null}return this.each((o==null?Go:Bo)(s,n,o))}function Te(n,o,s){var r=n._id;return n.each(function(){var i=Y(this,r);(i.value||(i.value={}))[o]=s.apply(this,arguments)}),function(i){return V(i,r).value[o]}}function Or(n,o){var s;return(typeof o=="number"?G:o instanceof tn?Kn:(s=tn(o))?(o=s,Kn):Rr)(n,o)}function Wo(n){return function(){this.removeAttribute(n)}}function Do(n){return function(){this.removeAttributeNS(n.space,n.local)}}function Uo(n,o,s){var r,i=s+"",l;return function(){var c=this.getAttribute(n);return c===i?null:c===r?l:l=o(r=c,s)}}function Qo(n,o,s){var r,i=s+"",l;return function(){var c=this.getAttributeNS(n.space,n.local);return c===i?null:c===r?l:l=o(r=c,s)}}function Yo(n,o,s){var r,i,l;return function(){var c,h=s(this),d;return h==null?void this.removeAttribute(n):(c=this.getAttribute(n),d=h+"",c===d?null:c===r&&d===i?l:(i=d,l=o(r=c,h)))}}function Ko(n,o,s){var r,i,l;return function(){var c,h=s(this),d;return h==null?void this.removeAttributeNS(n.space,n.local):(c=this.getAttributeNS(n.space,n.local),d=h+"",c===d?null:c===r&&d===i?l:(i=d,l=o(r=c,h)))}}function Jo(n,o){var s=ee(n),r=s==="transform"?Io:Or;return this.attrTween(n,typeof o=="function"?(s.local?Ko:Yo)(s,r,Te(this,"attr."+n,o)):o==null?(s.local?Do:Wo)(s):(s.local?Qo:Uo)(s,r,o))}function Zo(n,o){return function(s){this.setAttribute(n,o.call(this,s))}}function Xo(n,o){return function(s){this.setAttributeNS(n.space,n.local,o.call(this,s))}}function Mo(n,o){var s,r;function i(){var l=o.apply(this,arguments);return l!==r&&(s=(r=l)&&Xo(n,l)),s}return i._value=o,i}function So(n,o){var s,r;function i(){var l=o.apply(this,arguments);return l!==r&&(s=(r=l)&&Zo(n,l)),s}return i._value=o,i}function jo(n,o){var s="attr."+n;if(arguments.length<2)return(s=this.tween(s))&&s._value;if(o==null)return this.tween(s,null);if(typeof o!="function")throw new Error;var r=ee(n);return this.tween(s,(r.local?Mo:So)(r,o))}function nf(n,o){return function(){Pe(this,n).delay=+o.apply(this,arguments)}}function ef(n,o){return o=+o,function(){Pe(this,n).delay=o}}function rf(n){var o=this._id;return arguments.length?this.each((typeof n=="function"?nf:ef)(o,n)):V(this.node(),o).delay}function tf(n,o){return function(){Y(this,n).duration=+o.apply(this,arguments)}}function of(n,o){return o=+o,function(){Y(this,n).duration=o}}function ff(n){var o=this._id;return arguments.length?this.each((typeof n=="function"?tf:of)(o,n)):V(this.node(),o).duration}function uf(n,o){if(typeof o!="function")throw new Error;return function(){Y(this,n).ease=o}}function af(n){var o=this._id;return arguments.length?this.each(uf(o,n)):V(this.node(),o).ease}function sf(n,o){return function(){var s=o.apply(this,arguments);if(typeof s!="function")throw new Error;Y(this,n).ease=s}}function cf(n){if(typeof n!="function")throw new Error;return this.each(sf(this._id,n))}function lf(n){typeof n!="function"&&(n=pr(n));for(var o=this._groups,s=o.length,r=new Array(s),i=0;i<s;++i)for(var l=o[i],c=l.length,h=r[i]=[],d,f=0;f<c;++f)(d=l[f])&&n.call(d,d.__data__,f,l)&&h.push(d);return new J(r,this._parents,this._name,this._id)}function df(n){if(n._id!==this._id)throw new Error;for(var o=this._groups,s=n._groups,r=o.length,i=s.length,l=Math.min(r,i),c=new Array(r),h=0;h<l;++h)for(var d=o[h],f=s[h],e=d.length,t=c[h]=new Array(e),u,a=0;a<e;++a)(u=d[a]||f[a])&&(t[a]=u);for(;h<r;++h)c[h]=o[h];return new J(c,this._parents,this._name,this._id)}function hf(n){return(n+"").trim().split(/^|\s+/).every(function(o){var s=o.indexOf(".");return s>=0&&(o=o.slice(0,s)),!o||o==="start"})}function mf(n,o,s){var r,i,l=hf(o)?Pe:Y;return function(){var c=l(this,n),h=c.on;h!==r&&(i=(r=h).copy()).on(o,s),c.on=i}}function vf(n,o){var s=this._id;return arguments.length<2?V(this.node(),s).on.on(n):this.each(mf(s,n,o))}function gf(n){return function(){var o=this.parentNode;for(var s in this.__transition)if(+s!==n)return;o&&o.removeChild(this)}}function pf(){return this.on("end.remove",gf(this._id))}function yf(n){var o=this._name,s=this._id;typeof n!="function"&&(n=Ae(n));for(var r=this._groups,i=r.length,l=new Array(i),c=0;c<i;++c)for(var h=r[c],d=h.length,f=l[c]=new Array(d),e,t,u=0;u<d;++u)(e=h[u])&&(t=n.call(e,e.__data__,u,h))&&("__data__"in e&&(t.__data__=e.__data__),f[u]=t,ie(f[u],o,s,u,f,V(e,s)));return new J(l,this._parents,o,s)}function wf(n){var o=this._name,s=this._id;typeof n!="function"&&(n=gr(n));for(var r=this._groups,i=r.length,l=[],c=[],h=0;h<i;++h)for(var d=r[h],f=d.length,e,t=0;t<f;++t)if(e=d[t]){for(var u=n.call(e,e.__data__,t,d),a,m=V(e,s),v=0,g=u.length;v<g;++v)(a=u[v])&&ie(a,o,s,v,u,m);l.push(u),c.push(e)}return new J(l,c,o,s)}var bf=Rn.prototype.constructor;function _f(){return new bf(this._groups,this._parents)}function xf(n,o){var s,r,i;return function(){var l=mn(this,n),c=(this.style.removeProperty(n),mn(this,n));return l===c?null:l===s&&c===r?i:i=o(s=l,r=c)}}function Gr(n){return function(){this.style.removeProperty(n)}}function kf(n,o,s){var r,i=s+"",l;return function(){var c=mn(this,n);return c===i?null:c===r?l:l=o(r=c,s)}}function Ef(n,o,s){var r,i,l;return function(){var c=mn(this,n),h=s(this),d=h+"";return h==null&&(d=h=(this.style.removeProperty(n),mn(this,n))),c===d?null:c===r&&d===i?l:(i=d,l=o(r=c,h))}}function Af(n,o){var s,r,i,l="style."+o,c="end."+l,h;return function(){var d=Y(this,n),f=d.on,e=d.value[l]==null?h||(h=Gr(o)):void 0;(f!==s||i!==e)&&(r=(s=f).copy()).on(c,i=e),d.on=r}}function Nf(n,o,s){var r=(n+="")=="transform"?qo:Or;return o==null?this.styleTween(n,xf(n,r)).on("end.style."+n,Gr(n)):typeof o=="function"?this.styleTween(n,Ef(n,r,Te(this,"style."+n,o))).each(Af(this._id,n)):this.styleTween(n,kf(n,r,o),s).on("end.style."+n,null)}function $f(n,o,s){return function(r){this.style.setProperty(n,o.call(this,r),s)}}function qf(n,o,s){var r,i;function l(){var c=o.apply(this,arguments);return c!==i&&(r=(i=c)&&$f(n,c,s)),r}return l._value=o,l}function If(n,o,s){var r="style."+(n+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(o==null)return this.tween(r,null);if(typeof o!="function")throw new Error;return this.tween(r,qf(n,o,s??""))}function Rf(n){return function(){this.textContent=n}}function Pf(n){return function(){var o=n(this);this.textContent=o??""}}function Tf(n){return this.tween("text",typeof n=="function"?Pf(Te(this,"text",n)):Rf(n==null?"":n+""))}function Cf(n){return function(o){this.textContent=n.call(this,o)}}function zf(n){var o,s;function r(){var i=n.apply(this,arguments);return i!==s&&(o=(s=i)&&Cf(i)),o}return r._value=n,r}function Ff(n){var o="text";if(arguments.length<1)return(o=this.tween(o))&&o._value;if(n==null)return this.tween(o,null);if(typeof n!="function")throw new Error;return this.tween(o,zf(n))}function Lf(){for(var n=this._name,o=this._id,s=Br(),r=this._groups,i=r.length,l=0;l<i;++l)for(var c=r[l],h=c.length,d,f=0;f<h;++f)if(d=c[f]){var e=V(d,o);ie(d,n,s,f,c,{time:e.time+e.delay+e.duration,delay:0,duration:e.duration,ease:e.ease})}return new J(r,this._parents,n,s)}function Hf(){var n,o,s=this,r=s._id,i=s.size();return new Promise(function(l,c){var h={value:c},d={value:function(){--i===0&&l()}};s.each(function(){var f=Y(this,r),e=f.on;e!==n&&(o=(n=e).copy(),o._.cancel.push(h),o._.interrupt.push(h),o._.end.push(d)),f.on=o}),i===0&&l()})}var Of=0;function J(n,o,s,r){this._groups=n,this._parents=o,this._name=s,this._id=r}function Br(){return++Of}var K=Rn.prototype;J.prototype={constructor:J,select:yf,selectAll:wf,selectChild:K.selectChild,selectChildren:K.selectChildren,filter:lf,merge:df,selection:_f,transition:Lf,call:K.call,nodes:K.nodes,node:K.node,size:K.size,empty:K.empty,each:K.each,on:vf,attr:Jo,attrTween:jo,style:Nf,styleTween:If,text:Tf,textTween:Ff,remove:pf,tween:Vo,delay:rf,duration:ff,ease:af,easeVarying:cf,end:Hf,[Symbol.iterator]:K[Symbol.iterator]};function Gf(n){return((n*=2)<=1?n*n*n:(n-=2)*n*n+2)/2}var Bf={time:null,delay:0,duration:250,ease:Gf};function Vf(n,o){for(var s;!(s=n.__transition)||!(s=s[o]);)if(!(n=n.parentNode))throw new Error(`transition ${o} not found`);return s}function Wf(n){var o,s;n instanceof J?(o=n._id,n=n._name):(o=Br(),(s=Bf).time=Re(),n=n==null?null:n+"");for(var r=this._groups,i=r.length,l=0;l<i;++l)for(var c=r[l],h=c.length,d,f=0;f<h;++f)(d=c[f])&&ie(d,n,o,f,c,s||Vf(d,o));return new J(r,this._parents,n,o)}Rn.prototype.interrupt=Oo;Rn.prototype.transition=Wf;const _e=Math.PI,xe=2*_e,nn=1e-6,Df=xe-nn;function Vr(n){this._+=n[0];for(let o=1,s=n.length;o<s;++o)this._+=arguments[o]+n[o]}function Uf(n){let o=Math.floor(n);if(!(o>=0))throw new Error(`invalid digits: ${n}`);if(o>15)return Vr;const s=10**o;return function(r){this._+=r[0];for(let i=1,l=r.length;i<l;++i)this._+=Math.round(arguments[i]*s)/s+r[i]}}class Qf{constructor(o){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=o==null?Vr:Uf(o)}moveTo(o,s){this._append`M${this._x0=this._x1=+o},${this._y0=this._y1=+s}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(o,s){this._append`L${this._x1=+o},${this._y1=+s}`}quadraticCurveTo(o,s,r,i){this._append`Q${+o},${+s},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(o,s,r,i,l,c){this._append`C${+o},${+s},${+r},${+i},${this._x1=+l},${this._y1=+c}`}arcTo(o,s,r,i,l){if(o=+o,s=+s,r=+r,i=+i,l=+l,l<0)throw new Error(`negative radius: ${l}`);let c=this._x1,h=this._y1,d=r-o,f=i-s,e=c-o,t=h-s,u=e*e+t*t;if(this._x1===null)this._append`M${this._x1=o},${this._y1=s}`;else if(u>nn)if(!(Math.abs(t*d-f*e)>nn)||!l)this._append`L${this._x1=o},${this._y1=s}`;else{let a=r-c,m=i-h,v=d*d+f*f,g=a*a+m*m,y=Math.sqrt(v),w=Math.sqrt(u),p=l*Math.tan((_e-Math.acos((v+u-g)/(2*y*w)))/2),b=p/w,_=p/y;Math.abs(b-1)>nn&&this._append`L${o+b*e},${s+b*t}`,this._append`A${l},${l},0,0,${+(t*a>e*m)},${this._x1=o+_*d},${this._y1=s+_*f}`}}arc(o,s,r,i,l,c){if(o=+o,s=+s,r=+r,c=!!c,r<0)throw new Error(`negative radius: ${r}`);let h=r*Math.cos(i),d=r*Math.sin(i),f=o+h,e=s+d,t=1^c,u=c?i-l:l-i;this._x1===null?this._append`M${f},${e}`:(Math.abs(this._x1-f)>nn||Math.abs(this._y1-e)>nn)&&this._append`L${f},${e}`,r&&(u<0&&(u=u%xe+xe),u>Df?this._append`A${r},${r},0,1,${t},${o-h},${s-d}A${r},${r},0,1,${t},${this._x1=f},${this._y1=e}`:u>nn&&this._append`A${r},${r},0,${+(u>=_e)},${t},${this._x1=o+r*Math.cos(l)},${this._y1=s+r*Math.sin(l)}`)}rect(o,s,r,i){this._append`M${this._x0=this._x1=+o},${this._y0=this._y1=+s}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}}function Yf(n){return Math.abs(n=Math.round(n))>=1e21?n.toLocaleString("en").replace(/,/g,""):n.toString(10)}function Mn(n,o){if((s=(n=o?n.toExponential(o-1):n.toExponential()).indexOf("e"))<0)return null;var s,r=n.slice(0,s);return[r.length>1?r[0]+r.slice(2):r,+n.slice(s+1)]}function gn(n){return n=Mn(Math.abs(n)),n?n[1]:NaN}function Kf(n,o){return function(s,r){for(var i=s.length,l=[],c=0,h=n[0],d=0;i>0&&h>0&&(d+h+1>r&&(h=Math.max(1,r-d)),l.push(s.substring(i-=h,i+h)),!((d+=h+1)>r));)h=n[c=(c+1)%n.length];return l.reverse().join(o)}}function Jf(n){return function(o){return o.replace(/[0-9]/g,function(s){return n[+s]})}}var Zf=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Sn(n){if(!(o=Zf.exec(n)))throw new Error("invalid format: "+n);var o;return new Ce({fill:o[1],align:o[2],sign:o[3],symbol:o[4],zero:o[5],width:o[6],comma:o[7],precision:o[8]&&o[8].slice(1),trim:o[9],type:o[10]})}Sn.prototype=Ce.prototype;function Ce(n){this.fill=n.fill===void 0?" ":n.fill+"",this.align=n.align===void 0?">":n.align+"",this.sign=n.sign===void 0?"-":n.sign+"",this.symbol=n.symbol===void 0?"":n.symbol+"",this.zero=!!n.zero,this.width=n.width===void 0?void 0:+n.width,this.comma=!!n.comma,this.precision=n.precision===void 0?void 0:+n.precision,this.trim=!!n.trim,this.type=n.type===void 0?"":n.type+""}Ce.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Xf(n){n:for(var o=n.length,s=1,r=-1,i;s<o;++s)switch(n[s]){case".":r=i=s;break;case"0":r===0&&(r=s),i=s;break;default:if(!+n[s])break n;r>0&&(r=0);break}return r>0?n.slice(0,r)+n.slice(i+1):n}var Wr;function Mf(n,o){var s=Mn(n,o);if(!s)return n+"";var r=s[0],i=s[1],l=i-(Wr=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,c=r.length;return l===c?r:l>c?r+new Array(l-c+1).join("0"):l>0?r.slice(0,l)+"."+r.slice(l):"0."+new Array(1-l).join("0")+Mn(n,Math.max(0,o+l-1))[0]}function er(n,o){var s=Mn(n,o);if(!s)return n+"";var r=s[0],i=s[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const rr={"%":(n,o)=>(n*100).toFixed(o),b:n=>Math.round(n).toString(2),c:n=>n+"",d:Yf,e:(n,o)=>n.toExponential(o),f:(n,o)=>n.toFixed(o),g:(n,o)=>n.toPrecision(o),o:n=>Math.round(n).toString(8),p:(n,o)=>er(n*100,o),r:er,s:Mf,X:n=>Math.round(n).toString(16).toUpperCase(),x:n=>Math.round(n).toString(16)};function tr(n){return n}var ir=Array.prototype.map,or=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Sf(n){var o=n.grouping===void 0||n.thousands===void 0?tr:Kf(ir.call(n.grouping,Number),n.thousands+""),s=n.currency===void 0?"":n.currency[0]+"",r=n.currency===void 0?"":n.currency[1]+"",i=n.decimal===void 0?".":n.decimal+"",l=n.numerals===void 0?tr:Jf(ir.call(n.numerals,String)),c=n.percent===void 0?"%":n.percent+"",h=n.minus===void 0?"−":n.minus+"",d=n.nan===void 0?"NaN":n.nan+"";function f(t){t=Sn(t);var u=t.fill,a=t.align,m=t.sign,v=t.symbol,g=t.zero,y=t.width,w=t.comma,p=t.precision,b=t.trim,_=t.type;_==="n"?(w=!0,_="g"):rr[_]||(p===void 0&&(p=12),b=!0,_="g"),(g||u==="0"&&a==="=")&&(g=!0,u="0",a="=");var x=v==="$"?s:v==="#"&&/[boxX]/.test(_)?"0"+_.toLowerCase():"",k=v==="$"?r:/[%p]/.test(_)?c:"",E=rr[_],N=/[defgprs%]/.test(_);p=p===void 0?6:/[gprs]/.test(_)?Math.max(1,Math.min(21,p)):Math.max(0,Math.min(20,p));function $(A){var q=x,I=k,R,W,O;if(_==="c")I=E(A)+I,A="";else{A=+A;var P=A<0||1/A<0;if(A=isNaN(A)?d:E(Math.abs(A),p),b&&(A=Xf(A)),P&&+A==0&&m!=="+"&&(P=!1),q=(P?m==="("?m:h:m==="-"||m==="("?"":m)+q,I=(_==="s"?or[8+Wr/3]:"")+I+(P&&m==="("?")":""),N){for(R=-1,W=A.length;++R<W;)if(O=A.charCodeAt(R),48>O||O>57){I=(O===46?i+A.slice(R+1):A.slice(R))+I,A=A.slice(0,R);break}}}w&&!g&&(A=o(A,1/0));var L=q.length+A.length+I.length,T=L<y?new Array(y-L+1).join(u):"";switch(w&&g&&(A=o(T+A,T.length?y-I.length:1/0),T=""),a){case"<":A=q+A+I+T;break;case"=":A=q+T+A+I;break;case"^":A=T.slice(0,L=T.length>>1)+q+A+I+T.slice(L);break;default:A=T+q+A+I;break}return l(A)}return $.toString=function(){return t+""},$}function e(t,u){var a=f((t=Sn(t),t.type="f",t)),m=Math.max(-8,Math.min(8,Math.floor(gn(u)/3)))*3,v=Math.pow(10,-m),g=or[8+m/3];return function(y){return a(v*y)+g}}return{format:f,formatPrefix:e}}var Fn,ze,Dr;jf({thousands:",",grouping:[3],currency:["$",""]});function jf(n){return Fn=Sf(n),ze=Fn.format,Dr=Fn.formatPrefix,Fn}function nu(n){return Math.max(0,-gn(Math.abs(n)))}function eu(n,o){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(gn(o)/3)))*3-gn(Math.abs(n)))}function ru(n,o){return n=Math.abs(n),o=Math.abs(o)-n,Math.max(0,gn(o)-gn(n))+1}function tu(n,o){switch(arguments.length){case 0:break;case 1:this.range(n);break;default:this.range(o).domain(n);break}return this}function iu(n,o){switch(arguments.length){case 0:break;case 1:{typeof n=="function"?this.interpolator(n):this.range(n);break}default:{this.domain(n),typeof o=="function"?this.interpolator(o):this.range(o);break}}return this}function ou(n){return function(){return n}}function fu(n){return+n}var fr=[0,1];function M(n){return n}function ke(n,o){return(o-=n=+n)?function(s){return(s-n)/o}:ou(isNaN(o)?NaN:.5)}function uu(n,o){var s;return n>o&&(s=n,n=o,o=s),function(r){return Math.max(n,Math.min(o,r))}}function au(n,o,s){var r=n[0],i=n[1],l=o[0],c=o[1];return i<r?(r=ke(i,r),l=s(c,l)):(r=ke(r,i),l=s(l,c)),function(h){return l(r(h))}}function su(n,o,s){var r=Math.min(n.length,o.length)-1,i=new Array(r),l=new Array(r),c=-1;for(n[r]<n[0]&&(n=n.slice().reverse(),o=o.slice().reverse());++c<r;)i[c]=ke(n[c],n[c+1]),l[c]=s(o[c],o[c+1]);return function(h){var d=lr(n,h,1,r)-1;return l[d](i[d](h))}}function cu(n,o){return o.domain(n.domain()).range(n.range()).interpolate(n.interpolate()).clamp(n.clamp()).unknown(n.unknown())}function lu(){var n=fr,o=fr,s=re,r,i,l,c=M,h,d,f;function e(){var u=Math.min(n.length,o.length);return c!==M&&(c=uu(n[0],n[u-1])),h=u>2?su:au,d=f=null,t}function t(u){return u==null||isNaN(u=+u)?l:(d||(d=h(n.map(r),o,s)))(r(c(u)))}return t.invert=function(u){return c(i((f||(f=h(o,n.map(r),G)))(u)))},t.domain=function(u){return arguments.length?(n=Array.from(u,fu),e()):n.slice()},t.range=function(u){return arguments.length?(o=Array.from(u),e()):o.slice()},t.rangeRound=function(u){return o=Array.from(u),s=Pr,e()},t.clamp=function(u){return arguments.length?(c=u?!0:M,e()):c!==M},t.interpolate=function(u){return arguments.length?(s=u,e()):s},t.unknown=function(u){return arguments.length?(l=u,t):l},function(u,a){return r=u,i=a,e()}}function du(){return lu()(M,M)}function hu(n,o,s,r){var i=st(n,o,s),l;switch(r=Sn(r??",f"),r.type){case"s":{var c=Math.max(Math.abs(n),Math.abs(o));return r.precision==null&&!isNaN(l=eu(i,c))&&(r.precision=l),Dr(r,c)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(l=ru(i,Math.max(Math.abs(n),Math.abs(o))))&&(r.precision=l-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(l=nu(i))&&(r.precision=l-(r.type==="%")*2);break}}return ze(r)}function Ur(n){var o=n.domain;return n.ticks=function(s){var r=o();return dr(r[0],r[r.length-1],s??10)},n.tickFormat=function(s,r){var i=o();return hu(i[0],i[i.length-1],s??10,r)},n.nice=function(s){s==null&&(s=10);var r=o(),i=0,l=r.length-1,c=r[i],h=r[l],d,f,e=10;for(h<c&&(f=c,c=h,h=f,f=i,i=l,l=f);e-- >0;){if(f=hn(c,h,s),f===d)return r[i]=c,r[l]=h,o(r);if(f>0)c=Math.floor(c/f)*f,h=Math.ceil(h/f)*f;else if(f<0)c=Math.ceil(c*f)/f,h=Math.floor(h*f)/f;else break;d=f}return n},n}function fn(){var n=du();return n.copy=function(){return cu(n,fn())},tu.apply(n,arguments),Ur(n)}function mu(){var n=0,o=1,s,r,i,l,c=M,h=!1,d;function f(t){return t==null||isNaN(t=+t)?d:c(i===0?.5:(t=(l(t)-s)*i,h?Math.max(0,Math.min(1,t)):t))}f.domain=function(t){return arguments.length?([n,o]=t,s=l(n=+n),r=l(o=+o),i=s===r?0:1/(r-s),f):[n,o]},f.clamp=function(t){return arguments.length?(h=!!t,f):h},f.interpolator=function(t){return arguments.length?(c=t,f):c};function e(t){return function(u){var a,m;return arguments.length?([a,m]=u,c=t(a,m),f):[c(0),c(1)]}}return f.range=e(re),f.rangeRound=e(Pr),f.unknown=function(t){return arguments.length?(d=t,f):d},function(t){return l=t,s=t(n),r=t(o),i=s===r?0:1/(r-s),f}}function vu(n,o){return o.domain(n.domain()).interpolator(n.interpolator()).clamp(n.clamp()).unknown(n.unknown())}function sn(){var n=Ur(mu()(M));return n.copy=function(){return vu(n,sn())},iu.apply(n,arguments)}function oe(n){for(var o=n.length/6|0,s=new Array(o),r=0;r<o;)s[r]="#"+n.slice(r*6,++r*6);return s}function gu(n){return n=Math.max(0,Math.min(1,n)),"rgb("+Math.max(0,Math.min(255,Math.round(-4.54-n*(35.34-n*(2381.73-n*(6402.7-n*(7024.72-n*2710.57)))))))+", "+Math.max(0,Math.min(255,Math.round(32.49+n*(170.73+n*(52.82-n*(131.46-n*(176.58-n*67.37)))))))+", "+Math.max(0,Math.min(255,Math.round(81.24+n*(442.36-n*(2482.43-n*(6167.24-n*(6614.94-n*2475.67)))))))+")"}function fe(n){var o=n.length;return function(s){return n[Math.max(0,Math.min(o-1,Math.floor(s*o)))]}}const pu=fe(oe("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725"));var yu=fe(oe("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),wu=fe(oe("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),bu=fe(oe("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));function an(n){return function(){return n}}function _u(n){let o=3;return n.digits=function(s){if(!arguments.length)return o;if(s==null)o=null;else{const r=Math.floor(s);if(!(r>=0))throw new RangeError(`invalid digits: ${s}`);o=r}return n},()=>new Qf(o)}function xu(n){return typeof n=="object"&&"length"in n?n:Array.from(n)}function Qr(n){this._context=n}Qr.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(n,o){switch(n=+n,o=+o,this._point){case 0:this._point=1,this._line?this._context.lineTo(n,o):this._context.moveTo(n,o);break;case 1:this._point=2;default:this._context.lineTo(n,o);break}}};function ku(n){return new Qr(n)}function Eu(n){return n[0]}function Au(n){return n[1]}function Yr(n,o){var s=an(!0),r=null,i=ku,l=null,c=_u(h);n=typeof n=="function"?n:n===void 0?Eu:an(n),o=typeof o=="function"?o:o===void 0?Au:an(o);function h(d){var f,e=(d=xu(d)).length,t,u=!1,a;for(r==null&&(l=i(a=c())),f=0;f<=e;++f)!(f<e&&s(t=d[f],f,d))===u&&((u=!u)?l.lineStart():l.lineEnd()),u&&l.point(+n(t,f,d),+o(t,f,d));if(a)return l=null,a+""||null}return h.x=function(d){return arguments.length?(n=typeof d=="function"?d:an(+d),h):n},h.y=function(d){return arguments.length?(o=typeof d=="function"?d:an(+d),h):o},h.defined=function(d){return arguments.length?(s=typeof d=="function"?d:an(!!d),h):s},h.curve=function(d){return arguments.length?(i=d,r!=null&&(l=i(r)),h):i},h.context=function(d){return arguments.length?(d==null?r=l=null:l=i(r=d),h):r},h}function An(n,o,s){this.k=n,this.x=o,this.y=s}An.prototype={constructor:An,scale:function(n){return n===1?this:new An(this.k*n,this.x,this.y)},translate:function(n,o){return n===0&o===0?this:new An(this.k,this.x+this.k*n,this.y+this.k*o)},apply:function(n){return[n[0]*this.k+this.x,n[1]*this.k+this.y]},applyX:function(n){return n*this.k+this.x},applyY:function(n){return n*this.k+this.y},invert:function(n){return[(n[0]-this.x)/this.k,(n[1]-this.y)/this.k]},invertX:function(n){return(n-this.x)/this.k},invertY:function(n){return(n-this.y)/this.k},rescaleX:function(n){return n.copy().domain(n.range().map(this.invertX,this).map(n.invert,n))},rescaleY:function(n){return n.copy().domain(n.range().map(this.invertY,this).map(n.invert,n))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};An.prototype;var Ln={};/**
 * k-d Tree JavaScript - V 1.01
 *
 * https://github.com/ubilabs/kd-tree-javascript
 *
 * @author Mircea Pricop <pricop@ubilabs.net>, 2012
 * @author Martin Kleppe <kleppe@ubilabs.net>, 2012
 * @author Ubilabs http://ubilabs.net, 2012
 * @license MIT License <http://www.opensource.org/licenses/mit-license.php>
 */var ur;function Nu(){return ur||(ur=1,function(n){(function(o,s){s(n)})(Ln,function(o){function s(i,l,c){this.obj=i,this.left=null,this.right=null,this.parent=c,this.dimension=l}function r(i){this.content=[],this.scoreFunction=i}r.prototype={push:function(i){this.content.push(i),this.bubbleUp(this.content.length-1)},pop:function(){var i=this.content[0],l=this.content.pop();return this.content.length>0&&(this.content[0]=l,this.sinkDown(0)),i},peek:function(){return this.content[0]},remove:function(i){for(var l=this.content.length,c=0;c<l;c++)if(this.content[c]==i){var h=this.content.pop();return void(c!=l-1&&(this.content[c]=h,this.scoreFunction(h)<this.scoreFunction(i)?this.bubbleUp(c):this.sinkDown(c)))}throw new Error("Node not found.")},size:function(){return this.content.length},bubbleUp:function(i){for(var l=this.content[i];i>0;){var c=Math.floor((i+1)/2)-1,h=this.content[c];if(!(this.scoreFunction(l)<this.scoreFunction(h)))break;this.content[c]=l,this.content[i]=h,i=c}},sinkDown:function(i){for(var l=this.content.length,c=this.content[i],h=this.scoreFunction(c);;){var d=2*(i+1),f=d-1,e=null;if(f<l){var t=this.content[f],u=this.scoreFunction(t);u<h&&(e=f)}if(d<l){var a=this.content[d];this.scoreFunction(a)<(e==null?h:u)&&(e=d)}if(e==null)break;this.content[i]=this.content[e],this.content[e]=c,i=e}}},o.kdTree=function(i,l,c){function h(f,e,t){var u,a,m=e%c.length;return f.length===0?null:f.length===1?new s(f[0],m,t):(f.sort(function(v,g){return v[c[m]]-g[c[m]]}),u=Math.floor(f.length/2),a=new s(f[u],m,t),a.left=h(f.slice(0,u),e+1,a),a.right=h(f.slice(u+1),e+1,a),a)}var d=this;Array.isArray(i)?this.root=h(i,0,null):function(f){function e(t){t.left&&(t.left.parent=t,e(t.left)),t.right&&(t.right.parent=t,e(t.right))}d.root=f,e(d.root)}(i),this.toJSON=function(f){f||(f=this.root);var e=new s(f.obj,f.dimension,null);return f.left&&(e.left=d.toJSON(f.left)),f.right&&(e.right=d.toJSON(f.right)),e},this.insert=function(f){function e(m,v){if(m===null)return v;var g=c[m.dimension];return f[g]<m.obj[g]?e(m.left,m):e(m.right,m)}var t,u,a=e(this.root,null);a!==null?(t=new s(f,(a.dimension+1)%c.length,a),u=c[a.dimension],f[u]<a.obj[u]?a.left=t:a.right=t):this.root=new s(f,0,null)},this.remove=function(f){function e(a){if(a===null)return null;if(a.obj===f)return a;var m=c[a.dimension];return f[m]<a.obj[m]?e(a.left):e(a.right)}function t(a){function m(w,p){var b,_,x,k,E;return w===null?null:(b=c[p],w.dimension===p?w.left!==null?m(w.left,p):w:(_=w.obj[b],x=m(w.left,p),k=m(w.right,p),E=w,x!==null&&x.obj[b]<_&&(E=x),k!==null&&k.obj[b]<E.obj[b]&&(E=k),E))}var v,g,y;if(a.left===null&&a.right===null)return a.parent===null?void(d.root=null):(y=c[a.parent.dimension],void(a.obj[y]<a.parent.obj[y]?a.parent.left=null:a.parent.right=null));a.right!==null?(g=(v=m(a.right,a.dimension)).obj,t(v),a.obj=g):(g=(v=m(a.left,a.dimension)).obj,t(v),a.right=a.left,a.left=null,a.obj=g)}var u;(u=e(d.root))!==null&&t(u)},this.nearest=function(f,e,t){function u(g){function y(N,$){v.push([N,$]),v.size()>e&&v.pop()}var w,p,b,_,x=c[g.dimension],k=l(f,g.obj),E={};for(_=0;_<c.length;_+=1)_===g.dimension?E[c[_]]=f[c[_]]:E[c[_]]=g.obj[c[_]];p=l(E,g.obj),g.right!==null||g.left!==null?(u(w=g.right===null?g.left:g.left===null?g.right:f[x]<g.obj[x]?g.left:g.right),(v.size()<e||k<v.peek()[1])&&y(g,k),(v.size()<e||Math.abs(p)<v.peek()[1])&&(b=w===g.left?g.right:g.left)!==null&&u(b)):(v.size()<e||k<v.peek()[1])&&y(g,k)}var a,m,v;if(v=new r(function(g){return-g[1]}),t)for(a=0;a<e;a+=1)v.push([null,t]);for(d.root&&u(d.root),m=[],a=0;a<Math.min(e,v.content.length);a+=1)v.content[a][0]&&m.push([v.content[a][0].obj,v.content[a][1]]);return m},this.balanceFactor=function(){function f(t){return t===null?0:Math.max(f(t.left),f(t.right))+1}function e(t){return t===null?0:e(t.left)+e(t.right)+1}return f(d.root)/(Math.log(e(d.root))/Math.log(2))}},o.BinaryHeap=r})}(Ln)),Ln}var $u=Nu(),Vn={exports:{}},qu=Vn.exports,ar;function Iu(){return ar||(ar=1,function(n,o){(function(s,r){n.exports=r()})(qu,function(){var s=function(r,i){var l=Array.prototype.concat,c=Array.prototype.slice,h=Object.prototype.toString;function d(w,p){var b=w>p?w:p;return r.pow(10,17-~~(r.log(b>0?b:-b)*r.LOG10E))}var f=Array.isArray||function(p){return h.call(p)==="[object Array]"};function e(w){return h.call(w)==="[object Function]"}function t(w){return typeof w=="number"?w-w===0:!1}function u(w){return l.apply([],w)}function a(){return new a._init(arguments)}a.fn=a.prototype,a._init=function(p){if(f(p[0]))if(f(p[0][0])){e(p[1])&&(p[0]=a.map(p[0],p[1]));for(var b=0;b<p[0].length;b++)this[b]=p[0][b];this.length=p[0].length}else this[0]=e(p[1])?a.map(p[0],p[1]):p[0],this.length=1;else if(t(p[0]))this[0]=a.seq.apply(null,p),this.length=1;else{if(p[0]instanceof a)return a(p[0].toArray());this[0]=[],this.length=1}return this},a._init.prototype=a.prototype,a._init.constructor=a,a.utils={calcRdx:d,isArray:f,isFunction:e,isNumber:t,toVector:u},a._random_fn=r.random,a.setRandom=function(p){if(typeof p!="function")throw new TypeError("fn is not a function");a._random_fn=p},a.extend=function(p){var b,_;if(arguments.length===1){for(_ in p)a[_]=p[_];return this}for(b=1;b<arguments.length;b++)for(_ in arguments[b])p[_]=arguments[b][_];return p},a.rows=function(p){return p.length||1},a.cols=function(p){return p[0].length||1},a.dimensions=function(p){return{rows:a.rows(p),cols:a.cols(p)}},a.row=function(p,b){return f(b)?b.map(function(_){return a.row(p,_)}):p[b]},a.rowa=function(p,b){return a.row(p,b)},a.col=function(p,b){if(f(b)){var _=a.arange(p.length).map(function(){return new Array(b.length)});return b.forEach(function(E,N){a.arange(p.length).forEach(function($){_[$][N]=p[$][E]})}),_}for(var x=new Array(p.length),k=0;k<p.length;k++)x[k]=[p[k][b]];return x},a.cola=function(p,b){return a.col(p,b).map(function(_){return _[0]})},a.diag=function(p){for(var b=a.rows(p),_=new Array(b),x=0;x<b;x++)_[x]=[p[x][x]];return _},a.antidiag=function(p){for(var b=a.rows(p)-1,_=new Array(b),x=0;b>=0;b--,x++)_[x]=[p[x][b]];return _},a.transpose=function(p){var b=[],_,x,k,E,N;for(f(p[0])||(p=[p]),x=p.length,k=p[0].length,N=0;N<k;N++){for(_=new Array(x),E=0;E<x;E++)_[E]=p[E][N];b.push(_)}return b.length===1?b[0]:b},a.map=function(p,b,_){var x,k,E,N,$;for(f(p[0])||(p=[p]),k=p.length,E=p[0].length,N=_?p:new Array(k),x=0;x<k;x++)for(N[x]||(N[x]=new Array(E)),$=0;$<E;$++)N[x][$]=b(p[x][$],x,$);return N.length===1?N[0]:N},a.cumreduce=function(p,b,_){var x,k,E,N,$;for(f(p[0])||(p=[p]),k=p.length,E=p[0].length,N=_?p:new Array(k),x=0;x<k;x++)for(N[x]||(N[x]=new Array(E)),E>0&&(N[x][0]=p[x][0]),$=1;$<E;$++)N[x][$]=b(N[x][$-1],p[x][$]);return N.length===1?N[0]:N},a.alter=function(p,b){return a.map(p,b,!0)},a.create=function(p,b,_){var x=new Array(p),k,E;for(e(b)&&(_=b,b=p),k=0;k<p;k++)for(x[k]=new Array(b),E=0;E<b;E++)x[k][E]=_(k,E);return x};function m(){return 0}a.zeros=function(p,b){return t(b)||(b=p),a.create(p,b,m)};function v(){return 1}a.ones=function(p,b){return t(b)||(b=p),a.create(p,b,v)},a.rand=function(p,b){return t(b)||(b=p),a.create(p,b,a._random_fn)};function g(w,p){return w===p?1:0}a.identity=function(p,b){return t(b)||(b=p),a.create(p,b,g)},a.symmetric=function(p){var b=p.length,_,x;if(p.length!==p[0].length)return!1;for(_=0;_<b;_++)for(x=0;x<b;x++)if(p[x][_]!==p[_][x])return!1;return!0},a.clear=function(p){return a.alter(p,m)},a.seq=function(p,b,_,x){e(x)||(x=!1);var k=[],E=d(p,b),N=(b*E-p*E)/((_-1)*E),$=p,A;for(A=0;$<=b&&A<_;A++,$=(p*E+N*E*A)/E)k.push(x?x($,A):$);return k},a.arange=function(p,b,_){var x=[],k;if(_=_||1,b===i&&(b=p,p=0),p===b||_===0)return[];if(p<b&&_<0)return[];if(p>b&&_>0)return[];if(_>0)for(k=p;k<b;k+=_)x.push(k);else for(k=p;k>b;k+=_)x.push(k);return x},a.slice=function(){function w(b,_,x,k){var E,N=[],$=b.length;if(_===i&&x===i&&k===i)return a.copy(b);if(_=_||0,x=x||b.length,_=_>=0?_:$+_,x=x>=0?x:$+x,k=k||1,_===x||k===0)return[];if(_<x&&k<0)return[];if(_>x&&k>0)return[];if(k>0)for(E=_;E<x;E+=k)N.push(b[E]);else for(E=_;E>x;E+=k)N.push(b[E]);return N}function p(b,_){var x,k;if(_=_||{},t(_.row)){if(t(_.col))return b[_.row][_.col];var E=a.rowa(b,_.row);return x=_.col||{},w(E,x.start,x.end,x.step)}if(t(_.col)){var N=a.cola(b,_.col);return k=_.row||{},w(N,k.start,k.end,k.step)}k=_.row||{},x=_.col||{};var $=w(b,k.start,k.end,k.step);return $.map(function(A){return w(A,x.start,x.end,x.step)})}return p}(),a.sliceAssign=function(p,b,_){var x,k;if(t(b.row)){if(t(b.col))return p[b.row][b.col]=_;b.col=b.col||{},b.col.start=b.col.start||0,b.col.end=b.col.end||p[0].length,b.col.step=b.col.step||1,x=a.arange(b.col.start,r.min(p.length,b.col.end),b.col.step);var E=b.row;return x.forEach(function($,A){p[E][$]=_[A]}),p}if(t(b.col)){b.row=b.row||{},b.row.start=b.row.start||0,b.row.end=b.row.end||p.length,b.row.step=b.row.step||1,k=a.arange(b.row.start,r.min(p[0].length,b.row.end),b.row.step);var N=b.col;return k.forEach(function($,A){p[$][N]=_[A]}),p}return _[0].length===i&&(_=[_]),b.row.start=b.row.start||0,b.row.end=b.row.end||p.length,b.row.step=b.row.step||1,b.col.start=b.col.start||0,b.col.end=b.col.end||p[0].length,b.col.step=b.col.step||1,k=a.arange(b.row.start,r.min(p.length,b.row.end),b.row.step),x=a.arange(b.col.start,r.min(p[0].length,b.col.end),b.col.step),k.forEach(function($,A){x.forEach(function(q,I){p[$][q]=_[A][I]})}),p},a.diagonal=function(p){var b=a.zeros(p.length,p.length);return p.forEach(function(_,x){b[x][x]=_}),b},a.copy=function(p){return p.map(function(b){return t(b)?b:b.map(function(_){return _})})};var y=a.prototype;return y.length=0,y.push=Array.prototype.push,y.sort=Array.prototype.sort,y.splice=Array.prototype.splice,y.slice=Array.prototype.slice,y.toArray=function(){return this.length>1?c.call(this):c.call(this)[0]},y.map=function(p,b){return a(a.map(this,p,b))},y.cumreduce=function(p,b){return a(a.cumreduce(this,p,b))},y.alter=function(p){return a.alter(this,p),this},function(w){for(var p=0;p<w.length;p++)(function(b){y[b]=function(_){var x=this,k;return _?(setTimeout(function(){_.call(x,y[b].call(x))}),this):(k=a[b](this),f(k)?a(k):k)}})(w[p])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(w){for(var p=0;p<w.length;p++)(function(b){y[b]=function(_,x){var k=this;return x?(setTimeout(function(){x.call(k,y[b].call(k,_))}),this):a(a[b](this,_))}})(w[p])}("row col".split(" ")),function(w){for(var p=0;p<w.length;p++)(function(b){y[b]=function(){return a(a[b].apply(null,arguments))}})(w[p])}("create zeros ones rand identity".split(" ")),a}(Math);return function(r,i){var l=r.utils.isFunction;function c(f,e){return f-e}function h(f,e,t){return i.max(e,i.min(f,t))}r.sum=function(e){for(var t=0,u=e.length;--u>=0;)t+=e[u];return t},r.sumsqrd=function(e){for(var t=0,u=e.length;--u>=0;)t+=e[u]*e[u];return t},r.sumsqerr=function(e){for(var t=r.mean(e),u=0,a=e.length,m;--a>=0;)m=e[a]-t,u+=m*m;return u},r.sumrow=function(e){for(var t=0,u=e.length;--u>=0;)t+=e[u];return t},r.product=function(e){for(var t=1,u=e.length;--u>=0;)t*=e[u];return t},r.min=function(e){for(var t=e[0],u=0;++u<e.length;)e[u]<t&&(t=e[u]);return t},r.max=function(e){for(var t=e[0],u=0;++u<e.length;)e[u]>t&&(t=e[u]);return t},r.unique=function(e){for(var t={},u=[],a=0;a<e.length;a++)t[e[a]]||(t[e[a]]=!0,u.push(e[a]));return u},r.mean=function(e){return r.sum(e)/e.length},r.meansqerr=function(e){return r.sumsqerr(e)/e.length},r.geomean=function(e){var t=e.map(i.log),u=r.mean(t);return i.exp(u)},r.median=function(e){var t=e.length,u=e.slice().sort(c);return t&1?u[t/2|0]:(u[t/2-1]+u[t/2])/2},r.cumsum=function(e){return r.cumreduce(e,function(t,u){return t+u})},r.cumprod=function(e){return r.cumreduce(e,function(t,u){return t*u})},r.diff=function(e){var t=[],u=e.length,a;for(a=1;a<u;a++)t.push(e[a]-e[a-1]);return t},r.rank=function(f){var e,t=[],u={};for(e=0;e<f.length;e++){var a=f[e];u[a]?u[a]++:(u[a]=1,t.push(a))}var m=t.sort(c),v={},g=1;for(e=0;e<m.length;e++){var a=m[e],y=u[a],w=g,p=g+y-1,b=(w+p)/2;v[a]=b,g+=y}return f.map(function(_){return v[_]})},r.mode=function(e){var t=e.length,u=e.slice().sort(c),a=1,m=0,v=0,g=[],y;for(y=0;y<t;y++)u[y]===u[y+1]?a++:(a>m?(g=[u[y]],m=a,v=0):a===m&&(g.push(u[y]),v++),a=1);return v===0?g[0]:g},r.range=function(e){return r.max(e)-r.min(e)},r.variance=function(e,t){return r.sumsqerr(e)/(e.length-(t?1:0))},r.pooledvariance=function(e){var t=e.reduce(function(a,m){return a+r.sumsqerr(m)},0),u=e.reduce(function(a,m){return a+m.length},0);return t/(u-e.length)},r.deviation=function(f){for(var e=r.mean(f),t=f.length,u=new Array(t),a=0;a<t;a++)u[a]=f[a]-e;return u},r.stdev=function(e,t){return i.sqrt(r.variance(e,t))},r.pooledstdev=function(e){return i.sqrt(r.pooledvariance(e))},r.meandev=function(e){for(var t=r.mean(e),u=[],a=e.length-1;a>=0;a--)u.push(i.abs(e[a]-t));return r.mean(u)},r.meddev=function(e){for(var t=r.median(e),u=[],a=e.length-1;a>=0;a--)u.push(i.abs(e[a]-t));return r.median(u)},r.coeffvar=function(e){return r.stdev(e)/r.mean(e)},r.quartiles=function(e){var t=e.length,u=e.slice().sort(c);return[u[i.round(t/4)-1],u[i.round(t/2)-1],u[i.round(t*3/4)-1]]},r.quantiles=function(e,t,u,a){var m=e.slice().sort(c),v=[t.length],g=e.length,y,w,p,b,_,x;for(typeof u>"u"&&(u=3/8),typeof a>"u"&&(a=3/8),y=0;y<t.length;y++)w=t[y],p=u+w*(1-u-a),b=g*w+p,_=i.floor(h(b,1,g-1)),x=h(b-_,0,1),v[y]=(1-x)*m[_-1]+x*m[_];return v},r.percentile=function(e,t,u){var a=e.slice().sort(c),m=t*(a.length+(u?1:-1))+(u?0:1),v=parseInt(m),g=m-v;return v+1<a.length?a[v-1]+g*(a[v]-a[v-1]):a[v-1]},r.percentileOfScore=function(e,t,u){var a=0,m=e.length,v=!1,g,y;for(u==="strict"&&(v=!0),y=0;y<m;y++)g=e[y],(v&&g<t||!v&&g<=t)&&a++;return a/m},r.histogram=function(e,t){t=t||4;var u=r.min(e),a=(r.max(e)-u)/t,m=e.length,v=[],g;for(g=0;g<t;g++)v[g]=0;for(g=0;g<m;g++)v[i.min(i.floor((e[g]-u)/a),t-1)]+=1;return v},r.covariance=function(e,t){var u=r.mean(e),a=r.mean(t),m=e.length,v=new Array(m),g;for(g=0;g<m;g++)v[g]=(e[g]-u)*(t[g]-a);return r.sum(v)/(m-1)},r.corrcoeff=function(e,t){return r.covariance(e,t)/r.stdev(e,1)/r.stdev(t,1)},r.spearmancoeff=function(f,e){return f=r.rank(f),e=r.rank(e),r.corrcoeff(f,e)},r.stanMoment=function(e,t){for(var u=r.mean(e),a=r.stdev(e),m=e.length,v=0,g=0;g<m;g++)v+=i.pow((e[g]-u)/a,t);return v/e.length},r.skewness=function(e){return r.stanMoment(e,3)},r.kurtosis=function(e){return r.stanMoment(e,4)-3};var d=r.prototype;(function(f){for(var e=0;e<f.length;e++)(function(t){d[t]=function(u,a){var m=[],v=0,g=this;if(l(u)&&(a=u,u=!1),a)return setTimeout(function(){a.call(g,d[t].call(g,u))}),this;if(this.length>1){for(g=u===!0?this:this.transpose();v<g.length;v++)m[v]=r[t](g[v]);return m}return r[t](this[0],u)}})(f[e])})("cumsum cumprod".split(" ")),function(f){for(var e=0;e<f.length;e++)(function(t){d[t]=function(u,a){var m=[],v=0,g=this;if(l(u)&&(a=u,u=!1),a)return setTimeout(function(){a.call(g,d[t].call(g,u))}),this;if(this.length>1){for(t!=="sumrow"&&(g=u===!0?this:this.transpose());v<g.length;v++)m[v]=r[t](g[v]);return u===!0?r[t](r.utils.toVector(m)):m}return r[t](this[0],u)}})(f[e])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(f){for(var e=0;e<f.length;e++)(function(t){d[t]=function(){var u=[],a=0,m=this,v=Array.prototype.slice.call(arguments),g;if(l(v[v.length-1])){g=v[v.length-1];var y=v.slice(0,v.length-1);return setTimeout(function(){g.call(m,d[t].apply(m,y))}),this}else{g=void 0;var w=function(b){return r[t].apply(m,[b].concat(v))}}if(this.length>1){for(m=m.transpose();a<m.length;a++)u[a]=w(m[a]);return u}return w(this[0])}})(f[e])}("quantiles percentileOfScore".split(" "))}(s,Math),function(r,i){r.gammaln=function(c){var h=0,d=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],f=1.000000000190015,e,t,u;for(u=(t=e=c)+5.5,u-=(e+.5)*i.log(u);h<6;h++)f+=d[h]/++t;return i.log(2.5066282746310007*f/e)-u},r.loggam=function(c){var h,d,f,e,t,u,a,m=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(h=c,a=0,c==1||c==2)return 0;for(c<=7&&(a=i.floor(7-c),h=c+a),d=1/(h*h),f=2*i.PI,t=m[9],u=8;u>=0;u--)t*=d,t+=m[u];if(e=t/h+.5*i.log(f)+(h-.5)*i.log(h)-h,c<=7)for(u=1;u<=a;u++)e-=i.log(h-1),h-=1;return e},r.gammafn=function(c){var h=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],d=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],f=!1,e=0,t=0,u=0,a=c,m,v,g,y;if(c>171.6243769536076)return 1/0;if(a<=0)if(y=a%1+36e-17,y)f=(a&1?-1:1)*i.PI/i.sin(i.PI*y),a=1-a;else return 1/0;for(g=a,a<1?v=a++:v=(a-=e=(a|0)-1)-1,m=0;m<8;++m)u=(u+h[m])*v,t=t*v+d[m];if(y=u/t+1,g<a)y/=g;else if(g>a)for(m=0;m<e;++m)y*=a,a++;return f&&(y=f/y),y},r.gammap=function(c,h){return r.lowRegGamma(c,h)*r.gammafn(c)},r.lowRegGamma=function(c,h){var d=r.gammaln(c),f=c,e=1/c,t=e,u=h+1-c,a=1/1e-30,m=1/u,v=m,g=1,y=-~(i.log(c>=1?c:1/c)*8.5+c*.4+17),w;if(h<0||c<=0)return NaN;if(h<c+1){for(;g<=y;g++)e+=t*=h/++f;return e*i.exp(-h+c*i.log(h)-d)}for(;g<=y;g++)w=-g*(g-c),u+=2,m=w*m+u,a=u+w/a,m=1/m,v*=m*a;return 1-v*i.exp(-h+c*i.log(h)-d)},r.factorialln=function(c){return c<0?NaN:r.gammaln(c+1)},r.factorial=function(c){return c<0?NaN:r.gammafn(c+1)},r.combination=function(c,h){return c>170||h>170?i.exp(r.combinationln(c,h)):r.factorial(c)/r.factorial(h)/r.factorial(c-h)},r.combinationln=function(c,h){return r.factorialln(c)-r.factorialln(h)-r.factorialln(c-h)},r.permutation=function(c,h){return r.factorial(c)/r.factorial(c-h)},r.betafn=function(c,h){if(!(c<=0||h<=0))return c+h>170?i.exp(r.betaln(c,h)):r.gammafn(c)*r.gammafn(h)/r.gammafn(c+h)},r.betaln=function(c,h){return r.gammaln(c)+r.gammaln(h)-r.gammaln(c+h)},r.betacf=function(c,h,d){var f=1e-30,e=1,t=h+d,u=h+1,a=h-1,m=1,v=1-t*c/u,g,y,w,p;for(i.abs(v)<f&&(v=f),v=1/v,p=v;e<=100&&(g=2*e,y=e*(d-e)*c/((a+g)*(h+g)),v=1+y*v,i.abs(v)<f&&(v=f),m=1+y/m,i.abs(m)<f&&(m=f),v=1/v,p*=v*m,y=-(h+e)*(t+e)*c/((h+g)*(u+g)),v=1+y*v,i.abs(v)<f&&(v=f),m=1+y/m,i.abs(m)<f&&(m=f),v=1/v,w=v*m,p*=w,!(i.abs(w-1)<3e-7));e++);return p},r.gammapinv=function(c,h){var d=0,f=h-1,e=1e-8,t=r.gammaln(h),u,a,m,v,g,y,w;if(c>=1)return i.max(100,h+100*i.sqrt(h));if(c<=0)return 0;for(h>1?(y=i.log(f),w=i.exp(f*(y-1)-t),g=c<.5?c:1-c,m=i.sqrt(-2*i.log(g)),u=(2.30753+m*.27061)/(1+m*(.99229+m*.04481))-m,c<.5&&(u=-u),u=i.max(.001,h*i.pow(1-1/(9*h)-u/(3*i.sqrt(h)),3))):(m=1-h*(.253+h*.12),c<m?u=i.pow(c/m,1/h):u=1-i.log(1-(c-m)/(1-m)));d<12;d++){if(u<=0)return 0;if(a=r.lowRegGamma(h,u)-c,h>1?m=w*i.exp(-(u-f)+f*(i.log(u)-y)):m=i.exp(-u+f*i.log(u)-t),v=a/m,u-=m=v/(1-.5*i.min(1,v*((h-1)/u-1))),u<=0&&(u=.5*(u+m)),i.abs(m)<e*u)break}return u},r.erf=function(c){var h=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],d=h.length-1,f=!1,e=0,t=0,u,a,m,v;for(c<0&&(c=-c,f=!0),u=2/(2+c),a=4*u-2;d>0;d--)m=e,e=a*e-t+h[d],t=m;return v=u*i.exp(-c*c+.5*(h[0]+a*e)-t),f?v-1:1-v},r.erfc=function(c){return 1-r.erf(c)},r.erfcinv=function(c){var h=0,d,f,e,t;if(c>=2)return-100;if(c<=0)return 100;for(t=c<1?c:2-c,e=i.sqrt(-2*i.log(t/2)),d=-.70711*((2.30753+e*.27061)/(1+e*(.99229+e*.04481))-e);h<2;h++)f=r.erfc(d)-t,d+=f/(1.1283791670955126*i.exp(-d*d)-d*f);return c<1?d:-d},r.ibetainv=function(c,h,d){var f=1e-8,e=h-1,t=d-1,u=0,a,m,v,g,y,w,p,b,_,x,k;if(c<=0)return 0;if(c>=1)return 1;for(h>=1&&d>=1?(v=c<.5?c:1-c,g=i.sqrt(-2*i.log(v)),p=(2.30753+g*.27061)/(1+g*(.99229+g*.04481))-g,c<.5&&(p=-p),b=(p*p-3)/6,_=2/(1/(2*h-1)+1/(2*d-1)),x=p*i.sqrt(b+_)/_-(1/(2*d-1)-1/(2*h-1))*(b+5/6-2/(3*_)),p=h/(h+d*i.exp(2*x))):(a=i.log(h/(h+d)),m=i.log(d/(h+d)),g=i.exp(h*a)/h,y=i.exp(d*m)/d,x=g+y,c<g/x?p=i.pow(h*x*c,1/h):p=1-i.pow(d*x*(1-c),1/d)),k=-r.gammaln(h)-r.gammaln(d)+r.gammaln(h+d);u<10;u++){if(p===0||p===1)return p;if(w=r.ibeta(p,h,d)-c,g=i.exp(e*i.log(p)+t*i.log(1-p)+k),y=w/g,p-=g=y/(1-.5*i.min(1,y*(e/p-t/(1-p)))),p<=0&&(p=.5*(p+g)),p>=1&&(p=.5*(p+g+1)),i.abs(g)<f*p&&u>0)break}return p},r.ibeta=function(c,h,d){var f=c===0||c===1?0:i.exp(r.gammaln(h+d)-r.gammaln(h)-r.gammaln(d)+h*i.log(c)+d*i.log(1-c));return c<0||c>1?!1:c<(h+1)/(h+d+2)?f*r.betacf(c,h,d)/h:1-f*r.betacf(1-c,d,h)/d},r.randn=function(c,h){var d,f,e,t,u;if(h||(h=c),c)return r.create(c,h,function(){return r.randn()});do d=r._random_fn(),f=1.7156*(r._random_fn()-.5),e=d-.449871,t=i.abs(f)+.386595,u=e*e+t*(.196*t-.25472*e);while(u>.27597&&(u>.27846||f*f>-4*i.log(d)*d*d));return f/d},r.randg=function(c,h,d){var f=c,e,t,u,a,m,v;if(d||(d=h),c||(c=1),h)return v=r.zeros(h,d),v.alter(function(){return r.randg(c)}),v;c<1&&(c+=1),e=c-1/3,t=1/i.sqrt(9*e);do{do m=r.randn(),a=1+t*m;while(a<=0);a=a*a*a,u=r._random_fn()}while(u>1-.331*i.pow(m,4)&&i.log(u)>.5*m*m+e*(1-a+i.log(a)));if(c==f)return e*a;do u=r._random_fn();while(u===0);return i.pow(u,1/f)*e*a},function(l){for(var c=0;c<l.length;c++)(function(h){r.fn[h]=function(){return r(r.map(this,function(d){return r[h](d)}))}})(l[c])}("gammaln gammafn factorial factorialln".split(" ")),function(l){for(var c=0;c<l.length;c++)(function(h){r.fn[h]=function(){return r(r[h].apply(null,arguments))}})(l[c])}("randn".split(" "))}(s,Math),function(r,i){(function(f){for(var e=0;e<f.length;e++)(function(t){r[t]=function u(a,m,v){return this instanceof u?(this._a=a,this._b=m,this._c=v,this):new u(a,m,v)},r.fn[t]=function(u,a,m){var v=r[t](u,a,m);return v.data=this,v},r[t].prototype.sample=function(u){var a=this._a,m=this._b,v=this._c;return u?r.alter(u,function(){return r[t].sample(a,m,v)}):r[t].sample(a,m,v)},function(u){for(var a=0;a<u.length;a++)(function(m){r[t].prototype[m]=function(v){var g=this._a,y=this._b,w=this._c;return!v&&v!==0&&(v=this.data),typeof v!="number"?r.fn.map.call(v,function(p){return r[t][m](p,g,y,w)}):r[t][m](v,g,y,w)}})(u[a])}("pdf cdf inv".split(" ")),function(u){for(var a=0;a<u.length;a++)(function(m){r[t].prototype[m]=function(){return r[t][m](this._a,this._b,this._c)}})(u[a])}("mean median mode variance".split(" "))})(f[e])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),r.extend(r.beta,{pdf:function(e,t,u){return e>1||e<0?0:t==1&&u==1?1:t<512&&u<512?i.pow(e,t-1)*i.pow(1-e,u-1)/r.betafn(t,u):i.exp((t-1)*i.log(e)+(u-1)*i.log(1-e)-r.betaln(t,u))},cdf:function(e,t,u){return e>1||e<0?(e>1)*1:r.ibeta(e,t,u)},inv:function(e,t,u){return r.ibetainv(e,t,u)},mean:function(e,t){return e/(e+t)},median:function(e,t){return r.ibetainv(.5,e,t)},mode:function(e,t){return(e-1)/(e+t-2)},sample:function(e,t){var u=r.randg(e);return u/(u+r.randg(t))},variance:function(e,t){return e*t/(i.pow(e+t,2)*(e+t+1))}}),r.extend(r.centralF,{pdf:function(e,t,u){var a,m,v;return e<0?0:t<=2?e===0&&t<2?1/0:e===0&&t===2?1:1/r.betafn(t/2,u/2)*i.pow(t/u,t/2)*i.pow(e,t/2-1)*i.pow(1+t/u*e,-(t+u)/2):(a=t*e/(u+e*t),m=u/(u+e*t),v=t*m/2,v*r.binomial.pdf((t-2)/2,(t+u-2)/2,a))},cdf:function(e,t,u){return e<0?0:r.ibeta(t*e/(t*e+u),t/2,u/2)},inv:function(e,t,u){return u/(t*(1/r.ibetainv(e,t/2,u/2)-1))},mean:function(e,t){return t>2?t/(t-2):void 0},mode:function(e,t){return e>2?t*(e-2)/(e*(t+2)):void 0},sample:function(e,t){var u=r.randg(e/2)*2,a=r.randg(t/2)*2;return u/e/(a/t)},variance:function(e,t){if(!(t<=4))return 2*t*t*(e+t-2)/(e*(t-2)*(t-2)*(t-4))}}),r.extend(r.cauchy,{pdf:function(e,t,u){return u<0?0:u/(i.pow(e-t,2)+i.pow(u,2))/i.PI},cdf:function(e,t,u){return i.atan((e-t)/u)/i.PI+.5},inv:function(f,e,t){return e+t*i.tan(i.PI*(f-.5))},median:function(e){return e},mode:function(e){return e},sample:function(e,t){return r.randn()*i.sqrt(1/(2*r.randg(.5)))*t+e}}),r.extend(r.chisquare,{pdf:function(e,t){return e<0?0:e===0&&t===2?.5:i.exp((t/2-1)*i.log(e)-e/2-t/2*i.log(2)-r.gammaln(t/2))},cdf:function(e,t){return e<0?0:r.lowRegGamma(t/2,e/2)},inv:function(f,e){return 2*r.gammapinv(f,.5*e)},mean:function(f){return f},median:function(e){return e*i.pow(1-2/(9*e),3)},mode:function(e){return e-2>0?e-2:0},sample:function(e){return r.randg(e/2)*2},variance:function(e){return 2*e}}),r.extend(r.exponential,{pdf:function(e,t){return e<0?0:t*i.exp(-t*e)},cdf:function(e,t){return e<0?0:1-i.exp(-t*e)},inv:function(f,e){return-i.log(1-f)/e},mean:function(f){return 1/f},median:function(f){return 1/f*i.log(2)},mode:function(){return 0},sample:function(e){return-1/e*i.log(r._random_fn())},variance:function(f){return i.pow(f,-2)}}),r.extend(r.gamma,{pdf:function(e,t,u){return e<0?0:e===0&&t===1?1/u:i.exp((t-1)*i.log(e)-e/u-r.gammaln(t)-t*i.log(u))},cdf:function(e,t,u){return e<0?0:r.lowRegGamma(t,e/u)},inv:function(f,e,t){return r.gammapinv(f,e)*t},mean:function(f,e){return f*e},mode:function(e,t){if(e>1)return(e-1)*t},sample:function(e,t){return r.randg(e)*t},variance:function(e,t){return e*t*t}}),r.extend(r.invgamma,{pdf:function(e,t,u){return e<=0?0:i.exp(-(t+1)*i.log(e)-u/e-r.gammaln(t)+t*i.log(u))},cdf:function(e,t,u){return e<=0?0:1-r.lowRegGamma(t,u/e)},inv:function(f,e,t){return t/r.gammapinv(1-f,e)},mean:function(f,e){return f>1?e/(f-1):void 0},mode:function(e,t){return t/(e+1)},sample:function(e,t){return t/r.randg(e)},variance:function(e,t){if(!(e<=2))return t*t/((e-1)*(e-1)*(e-2))}}),r.extend(r.kumaraswamy,{pdf:function(e,t,u){return e===0&&t===1?u:e===1&&u===1?t:i.exp(i.log(t)+i.log(u)+(t-1)*i.log(e)+(u-1)*i.log(1-i.pow(e,t)))},cdf:function(e,t,u){return e<0?0:e>1?1:1-i.pow(1-i.pow(e,t),u)},inv:function(e,t,u){return i.pow(1-i.pow(1-e,1/u),1/t)},mean:function(f,e){return e*r.gammafn(1+1/f)*r.gammafn(e)/r.gammafn(1+1/f+e)},median:function(e,t){return i.pow(1-i.pow(2,-1/t),1/e)},mode:function(e,t){if(e>=1&&t>=1&&e!==1&&t!==1)return i.pow((e-1)/(e*t-1),1/e)},variance:function(){throw new Error("variance not yet implemented")}}),r.extend(r.lognormal,{pdf:function(e,t,u){return e<=0?0:i.exp(-i.log(e)-.5*i.log(2*i.PI)-i.log(u)-i.pow(i.log(e)-t,2)/(2*u*u))},cdf:function(e,t,u){return e<0?0:.5+.5*r.erf((i.log(e)-t)/i.sqrt(2*u*u))},inv:function(f,e,t){return i.exp(-1.4142135623730951*t*r.erfcinv(2*f)+e)},mean:function(e,t){return i.exp(e+t*t/2)},median:function(e){return i.exp(e)},mode:function(e,t){return i.exp(e-t*t)},sample:function(e,t){return i.exp(r.randn()*t+e)},variance:function(e,t){return(i.exp(t*t)-1)*i.exp(2*e+t*t)}}),r.extend(r.noncentralt,{pdf:function(e,t,u){var a=1e-14;return i.abs(u)<a?r.studentt.pdf(e,t):i.abs(e)<a?i.exp(r.gammaln((t+1)/2)-u*u/2-.5*i.log(i.PI*t)-r.gammaln(t/2)):t/e*(r.noncentralt.cdf(e*i.sqrt(1+2/t),t+2,u)-r.noncentralt.cdf(e,t,u))},cdf:function(e,t,u){var a=1e-14,m=200;if(i.abs(u)<a)return r.studentt.cdf(e,t);var v=!1;e<0&&(v=!0,u=-u);for(var g=r.normal.cdf(-u,0,1),y=a+1,w=y,p=e*e/(e*e+t),b=0,_=i.exp(-u*u/2),x=i.exp(-u*u/2-.5*i.log(2)-r.gammaln(3/2))*u;b<m||w>a||y>a;)w=y,b>0&&(_*=u*u/(2*b),x*=u*u/(2*(b+1/2))),y=_*r.beta.cdf(p,b+.5,t/2)+x*r.beta.cdf(p,b+1,t/2),g+=.5*y,b++;return v?1-g:g}}),r.extend(r.normal,{pdf:function(e,t,u){return i.exp(-.5*i.log(2*i.PI)-i.log(u)-i.pow(e-t,2)/(2*u*u))},cdf:function(e,t,u){return .5*(1+r.erf((e-t)/i.sqrt(2*u*u)))},inv:function(f,e,t){return-1.4142135623730951*t*r.erfcinv(2*f)+e},mean:function(f){return f},median:function(e){return e},mode:function(f){return f},sample:function(e,t){return r.randn()*t+e},variance:function(f,e){return e*e}}),r.extend(r.pareto,{pdf:function(e,t,u){return e<t?0:u*i.pow(t,u)/i.pow(e,u+1)},cdf:function(e,t,u){return e<t?0:1-i.pow(t/e,u)},inv:function(e,t,u){return t/i.pow(1-e,1/u)},mean:function(e,t){if(!(t<=1))return t*i.pow(e,t)/(t-1)},median:function(e,t){return e*(t*i.SQRT2)},mode:function(e){return e},variance:function(f,e){if(!(e<=2))return f*f*e/(i.pow(e-1,2)*(e-2))}}),r.extend(r.studentt,{pdf:function(e,t){return t=t>1e100?1e100:t,1/(i.sqrt(t)*r.betafn(.5,t/2))*i.pow(1+e*e/t,-((t+1)/2))},cdf:function(e,t){var u=t/2;return r.ibeta((e+i.sqrt(e*e+t))/(2*i.sqrt(e*e+t)),u,u)},inv:function(f,e){var t=r.ibetainv(2*i.min(f,1-f),.5*e,.5);return t=i.sqrt(e*(1-t)/t),f>.5?t:-t},mean:function(e){return e>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(e){return r.randn()*i.sqrt(e/(2*r.randg(e/2)))},variance:function(e){return e>2?e/(e-2):e>1?1/0:void 0}}),r.extend(r.weibull,{pdf:function(e,t,u){return e<0||t<0||u<0?0:u/t*i.pow(e/t,u-1)*i.exp(-i.pow(e/t,u))},cdf:function(e,t,u){return e<0?0:1-i.exp(-i.pow(e/t,u))},inv:function(f,e,t){return e*i.pow(-i.log(1-f),1/t)},mean:function(f,e){return f*r.gammafn(1+1/e)},median:function(e,t){return e*i.pow(i.log(2),1/t)},mode:function(e,t){return t<=1?0:e*i.pow((t-1)/t,1/t)},sample:function(e,t){return e*i.pow(-i.log(r._random_fn()),1/t)},variance:function(e,t){return e*e*r.gammafn(1+2/t)-i.pow(r.weibull.mean(e,t),2)}}),r.extend(r.uniform,{pdf:function(e,t,u){return e<t||e>u?0:1/(u-t)},cdf:function(e,t,u){return e<t?0:e<u?(e-t)/(u-t):1},inv:function(f,e,t){return e+f*(t-e)},mean:function(e,t){return .5*(e+t)},median:function(e,t){return r.mean(e,t)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(e,t){return e/2+t/2+(t/2-e/2)*(2*r._random_fn()-1)},variance:function(e,t){return i.pow(t-e,2)/12}});function l(f,e,t,u){for(var a=0,m=1,v=1,g=1,y=0,w=0,p;i.abs((v-w)/v)>u;)w=v,p=-(e+y)*(e+t+y)*f/(e+2*y)/(e+2*y+1),a=v+p*a,m=g+p*m,y=y+1,p=y*(t-y)*f/(e+2*y-1)/(e+2*y),v=a+p*v,g=m+p*g,a=a/g,m=m/g,v=v/g,g=1;return v/e}r.extend(r.binomial,{pdf:function(e,t,u){return u===0||u===1?t*u===e?1:0:r.combination(t,e)*i.pow(u,e)*i.pow(1-u,t-e)},cdf:function(e,t,u){var a,m=1e-10;if(e<0)return 0;if(e>=t)return 1;if(u<0||u>1||t<=0)return NaN;e=i.floor(e);var v=u,g=e+1,y=t-e,w=g+y,p=i.exp(r.gammaln(w)-r.gammaln(y)-r.gammaln(g)+g*i.log(v)+y*i.log(1-v));return v<(g+1)/(w+2)?a=p*l(v,g,y,m):a=1-p*l(1-v,y,g,m),i.round((1-a)*(1/m))/(1/m)}}),r.extend(r.negbin,{pdf:function(e,t,u){return e!==e>>>0?!1:e<0?0:r.combination(e+t-1,t-1)*i.pow(1-u,e)*i.pow(u,t)},cdf:function(e,t,u){var a=0,m=0;if(e<0)return 0;for(;m<=e;m++)a+=r.negbin.pdf(m,t,u);return a}}),r.extend(r.hypgeom,{pdf:function(e,t,u,a){if(e!==e|0)return!1;if(e<0||e<u-(t-a))return 0;if(e>a||e>u)return 0;if(u*2>t)return a*2>t?r.hypgeom.pdf(t-u-a+e,t,t-u,t-a):r.hypgeom.pdf(a-e,t,t-u,a);if(a*2>t)return r.hypgeom.pdf(u-e,t,u,t-a);if(u<a)return r.hypgeom.pdf(e,t,a,u);for(var m=1,v=0,g=0;g<e;g++){for(;m>1&&v<a;)m*=1-u/(t-v),v++;m*=(a-g)*(u-g)/((g+1)*(t-u-a+g+1))}for(;v<a;v++)m*=1-u/(t-v);return i.min(1,i.max(0,m))},cdf:function(e,t,u,a){if(e<0||e<u-(t-a))return 0;if(e>=a||e>=u)return 1;if(u*2>t)return a*2>t?r.hypgeom.cdf(t-u-a+e,t,t-u,t-a):1-r.hypgeom.cdf(a-e-1,t,t-u,a);if(a*2>t)return 1-r.hypgeom.cdf(u-e-1,t,u,t-a);if(u<a)return r.hypgeom.cdf(e,t,a,u);for(var m=1,v=1,g=0,y=0;y<e;y++){for(;m>1&&g<a;){var w=1-u/(t-g);v*=w,m*=w,g++}v*=(a-y)*(u-y)/((y+1)*(t-u-a+y+1)),m+=v}for(;g<a;g++)m*=1-u/(t-g);return i.min(1,i.max(0,m))}}),r.extend(r.poisson,{pdf:function(e,t){return t<0||e%1!==0||e<0?0:i.pow(t,e)*i.exp(-t)/r.factorial(e)},cdf:function(e,t){var u=[],a=0;if(e<0)return 0;for(;a<=e;a++)u.push(r.poisson.pdf(a,t));return r.sum(u)},mean:function(f){return f},variance:function(f){return f},sampleSmall:function(e){var t=1,u=0,a=i.exp(-e);do u++,t*=r._random_fn();while(t>a);return u-1},sampleLarge:function(e){var t=e,u,a,m,v,g,y,w,p,b,_;for(v=i.sqrt(t),g=i.log(t),w=.931+2.53*v,y=-.059+.02483*w,p=1.1239+1.1328/(w-3.4),b=.9277-3.6224/(w-2);;){if(a=i.random()-.5,m=i.random(),_=.5-i.abs(a),u=i.floor((2*y/_+w)*a+t+.43),_>=.07&&m<=b)return u;if(!(u<0||_<.013&&m>_)&&i.log(m)+i.log(p)-i.log(y/(_*_)+w)<=-t+u*g-r.loggam(u+1))return u}},sample:function(e){return e<10?this.sampleSmall(e):this.sampleLarge(e)}}),r.extend(r.triangular,{pdf:function(e,t,u,a){return u<=t||a<t||a>u?NaN:e<t||e>u?0:e<a?2*(e-t)/((u-t)*(a-t)):e===a?2/(u-t):2*(u-e)/((u-t)*(u-a))},cdf:function(e,t,u,a){return u<=t||a<t||a>u?NaN:e<=t?0:e>=u?1:e<=a?i.pow(e-t,2)/((u-t)*(a-t)):1-i.pow(u-e,2)/((u-t)*(u-a))},inv:function(e,t,u,a){return u<=t||a<t||a>u?NaN:e<=(a-t)/(u-t)?t+(u-t)*i.sqrt(e*((a-t)/(u-t))):t+(u-t)*(1-i.sqrt((1-e)*(1-(a-t)/(u-t))))},mean:function(e,t,u){return(e+t+u)/3},median:function(e,t,u){if(u<=(e+t)/2)return t-i.sqrt((t-e)*(t-u))/i.sqrt(2);if(u>(e+t)/2)return e+i.sqrt((t-e)*(u-e))/i.sqrt(2)},mode:function(e,t,u){return u},sample:function(e,t,u){var a=r._random_fn();return a<(u-e)/(t-e)?e+i.sqrt(a*(t-e)*(u-e)):t-i.sqrt((1-a)*(t-e)*(t-u))},variance:function(e,t,u){return(e*e+t*t+u*u-e*t-e*u-t*u)/18}}),r.extend(r.arcsine,{pdf:function(e,t,u){return u<=t?NaN:e<=t||e>=u?0:2/i.PI*i.pow(i.pow(u-t,2)-i.pow(2*e-t-u,2),-.5)},cdf:function(e,t,u){return e<t?0:e<u?2/i.PI*i.asin(i.sqrt((e-t)/(u-t))):1},inv:function(f,e,t){return e+(.5-.5*i.cos(i.PI*f))*(t-e)},mean:function(e,t){return t<=e?NaN:(e+t)/2},median:function(e,t){return t<=e?NaN:(e+t)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(e,t){return(e+t)/2+(t-e)/2*i.sin(2*i.PI*r.uniform.sample(0,1))},variance:function(e,t){return t<=e?NaN:i.pow(t-e,2)/8}});function c(f){return f/i.abs(f)}r.extend(r.laplace,{pdf:function(e,t,u){return u<=0?0:i.exp(-i.abs(e-t)/u)/(2*u)},cdf:function(e,t,u){return u<=0?0:e<t?.5*i.exp((e-t)/u):1-.5*i.exp(-(e-t)/u)},mean:function(f){return f},median:function(f){return f},mode:function(f){return f},variance:function(f,e){return 2*e*e},sample:function(e,t){var u=r._random_fn()-.5;return e-t*c(u)*i.log(1-2*i.abs(u))}});function h(f,e,t){var u=12,a=6,m=-30,v=-50,g=60,y=8,w=3,p=2,b=3,_=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],x=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],k=f*.5;if(k>=y)return 1;var E=2*r.normal.cdf(k,0,1,1,0)-1;E>=i.exp(v/t)?E=i.pow(E,t):E=0;var N;f>w?N=p:N=b;for(var $=k,A=(y-k)/N,q=$+A,I=0,R=t-1,W=1;W<=N;W++){for(var O=0,P=.5*(q+$),L=.5*(q-$),T=1;T<=u;T++){var D,U;a<T?(D=u-T+1,U=_[D-1]):(D=T,U=-_[D-1]);var X=L*U,C=P+X,j=C*C;if(j>g)break;var wn=2*r.normal.cdf(C,0,1,1,0),ue=2*r.normal.cdf(C,f,1,1,0),un=wn*.5-ue*.5;un>=i.exp(m/R)&&(un=x[D-1]*i.exp(-(.5*j))*i.pow(un,R),O+=un)}O*=2*L*t/i.sqrt(2*i.PI),I+=O,$=q,q+=A}return E+=I,E<=i.exp(m/e)?0:(E=i.pow(E,e),E>=1?1:E)}function d(f,e,t){var u=.322232421088,a=.099348462606,m=-1,v=.588581570495,g=-.342242088547,y=.531103462366,w=-.204231210125,p=.10353775285,b=-453642210148e-16,_=.0038560700634,x=.8832,k=.2368,E=1.208,N=1.4142,$=120,A=.5-.5*f,q=i.sqrt(i.log(1/(A*A))),I=q+((((q*b+w)*q+g)*q+m)*q+u)/((((q*_+p)*q+y)*q+v)*q+a);t<$&&(I+=(I*I*I+I)/t/4);var R=x-k*I;return t<$&&(R+=-1.214/t+E*I/t),I*(R*i.log(e-1)+N)}r.extend(r.tukey,{cdf:function(e,t,u){var a=1,m=t,v=16,g=8,y=-30,w=1e-14,p=100,b=800,_=5e3,x=25e3,k=1,E=.5,N=.25,$=.125,A=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],q=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(e<=0)return 0;if(u<2||a<1||m<2)return NaN;if(!Number.isFinite(e))return 1;if(u>x)return h(e,a,m);var I=u*.5,R=I*i.log(u)-u*i.log(2)-r.gammaln(I),W=I-1,O=u*.25,P;u<=p?P=k:u<=b?P=E:u<=_?P=N:P=$,R+=i.log(P);for(var L=0,T=1;T<=50;T++){for(var D=0,U=(2*T-1)*P,X=1;X<=v;X++){var C,j;g<X?(C=X-g-1,j=R+W*i.log(U+A[C]*P)-(A[C]*P+U)*O):(C=X-1,j=R+W*i.log(U-A[C]*P)+(A[C]*P-U)*O);var wn;if(j>=y){g<X?wn=e*i.sqrt((A[C]*P+U)*.5):wn=e*i.sqrt((-(A[C]*P)+U)*.5);var ue=h(wn,a,m),un=ue*q[C]*i.exp(j);D+=un}}if(T*P>=1&&D<=w)break;L+=D}if(D>w)throw new Error("tukey.cdf failed to converge");return L>1&&(L=1),L},inv:function(f,e,t){var u=1,a=e,m=1e-4,v=50;if(t<2||u<1||a<2)return NaN;if(f<0||f>1)return NaN;if(f===0)return 0;if(f===1)return 1/0;var g=d(f,a,t),y=r.tukey.cdf(g,e,t)-f,w;y>0?w=i.max(0,g-1):w=g+1;for(var p=r.tukey.cdf(w,e,t)-f,b,_=1;_<v;_++){b=w-p*(w-g)/(p-y),y=p,g=w,b<0&&(b=0,p=-f),p=r.tukey.cdf(b,e,t)-f,w=b;var x=i.abs(w-g);if(x<m)return b}throw new Error("tukey.inv failed to converge")}})}(s,Math),function(r,i){var l=Array.prototype.push,c=r.utils.isArray;function h(d){return c(d)||d instanceof r}r.extend({add:function(f,e){return h(e)?(h(e[0])||(e=[e]),r.map(f,function(t,u,a){return t+e[u][a]})):r.map(f,function(t){return t+e})},subtract:function(f,e){return h(e)?(h(e[0])||(e=[e]),r.map(f,function(t,u,a){return t-e[u][a]||0})):r.map(f,function(t){return t-e})},divide:function(f,e){return h(e)?(h(e[0])||(e=[e]),r.multiply(f,r.inv(e))):r.map(f,function(t){return t/e})},multiply:function(f,e){var t,u,a,m,v,g,y,w;if(f.length===void 0&&e.length===void 0)return f*e;if(v=f.length,g=f[0].length,y=r.zeros(v,a=h(e)?e[0].length:g),w=0,h(e)){for(;w<a;w++)for(t=0;t<v;t++){for(m=0,u=0;u<g;u++)m+=f[t][u]*e[u][w];y[t][w]=m}return v===1&&w===1?y[0][0]:y}return r.map(f,function(p){return p*e})},outer:function(f,e){return r.multiply(f.map(function(t){return[t]}),[e])},dot:function(f,e){h(f[0])||(f=[f]),h(e[0])||(e=[e]);for(var t=f[0].length===1&&f.length!==1?r.transpose(f):f,u=e[0].length===1&&e.length!==1?r.transpose(e):e,a=[],m=0,v=t.length,g=t[0].length,y,w;m<v;m++){for(a[m]=[],y=0,w=0;w<g;w++)y+=t[m][w]*u[m][w];a[m]=y}return a.length===1?a[0]:a},pow:function(f,e){return r.map(f,function(t){return i.pow(t,e)})},exp:function(f){return r.map(f,function(e){return i.exp(e)})},log:function(f){return r.map(f,function(e){return i.log(e)})},abs:function(f){return r.map(f,function(e){return i.abs(e)})},norm:function(f,e){var t=0,u=0;for(isNaN(e)&&(e=2),h(f[0])&&(f=f[0]);u<f.length;u++)t+=i.pow(i.abs(f[u]),e);return i.pow(t,1/e)},angle:function(f,e){return i.acos(r.dot(f,e)/(r.norm(f)*r.norm(e)))},aug:function(f,e){var t=[],u;for(u=0;u<f.length;u++)t.push(f[u].slice());for(u=0;u<t.length;u++)l.apply(t[u],e[u]);return t},inv:function(f){for(var e=f.length,t=f[0].length,u=r.identity(e,t),a=r.gauss_jordan(f,u),m=[],v=0,g;v<e;v++)for(m[v]=[],g=t;g<a[0].length;g++)m[v][g-t]=a[v][g];return m},det:function d(f){if(f.length===2)return f[0][0]*f[1][1]-f[0][1]*f[1][0];for(var e=0,t=0;t<f.length;t++){for(var u=[],a=1;a<f.length;a++){u[a-1]=[];for(var m=0;m<f.length;m++)m<t?u[a-1][m]=f[a][m]:m>t&&(u[a-1][m-1]=f[a][m])}var v=t%2?-1:1;e+=d(u)*f[0][t]*v}return e},gauss_elimination:function(f,e){var t=0,u=0,a=f.length,m=f[0].length,v=1,g=0,y=[],w,p,b,_;for(f=r.aug(f,e),w=f[0].length,t=0;t<a;t++){for(p=f[t][t],u=t,_=t+1;_<m;_++)p<i.abs(f[_][t])&&(p=f[_][t],u=_);if(u!=t)for(_=0;_<w;_++)b=f[t][_],f[t][_]=f[u][_],f[u][_]=b;for(u=t+1;u<a;u++)for(v=f[u][t]/f[t][t],_=t;_<w;_++)f[u][_]=f[u][_]-v*f[t][_]}for(t=a-1;t>=0;t--){for(g=0,u=t+1;u<=a-1;u++)g=g+y[u]*f[t][u];y[t]=(f[t][w-1]-g)/f[t][t]}return y},gauss_jordan:function(f,e){var t=r.aug(f,e),u=t.length,a=t[0].length,m=0,v,g,y;for(g=0;g<u;g++){var w=g;for(y=g+1;y<u;y++)i.abs(t[y][g])>i.abs(t[w][g])&&(w=y);var p=t[g];for(t[g]=t[w],t[w]=p,y=g+1;y<u;y++)for(m=t[y][g]/t[g][g],v=g;v<a;v++)t[y][v]-=t[g][v]*m}for(g=u-1;g>=0;g--){for(m=t[g][g],y=0;y<g;y++)for(v=a-1;v>g-1;v--)t[y][v]-=t[g][v]*t[y][g]/m;for(t[g][g]/=m,v=u;v<a;v++)t[g][v]/=m}return t},triaUpSolve:function(f,e){var t=f[0].length,u=r.zeros(1,t)[0],a,m=!1;return e[0].length!=null&&(e=e.map(function(v){return v[0]}),m=!0),r.arange(t-1,-1,-1).forEach(function(v){a=r.arange(v+1,t).map(function(g){return u[g]*f[v][g]}),u[v]=(e[v]-r.sum(a))/f[v][v]}),m?u.map(function(v){return[v]}):u},triaLowSolve:function(f,e){var t=f[0].length,u=r.zeros(1,t)[0],a,m=!1;return e[0].length!=null&&(e=e.map(function(v){return v[0]}),m=!0),r.arange(t).forEach(function(v){a=r.arange(v).map(function(g){return f[v][g]*u[g]}),u[v]=(e[v]-r.sum(a))/f[v][v]}),m?u.map(function(v){return[v]}):u},lu:function(f){var e=f.length,t=r.identity(e),u=r.zeros(f.length,f[0].length),a;return r.arange(e).forEach(function(m){u[0][m]=f[0][m]}),r.arange(1,e).forEach(function(m){r.arange(m).forEach(function(v){a=r.arange(v).map(function(g){return t[m][g]*u[g][v]}),t[m][v]=(f[m][v]-r.sum(a))/u[v][v]}),r.arange(m,e).forEach(function(v){a=r.arange(m).map(function(g){return t[m][g]*u[g][v]}),u[m][v]=f[a.length][v]-r.sum(a)})}),[t,u]},cholesky:function(f){var e=f.length,t=r.zeros(f.length,f[0].length),u;return r.arange(e).forEach(function(a){u=r.arange(a).map(function(m){return i.pow(t[a][m],2)}),t[a][a]=i.sqrt(f[a][a]-r.sum(u)),r.arange(a+1,e).forEach(function(m){u=r.arange(a).map(function(v){return t[a][v]*t[m][v]}),t[m][a]=(f[a][m]-r.sum(u))/t[a][a]})}),t},gauss_jacobi:function(f,e,t,u){for(var a=0,m=0,v=f.length,g=[],y=[],w=[],p,b,_,x;a<v;a++)for(g[a]=[],y[a]=[],w[a]=[],m=0;m<v;m++)a>m?(g[a][m]=f[a][m],y[a][m]=w[a][m]=0):a<m?(y[a][m]=f[a][m],g[a][m]=w[a][m]=0):(w[a][m]=f[a][m],g[a][m]=y[a][m]=0);for(_=r.multiply(r.multiply(r.inv(w),r.add(g,y)),-1),b=r.multiply(r.inv(w),e),p=t,x=r.add(r.multiply(_,t),b),a=2;i.abs(r.norm(r.subtract(x,p)))>u;)p=x,x=r.add(r.multiply(_,p),b),a++;return x},gauss_seidel:function(f,e,t,u){for(var a=0,m=f.length,v=[],g=[],y=[],w,p,b,_,x;a<m;a++)for(v[a]=[],g[a]=[],y[a]=[],w=0;w<m;w++)a>w?(v[a][w]=f[a][w],g[a][w]=y[a][w]=0):a<w?(g[a][w]=f[a][w],v[a][w]=y[a][w]=0):(y[a][w]=f[a][w],v[a][w]=g[a][w]=0);for(_=r.multiply(r.multiply(r.inv(r.add(y,v)),g),-1),b=r.multiply(r.inv(r.add(y,v)),e),p=t,x=r.add(r.multiply(_,t),b),a=2;i.abs(r.norm(r.subtract(x,p)))>u;)p=x,x=r.add(r.multiply(_,p),b),a=a+1;return x},SOR:function(f,e,t,u,a){for(var m=0,v=f.length,g=[],y=[],w=[],p,b,_,x,k;m<v;m++)for(g[m]=[],y[m]=[],w[m]=[],p=0;p<v;p++)m>p?(g[m][p]=f[m][p],y[m][p]=w[m][p]=0):m<p?(y[m][p]=f[m][p],g[m][p]=w[m][p]=0):(w[m][p]=f[m][p],g[m][p]=y[m][p]=0);for(x=r.multiply(r.inv(r.add(w,r.multiply(g,a))),r.subtract(r.multiply(w,1-a),r.multiply(y,a))),_=r.multiply(r.multiply(r.inv(r.add(w,r.multiply(g,a))),e),a),b=t,k=r.add(r.multiply(x,t),_),m=2;i.abs(r.norm(r.subtract(k,b)))>u;)b=k,k=r.add(r.multiply(x,b),_),m++;return k},householder:function(f){for(var e=f.length,t=f[0].length,u=0,a=[],m=[],v,g,y,w,p;u<e-1;u++){for(v=0,w=u+1;w<t;w++)v+=f[w][u]*f[w][u];for(p=f[u+1][u]>0?-1:1,v=p*i.sqrt(v),g=i.sqrt((v*v-f[u+1][u]*v)/2),a=r.zeros(e,1),a[u+1][0]=(f[u+1][u]-v)/(2*g),y=u+2;y<e;y++)a[y][0]=f[y][u]/(2*g);m=r.subtract(r.identity(e,t),r.multiply(r.multiply(a,r.transpose(a)),2)),f=r.multiply(m,r.multiply(f,m))}return f},QR:function(){var d=r.sum,f=r.arange;function e(t){var u=t.length,a=t[0].length,m=r.zeros(a,a);t=r.copy(t);var v,g,y;for(g=0;g<a;g++){for(m[g][g]=i.sqrt(d(f(u).map(function(w){return t[w][g]*t[w][g]}))),v=0;v<u;v++)t[v][g]=t[v][g]/m[g][g];for(y=g+1;y<a;y++)for(m[g][y]=d(f(u).map(function(w){return t[w][g]*t[w][y]})),v=0;v<u;v++)t[v][y]=t[v][y]-t[v][g]*m[g][y]}return[t,m]}return e}(),lstsq:function(){function d(e){e=r.copy(e);var t=e.length,u=r.identity(t);return r.arange(t-1,-1,-1).forEach(function(a){r.sliceAssign(u,{row:a},r.divide(r.slice(u,{row:a}),e[a][a])),r.sliceAssign(e,{row:a},r.divide(r.slice(e,{row:a}),e[a][a])),r.arange(a).forEach(function(m){var v=r.multiply(e[m][a],-1),g=r.slice(e,{row:m}),y=r.multiply(r.slice(e,{row:a}),v);r.sliceAssign(e,{row:m},r.add(g,y));var w=r.slice(u,{row:m}),p=r.multiply(r.slice(u,{row:a}),v);r.sliceAssign(u,{row:m},r.add(w,p))})}),u}function f(e,t){var u=!1;t[0].length===void 0&&(t=t.map(function(x){return[x]}),u=!0);var a=r.QR(e),m=a[0],v=a[1],g=e[0].length,y=r.slice(m,{col:{end:g}}),w=r.slice(v,{row:{end:g}}),p=d(w),b=r.transpose(y);b[0].length===void 0&&(b=[b]);var _=r.multiply(r.multiply(p,b),t);return _.length===void 0&&(_=[[_]]),u?_.map(function(x){return x[0]}):_}return f}(),jacobi:function(f){for(var e=1,t=f.length,u=r.identity(t,t),a=[],m,v,g,y,w,p,b,_;e===1;){for(p=f[0][1],y=0,w=1,v=0;v<t;v++)for(g=0;g<t;g++)v!=g&&p<i.abs(f[v][g])&&(p=i.abs(f[v][g]),y=v,w=g);for(f[y][y]===f[w][w]?b=f[y][w]>0?i.PI/4:-i.PI/4:b=i.atan(2*f[y][w]/(f[y][y]-f[w][w]))/2,_=r.identity(t,t),_[y][y]=i.cos(b),_[y][w]=-i.sin(b),_[w][y]=i.sin(b),_[w][w]=i.cos(b),u=r.multiply(u,_),m=r.multiply(r.multiply(r.inv(_),f),_),f=m,e=0,v=1;v<t;v++)for(g=1;g<t;g++)v!=g&&i.abs(f[v][g])>.001&&(e=1)}for(v=0;v<t;v++)a.push(f[v][v]);return[u,a]},rungekutta:function(f,e,t,u,a,m){var v,g,y,w,p;if(m===2)for(;u<=t;)v=e*f(u,a),g=e*f(u+e,a+v),y=a+(v+g)/2,a=y,u=u+e;if(m===4)for(;u<=t;)v=e*f(u,a),g=e*f(u+e/2,a+v/2),w=e*f(u+e/2,a+g/2),p=e*f(u+e,a+w),y=a+(v+2*g+2*w+p)/6,a=y,u=u+e;return a},romberg:function(f,e,t,u){for(var a=0,m=(t-e)/2,v=[],g=[],y=[],w,p,b,_,x;a<u/2;){for(x=f(e),b=e,_=0;b<=t;b=b+m,_++)v[_]=b;for(w=v.length,b=1;b<w-1;b++)x+=(b%2!==0?4:2)*f(v[b]);x=m/3*(x+f(t)),y[a]=x,m/=2,a++}for(p=y.length,w=1;p!==1;){for(b=0;b<p-1;b++)g[b]=(i.pow(4,w)*y[b+1]-y[b])/(i.pow(4,w)-1);p=g.length,y=g,g=[],w++}return y},richardson:function(f,e,t,u){function a(k,E){for(var N=0,$=k.length,A;N<$;N++)k[N]===E&&(A=N);return A}for(var m=i.abs(t-f[a(f,t)+1]),v=0,g=[],y=[],w,p,b,_,x;u>=m;)w=a(f,t+u),p=a(f,t),g[v]=(e[w]-2*e[p]+e[2*p-w])/(u*u),u/=2,v++;for(_=g.length,b=1;_!=1;){for(x=0;x<_-1;x++)y[x]=(i.pow(4,b)*g[x+1]-g[x])/(i.pow(4,b)-1);_=y.length,g=y,y=[],b++}return g},simpson:function(f,e,t,u){for(var a=(t-e)/u,m=f(e),v=[],g=e,y=0,w=1,p;g<=t;g=g+a,y++)v[y]=g;for(p=v.length;w<p-1;w++)m+=(w%2!==0?4:2)*f(v[w]);return a/3*(m+f(t))},hermite:function(f,e,t,u){for(var a=f.length,m=0,v=0,g=[],y=[],w=[],p=[],b;v<a;v++){for(g[v]=1,b=0;b<a;b++)v!=b&&(g[v]*=(u-f[b])/(f[v]-f[b]));for(y[v]=0,b=0;b<a;b++)v!=b&&(y[v]+=1/(f[v]-f[b]));w[v]=(1-2*(u-f[v])*y[v])*(g[v]*g[v]),p[v]=(u-f[v])*(g[v]*g[v]),m+=w[v]*e[v]+p[v]*t[v]}return m},lagrange:function(f,e,t){for(var u=0,a=0,m,v,g=f.length;a<g;a++){for(v=e[a],m=0;m<g;m++)a!=m&&(v*=(t-f[m])/(f[a]-f[m]));u+=v}return u},cubic_spline:function(f,e,t){for(var u=f.length,a=0,m,v=[],g=[],y=[],w=[],p=[],b=[],_=[];a<u-1;a++)p[a]=f[a+1]-f[a];for(y[0]=0,a=1;a<u-1;a++)y[a]=3/p[a]*(e[a+1]-e[a])-3/p[a-1]*(e[a]-e[a-1]);for(a=1;a<u-1;a++)v[a]=[],g[a]=[],v[a][a-1]=p[a-1],v[a][a]=2*(p[a-1]+p[a]),v[a][a+1]=p[a],g[a][0]=y[a];for(w=r.multiply(r.inv(v),g),m=0;m<u-1;m++)b[m]=(e[m+1]-e[m])/p[m]-p[m]*(w[m+1][0]+2*w[m][0])/3,_[m]=(w[m+1][0]-w[m][0])/(3*p[m]);for(m=0;m<u&&!(f[m]>t);m++);return m-=1,e[m]+(t-f[m])*b[m]+r.sq(t-f[m])*w[m]+(t-f[m])*r.sq(t-f[m])*_[m]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(f){var e=f.length,t=f[0].length,u=0,a,m,v=[],g=[],y=[],w=[],p=[],b=[],_=[],x=[],k=[],E=[];for(u=0;u<e;u++)v[u]=r.sum(f[u])/t;for(u=0;u<t;u++)for(_[u]=[],a=0;a<e;a++)_[u][a]=f[a][u]-v[a];for(_=r.transpose(_),u=0;u<e;u++)for(x[u]=[],a=0;a<e;a++)x[u][a]=r.dot([_[u]],[_[a]])/(t-1);for(y=r.jacobi(x),k=y[0],g=y[1],E=r.transpose(k),u=0;u<g.length;u++)for(a=u;a<g.length;a++)g[u]<g[a]&&(m=g[u],g[u]=g[a],g[a]=m,w=E[u],E[u]=E[a],E[a]=w);for(b=r.transpose(_),u=0;u<e;u++)for(p[u]=[],a=0;a<b.length;a++)p[u][a]=r.dot([E[u]],[b[a]]);return[f,g,E,p]}}),function(d){for(var f=0;f<d.length;f++)(function(e){r.fn[e]=function(t,u){var a=this;return u?(setTimeout(function(){u.call(a,r.fn[e].call(a,t))},15),this):typeof r[e](this,t)=="number"?r[e](this,t):r(r[e](this,t))}})(d[f])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(s,Math),function(r,i){var l=[].slice,c=r.utils.isNumber,h=r.utils.isArray;r.extend({zscore:function(){var e=l.call(arguments);return c(e[1])?(e[0]-e[1])/e[2]:(e[0]-r.mean(e[1]))/r.stdev(e[1],e[2])},ztest:function(){var e=l.call(arguments),t;return h(e[1])?(t=r.zscore(e[0],e[1],e[3]),e[2]===1?r.normal.cdf(-i.abs(t),0,1):r.normal.cdf(-i.abs(t),0,1)*2):e.length>2?(t=r.zscore(e[0],e[1],e[2]),e[3]===1?r.normal.cdf(-i.abs(t),0,1):r.normal.cdf(-i.abs(t),0,1)*2):(t=e[0],e[1]===1?r.normal.cdf(-i.abs(t),0,1):r.normal.cdf(-i.abs(t),0,1)*2)}}),r.extend(r.fn,{zscore:function(e,t){return(e-this.mean())/this.stdev(t)},ztest:function(e,t,u){var a=i.abs(this.zscore(e,u));return t===1?r.normal.cdf(-a,0,1):r.normal.cdf(-a,0,1)*2}}),r.extend({tscore:function(){var e=l.call(arguments);return e.length===4?(e[0]-e[1])/(e[2]/i.sqrt(e[3])):(e[0]-r.mean(e[1]))/(r.stdev(e[1],!0)/i.sqrt(e[1].length))},ttest:function(){var e=l.call(arguments),t;return e.length===5?(t=i.abs(r.tscore(e[0],e[1],e[2],e[3])),e[4]===1?r.studentt.cdf(-t,e[3]-1):r.studentt.cdf(-t,e[3]-1)*2):c(e[1])?(t=i.abs(e[0]),e[2]==1?r.studentt.cdf(-t,e[1]-1):r.studentt.cdf(-t,e[1]-1)*2):(t=i.abs(r.tscore(e[0],e[1])),e[2]==1?r.studentt.cdf(-t,e[1].length-1):r.studentt.cdf(-t,e[1].length-1)*2)}}),r.extend(r.fn,{tscore:function(e){return(e-this.mean())/(this.stdev(!0)/i.sqrt(this.cols()))},ttest:function(e,t){return t===1?1-r.studentt.cdf(i.abs(this.tscore(e)),this.cols()-1):r.studentt.cdf(-i.abs(this.tscore(e)),this.cols()-1)*2}}),r.extend({anovafscore:function(){var e=l.call(arguments),t,u,a,m,v,g,y,w;if(e.length===1){for(v=new Array(e[0].length),y=0;y<e[0].length;y++)v[y]=e[0][y];e=v}for(u=new Array,y=0;y<e.length;y++)u=u.concat(e[y]);for(a=r.mean(u),t=0,y=0;y<e.length;y++)t=t+e[y].length*i.pow(r.mean(e[y])-a,2);for(t/=e.length-1,g=0,y=0;y<e.length;y++)for(m=r.mean(e[y]),w=0;w<e[y].length;w++)g+=i.pow(e[y][w]-m,2);return g/=u.length-e.length,t/g},anovaftest:function(){var e=l.call(arguments),t,u,a,m;if(c(e[0]))return 1-r.centralF.cdf(e[0],e[1],e[2]);var v=r.anovafscore(e);for(t=e.length-1,a=0,m=0;m<e.length;m++)a=a+e[m].length;return u=a-t-1,1-r.centralF.cdf(v,t,u)},ftest:function(e,t,u){return 1-r.centralF.cdf(e,t,u)}}),r.extend(r.fn,{anovafscore:function(){return r.anovafscore(this.toArray())},anovaftes:function(){var e=0,t;for(t=0;t<this.length;t++)e=e+this[t].length;return r.ftest(this.anovafscore(),this.length-1,e-this.length)}}),r.extend({qscore:function(){var e=l.call(arguments),t,u,a,m,v;return c(e[0])?(t=e[0],u=e[1],a=e[2],m=e[3],v=e[4]):(t=r.mean(e[0]),u=r.mean(e[1]),a=e[0].length,m=e[1].length,v=e[2]),i.abs(t-u)/(v*i.sqrt((1/a+1/m)/2))},qtest:function(){var e=l.call(arguments),t;e.length===3?(t=e[0],e=e.slice(1)):e.length===7?(t=r.qscore(e[0],e[1],e[2],e[3],e[4]),e=e.slice(5)):(t=r.qscore(e[0],e[1],e[2]),e=e.slice(3));var u=e[0],a=e[1];return 1-r.tukey.cdf(t,a,u-a)},tukeyhsd:function(e){for(var t=r.pooledstdev(e),u=e.map(function(w){return r.mean(w)}),a=e.reduce(function(w,p){return w+p.length},0),m=[],v=0;v<e.length;++v)for(var g=v+1;g<e.length;++g){var y=r.qtest(u[v],u[g],e[v].length,e[g].length,t,a,e.length);m.push([[v,g],y])}return m}}),r.extend({normalci:function(){var e=l.call(arguments),t=new Array(2),u;return e.length===4?u=i.abs(r.normal.inv(e[1]/2,0,1)*e[2]/i.sqrt(e[3])):u=i.abs(r.normal.inv(e[1]/2,0,1)*r.stdev(e[2])/i.sqrt(e[2].length)),t[0]=e[0]-u,t[1]=e[0]+u,t},tci:function(){var e=l.call(arguments),t=new Array(2),u;return e.length===4?u=i.abs(r.studentt.inv(e[1]/2,e[3]-1)*e[2]/i.sqrt(e[3])):u=i.abs(r.studentt.inv(e[1]/2,e[2].length-1)*r.stdev(e[2],!0)/i.sqrt(e[2].length)),t[0]=e[0]-u,t[1]=e[0]+u,t},significant:function(e,t){return e<t}}),r.extend(r.fn,{normalci:function(e,t){return r.normalci(e,t,this.toArray())},tci:function(e,t){return r.tci(e,t,this.toArray())}});function d(f,e,t,u){if(f>1||t>1||f<=0||t<=0)throw new Error("Proportions should be greater than 0 and less than 1");var a=(f*e+t*u)/(e+u),m=i.sqrt(a*(1-a)*(1/e+1/u));return(f-t)/m}r.extend(r.fn,{oneSidedDifferenceOfProportions:function(e,t,u,a){var m=d(e,t,u,a);return r.ztest(m,1)},twoSidedDifferenceOfProportions:function(e,t,u,a){var m=d(e,t,u,a);return r.ztest(m,2)}})}(s,Math),s.models=function(){function r(d){var f=d[0].length,e=s.arange(f).map(function(t){var u=s.arange(f).filter(function(a){return a!==t});return i(s.col(d,t).map(function(a){return a[0]}),s.col(d,u))});return e}function i(d,f){var e=d.length,t=f[0].length-1,u=e-t-1,a=s.lstsq(f,d),m=s.multiply(f,a.map(function(_){return[_]})).map(function(_){return _[0]}),v=s.subtract(d,m),g=s.mean(d),y=s.sum(m.map(function(_){return Math.pow(_-g,2)})),w=s.sum(d.map(function(_,x){return Math.pow(_-m[x],2)})),p=y+w,b=y/p;return{exog:f,endog:d,nobs:e,df_model:t,df_resid:u,coef:a,predict:m,resid:v,ybar:g,SST:p,SSE:y,SSR:w,R2:b}}function l(d){var f=r(d.exog),e=Math.sqrt(d.SSR/d.df_resid),t=f.map(function(g){var y=g.SST,w=g.R2;return e/Math.sqrt(y*(1-w))}),u=d.coef.map(function(g,y){return(g-0)/t[y]}),a=u.map(function(g){var y=s.studentt.cdf(g,d.df_resid);return(y>.5?1-y:y)*2}),m=s.studentt.inv(.975,d.df_resid),v=d.coef.map(function(g,y){var w=m*t[y];return[g-w,g+w]});return{se:t,t:u,p:a,sigmaHat:e,interval95:v}}function c(d){var f=d.R2/d.df_model/((1-d.R2)/d.df_resid),e=function(u,a,m){return s.beta.cdf(u/(m/a+u),a/2,m/2)},t=1-e(f,d.df_model,d.df_resid);return{F_statistic:f,pvalue:t}}function h(d,f){var e=i(d,f),t=l(e),u=c(e),a=1-(1-e.R2)*((e.nobs-1)/e.df_resid);return e.t=t,e.f=u,e.adjust_R2=a,e}return{ols:h}}(),s.extend({buildxmatrix:function(){for(var i=new Array(arguments.length),l=0;l<arguments.length;l++){var c=[1];i[l]=c.concat(arguments[l])}return s(i)},builddxmatrix:function(){for(var i=new Array(arguments[0].length),l=0;l<arguments[0].length;l++){var c=[1];i[l]=c.concat(arguments[0][l])}return s(i)},buildjxmatrix:function(i){for(var l=new Array(i.length),c=0;c<i.length;c++)l[c]=i[c];return s.builddxmatrix(l)},buildymatrix:function(i){return s(i).transpose()},buildjymatrix:function(i){return i.transpose()},matrixmult:function(i,l){var c,h,d,f,e;if(i.cols()==l.rows()){if(l.rows()>1){for(f=[],c=0;c<i.rows();c++)for(f[c]=[],h=0;h<l.cols();h++){for(e=0,d=0;d<i.cols();d++)e+=i.toArray()[c][d]*l.toArray()[d][h];f[c][h]=e}return s(f)}for(f=[],c=0;c<i.rows();c++)for(f[c]=[],h=0;h<l.cols();h++){for(e=0,d=0;d<i.cols();d++)e+=i.toArray()[c][d]*l.toArray()[h];f[c][h]=e}return s(f)}},regress:function(i,l){var c=s.xtranspxinv(i),h=i.transpose(),d=s.matrixmult(s(c),h);return s.matrixmult(d,l)},regresst:function(i,l,c){var h=s.regress(i,l),d={};d.anova={};var f=s.jMatYBar(i,h);d.yBar=f;var e=l.mean();d.anova.residuals=s.residuals(l,f),d.anova.ssr=s.ssr(f,e),d.anova.msr=d.anova.ssr/(i[0].length-1),d.anova.sse=s.sse(l,f),d.anova.mse=d.anova.sse/(l.length-(i[0].length-1)-1),d.anova.sst=s.sst(l,e),d.anova.mst=d.anova.sst/(l.length-1),d.anova.r2=1-d.anova.sse/d.anova.sst,d.anova.r2<0&&(d.anova.r2=0),d.anova.fratio=d.anova.msr/d.anova.mse,d.anova.pvalue=s.anovaftest(d.anova.fratio,i[0].length-1,l.length-(i[0].length-1)-1),d.anova.rmse=Math.sqrt(d.anova.mse),d.anova.r2adj=1-d.anova.mse/d.anova.mst,d.anova.r2adj<0&&(d.anova.r2adj=0),d.stats=new Array(i[0].length);for(var t=s.xtranspxinv(i),u,a,m,v=0;v<h.length;v++)u=Math.sqrt(d.anova.mse*Math.abs(t[v][v])),a=Math.abs(h[v]/u),m=s.ttest(a,l.length-i[0].length-1,c),d.stats[v]=[h[v],u,a,m];return d.regress=h,d},xtranspx:function(i){return s.matrixmult(i.transpose(),i)},xtranspxinv:function(i){var l=s.matrixmult(i.transpose(),i),c=s.inv(l);return c},jMatYBar:function(i,l){var c=s.matrixmult(i,l);return new s(c)},residuals:function(i,l){return s.matrixsubtract(i,l)},ssr:function(i,l){for(var c=0,h=0;h<i.length;h++)c+=Math.pow(i[h]-l,2);return c},sse:function(i,l){for(var c=0,h=0;h<i.length;h++)c+=Math.pow(i[h]-l[h],2);return c},sst:function(i,l){for(var c=0,h=0;h<i.length;h++)c+=Math.pow(i[h]-l,2);return c},matrixsubtract:function(i,l){for(var c=new Array(i.length),h=0;h<i.length;h++){c[h]=new Array(i[h].length);for(var d=0;d<i[h].length;d++)c[h][d]=i[h][d]-l[h][d]}return s(c)}}),s.jStat=s,s})}(Vn)),Vn.exports}var H=Iu();const Ru=Math.log(1e3),Pu=.5,Tu=1,jn={populationSize:1e4,geneEnvWeight:.5,envNoiseStd:.1,financeWeight:.7,financeNoise:.1,homophily:{gene:0,env:0}};function Cu(n){const o=[];for(let s=0;s<n.populationSize;s++){const r=[H.normal.sample(0,1),H.normal.sample(0,1)],i=H.normal.sample(0,1),l={id:s,alleles:r,meanAllele:(r[0]+r[1])/2,parentIncome:1e5,env:i,rawenv:i,educationScore:H.normal.sample(0,1),parents:null,income:0};l.income=Kr(l,n),o.push(l)}return o}function zu(n,o){return o.geneEnvWeight*n.meanAllele+(1-o.geneEnvWeight)*n.env}function Fu(n,o){const s=n.map(h=>h.parentIncome),r=H.rank(s),l=s.length+1,c=1/l;n.forEach((h,d)=>{const f=Math.max(r[d]/l,c);h.rawenv=H.normal.inv(f,0,1),h.env=h.rawenv+H.normal.sample(0,o.envNoiseStd)})}function Kr(n,o){function s(l,c){const h=c===0?0:H.normal.sample(0,c),d=Math.exp(Ru+Pu*l+h),f=H.normal.cdf(l,0,1),e=Math.min(Math.max(1-f,Number.EPSILON),1),t=Math.pow(e,-1/Tu);return d*t}const r=s(n.educationScore,o.financeNoise);return o.financeWeight*r+(1-o.financeWeight)*(s(n.rawenv,0)+n.parentIncome*H.beta.sample(.01,1))}function Lu(n,o){const s=n.length;if(n.length<2)throw new Error(`selectMatingPool: need at least two agents, got ${n.length}`);const{homophily:r,kd:i}=o,l=(i==null?void 0:i.kNeighbors)??10,c=125,h=r.gene===1?c:r.gene/(1-r.gene),d=r.env===1?c:r.env/(1-r.env),f=n.map((y,w)=>({meanAllele:y.meanAllele,env:y.env,idx:w})),e=(y,w)=>h*Math.abs(y.meanAllele-w.meanAllele)+d*Math.abs(y.env-w.env),t=new $u.kdTree(f,e,["meanAllele","env"]);function u(y){const w=y.slice();for(let p=w.length-1;p>0;p--){const b=Math.floor(Math.random()*(p+1));[w[p],w[b]]=[w[b],w[p]]}return w}const a=Math.floor(s/2),m=u(f).slice(0,a),v=[],g=(r.gene+r.env)/2;for(const y of m){let w=-1;if(Math.random()>g)w=Math.floor(Math.random()*s);else{let p=t.nearest(y,l+1).filter(([R])=>R.idx!==y.idx);if(p.length===0)throw new Error(`selectMatingPool: no available mates for agent index ${y.idx}`);const b=p.map(([,R])=>R),_=Math.min(...b),x=b.map(R=>R-_),k=700,N=x.map(R=>Math.min(R,k)).map(R=>Math.exp(-R)),$=N.reduce((R,W)=>R+W,0);let A=Math.random()*$,q=0;for(;A>N[q];)A-=N[q++];w=p[q][0].idx}v.push({a:n[y.idx],b:n[w]})}return v}function Hu(n,o,s){const r=n.a.income+n.b.income,i=[];for(let l=0;l<2;l++){const c={id:s+l,alleles:[Math.random()<.01?H.normal.sample(0,1):n.a.alleles[Math.floor(Math.random()*2)],Math.random()<.01?H.normal.sample(0,1):n.b.alleles[Math.floor(Math.random()*2)]],parentIncome:r,educationScore:0,parents:[{id:n.a.id,alleles:n.a.alleles,meanAllele:n.a.meanAllele,parentIncome:n.a.parentIncome,env:n.a.env,rawenv:n.a.rawenv,educationScore:n.a.educationScore,income:n.a.income,parents:null},{id:n.b.id,alleles:n.b.alleles,meanAllele:n.b.meanAllele,parentIncome:n.b.parentIncome,env:n.b.env,rawenv:n.b.rawenv,educationScore:n.b.educationScore,income:n.b.income,parents:null}]};i.push(c)}return i}function Ou(n,o){const s=Lu(n,o),r=[];let i=0;return s.forEach(l=>{Hu(l,o,i).forEach(h=>{r.push(h),i++})}),Fu(r,o),r.forEach(l=>{const[c,h]=l.alleles;l.meanAllele=(c+h)/2}),r.forEach(l=>{l.educationScore=zu(l,o),l.income=Kr(l,o)}),r}function Gu(n,o){let r=[...n].sort((i,l)=>-i.income+l.income).map(i=>i[o]);return["income","parentIncome"].includes(o)&&(r=r.map(i=>Math.log10(i+1))),r}function Bu(n,o,s,r,i,l=!1){const c=n.getContext("2d"),h=n.width/r,d=n.height/s;c.clearRect(0,0,n.width,n.height),o.forEach((f,e)=>{const t=Math.floor(e/r),u=e%r;c.fillStyle=i(f),c.fillRect(u*h,t*d,h,d)})}function Jr(n){const o=[...n].sort((c,h)=>c.income-h.income),s=o.length,r=vt(o,c=>c.income)||0;let i=0;const l=[[0,0]];return o.forEach((c,h)=>{i+=c.income,l.push([(h+1)/s,r>0?i/r:0])}),l}function Zr(n){if(n.length===0)return 0;const s=Jr(n.map(i=>({income:i})));let r=0;for(let i=1;i<s.length;i++){const[l,c]=s[i-1],[h,d]=s[i];r+=(c+d)/2*(h-l)}return 1-2*r}function Vu(n,o){const s=+n.attr("width"),r=+n.attr("height"),i={top:20,right:20,bottom:30,left:40},l=s-i.left-i.right,c=r-i.top-i.bottom;n.selectAll("*").remove();const h=Jr(o),d=fn().domain([0,1]).range([0,l]),f=fn().domain([0,1]).range([c,0]),e=n.append("g").attr("transform",`translate(${i.left},${i.top})`);e.append("line").attr("x1",d(0)).attr("y1",f(0)).attr("x2",d(1)).attr("y2",f(1)).attr("stroke","#999").attr("stroke-dasharray","4,4");const t=Yr().x(u=>d(u[0])).y(u=>f(u[1]));e.append("path").datum(h).attr("d",t).attr("fill","none").attr("stroke","tomato").attr("stroke-width",2),e.append("g").attr("transform",`translate(0,${c})`).call(Dn(d).ticks(5)),e.append("g").call(Ee(f).ticks(5))}function Wu(n,o){const s=+n.attr("width"),r=+n.attr("height"),i={top:20,right:20,bottom:30,left:40},l=s-i.left-i.right,c=r-i.top-i.bottom;n.selectAll("*").remove();const h=fn().domain([0,Math.max(1,o.length-1)]).range([0,l]),d=fn().domain([0,1]).range([c,0]),f=n.append("g").attr("transform",`translate(${i.left},${i.top})`),e=Yr().x((t,u)=>h(u)).y(t=>d(t));f.append("path").datum(o).attr("d",e).attr("fill","none").attr("stroke","steelblue").attr("stroke-width",2),f.append("g").attr("transform",`translate(0,${c})`).call(Dn(h).ticks(5)),f.append("g").call(Ee(d).ticks(5))}function Du(n,o,s=20,r=!1){const i=+n.attr("width"),l=+n.attr("height"),c={top:20,right:20,bottom:75,left:40},h=i-c.left-c.right,d=l-c.top-c.bottom;n.selectAll("*").remove();const f=fn().domain(Nn(o)).nice().range([0,h]),e=dt().domain(f.domain()).thresholds(s)(o),t=fn().domain([0,Oe(e,a=>a.length)]).nice().range([d,0]),u=n.append("g").attr("transform",`translate(${c.left},${c.top})`);if(u.selectAll("rect").data(e).enter().append("rect").attr("x",a=>f(a.x0)+1).attr("y",a=>t(a.length)).attr("width",a=>Math.max(0,f(a.x1)-f(a.x0)-1)).attr("height",a=>d-t(a.length)).attr("fill","steelblue"),r){const a=ht(o),m=Oe(o),v=mt(1,15).filter(g=>g>a&&g<m);u.append("g").attr("transform",`translate(0,${d})`).call(Dn(f).tickValues(v).tickFormat(g=>ze(",")(Math.pow(10,g)))),u.selectAll("text").attr("text-anchor","end").attr("transform","rotate(-45)").attr("dx","-0.8em").attr("dy","0.15em")}else u.append("g").attr("transform",`translate(0,${d})`).call(Dn(f).ticks(5));u.append("g").call(Ee(t).ticks(5))}const _n=[{id:"overview",title:"Overview",content:`
      <h2>Agent-Based Inheritance & Socioeconomic Simulator</h2>
      <p>This interactive model shows how traits and resources flow from one generation to the next through four stages:</p>
      <ol>
        <li><strong>Parent Genes → Genes</strong></li>
        <li><strong>Parent Wealth → Environmental Endowment</strong></li>
        <li><strong>Genes + Environment → Education Level</strong></li>
        <li><strong>Education + Parent Wealth → Child Wealth</strong></li>
      </ol>
      <p>Adjust the sliders to explore how inheritance, environment, education, and chance combine to shape inequality over time.</p>
    `},{id:"technical",title:"Technical Architecture",content:`
      <h3>Technical Architecture</h3>
      <p>The <code>index.html</code> file defines static UI elements (divisions, canvas, controls). When you load the page, the browser parses this HTML, then executes the compiled JavaScript (from <code>main.ts</code>).</p>
      <p>TypeScript is a typed superset of JavaScript: you write <code>*.ts</code> files, and the <code>vite</code> tool compiles them to <code>*.js</code> for the browser. This provides strong typing and a modern development experience with zero runtime penalty.</p>
      <p><code>main.ts</code> initializes UI controls, injects help sections, and calls functions from <code>model.ts</code> to run the agent-based simulation each generation, including custom mating logic.</p>
    `},{id:"implementation",title:"Implementation Details",content:`
      <h3>How the Model Runs</h3>
      <ul>
        <li>Genes: inherited randomly from two parents with optional mutation.</li>
        <li>Environment: set by parents’ wealth each generation.</li>
        <li>Education: weighted mix of genes vs. environment (Gene → Education slider).</li>
        <li>Wealth: weighted mix of education vs. parental wealth (Education → Wealth slider).</li>
        <li>Accident Noise: optional Gaussian noise in environment and wealth (Env Quality Noise, Finance Success Noise).</li>
        <li>Mating Logic: random or assortative by genes/environment controlled by homophily sliders.</li>
      </ul>
    `},{id:"plots",title:"Plots",content:`
      <h3>Plots</h3>
      <ul>
        <li><strong>Population Raster</strong>: grid of agents colored by the selected attribute.</li>
        <li><strong>Lorenz Curve</strong>: cumulative share of agents vs. cumulative share of wealth.</li>
        <li><strong>Gini Coefficient</strong>: summary statistic (0–1) of wealth inequality.</li>
        <li><strong>Histogram</strong>: distribution of genes, environment, education, or wealth.</li>
        <li><strong>Time Series</strong>: tracks summary stats across generations.</li>
      </ul>
    `},{id:"controls",title:"Controls",content:`
      <h3>Controls</h3>
      <ul>
        <li><strong>Start</strong>: begin continuous simulation.</li>
        <li><strong>Pause</strong>: pause the simulation.</li>
        <li><strong>Reset</strong>: return to Generation 0.</li>
        <li><strong>Step</strong>: advance one generation.</li>
      </ul>
      <dl>
        <dt>Color by</dt>
        <dd>Choose Genes, Environmental Endowment, Education Level, or Wealth.</dd>
        <dt>Env Quality Noise σ</dt>
        <dd>Gaussian noise in environment (e.g., random exposures).</dd>
        <dt>Gene → Education Weight</dt>
        <dd>Mix of innate talent vs. environment in education:</dd>
        <dd>
          <ul>
            <li>1 = pure meritocratic utopia (talent only)</li>
            <li>0 = environmental determinism (parental influence only)</li>
          </ul>
        </dd>
        <dt>Education → Wealth Weight</dt>
        <dd>Mix of education vs. inheritance in wealth:</dd>
        <dd>
          <ul>
            <li>1 = meritocracy (education only)</li>
            <li>0 = aristocracy (inheritance only)</li>
          </ul>
        </dd>
        <dt>Finance Success Noise σ</dt>
        <dd>Random luck/accident in wealth attainment.</dd>
        <dt>Gene Homophily</dt>
        <dd>Assortative mating by genes (0 = random; 1 = nearest neighbors).</dd>
        <dt>Environment Homophily</dt>
        <dd>Assortative mating by environment (0 = random; 1 = nearest neighbors).</dd>
      </dl>
    `},{id:"context",title:"Political & Philosophical Context",content:`
      <h3>Political & Philosophical Context</h3>
      <p><strong>Gene vs. Environment slider extremes:</strong></p>
      <ul>
        <li><em>1 (genes only):</em> Utopian meritocracy where success depends solely on talent.</li>
        <li><em>0 (environment only):</em> Environmental determinism akin to nepotism or inherited privilege.</li>
      </ul>
      <p><strong>Education vs. Wealth slider extremes:</strong></p>
      <ul>
        <li><em>1 (education only):</em> Pure meritocracy (education drives wealth).</li>
        <li><em>0 (inheritance only):</em> Aristocracy (wealth inherited unchanged).</li>
      </ul>
      <p><strong>Combined extremes:</strong></p>
      <ul>
        <li>Full meritocracy: Gene→Education=1 & Education→Wealth=1.</li>
        <li>Full aristocracy: Gene→Education=0 & Education→Wealth=0.</li>
      </ul>
      <p><strong>Homophily sliders:</strong></p>
      <ul>
        <li>0 = random mating (no assortative pairing).</li>
        <li>1 = strict nearest‐neighbor mating (social segregation).</li>
      </ul>
      <p>Use these settings to explore thought experiments on equality of opportunity, inherited privilege, and social stratification.</p>
    `},{id:"extensions",title:"Extensions & Ideas",content:`
      <h3>Extensions & Experimental Interventions</h3>
      <ul>
        <li><strong>Targeted Supports:</strong> e.g. zero out Env Quality Noise for the bottom 20% to model educational aid for disadvantaged groups.</li>
        <li><strong>Genetic Interventions:</strong> e.g. override gene influences for low-scoring agents to simulate special education or medical treatments.</li>
        <li><strong>Redistribution Schemes:</strong> apply progressive/regressive taxes to final wealth and observe Gini changes.</li>
        <li><strong>Limitations:</strong> focuses on wealth, not broader quality of life or equality of condition (Sandel’s critique).</li>
      </ul>
    `},{id:"extras",title:"Extras & Tooltips",content:`
      <h3>Extras & Tooltips</h3>
      <ul>
        <li><strong>Hover</strong> over plots for precise values.</li>
        <li><strong>Legends</strong> map colors to numeric ranges.</li>
        <li><code>i</code> icon opens inheritance & inequality primer.</li>
        <li>Auto-update toggle re-runs the simulation live when sliders move.</li>
      </ul>
    `}];document.addEventListener("DOMContentLoaded",()=>{const n=document.getElementById("help-dropdown"),o=document.getElementById("help-container");_n.forEach(r=>{const i=document.createElement("option");i.value=r.id,i.textContent=r.title,n.append(i)});function s(r){const i=_n.find(l=>l.id===r);o.innerHTML=i?i.content:""}n.addEventListener("change",()=>{s(n.value)}),_n.length>0&&(n.value=_n[0].id,s(_n[0].id))});let Z={...jn,homophily:{...jn.homophily}},S=[],ln=[],Fe=0,pn=!1;const Uu=750,Qu=document.getElementById("start-btn"),Yu=document.getElementById("pause-btn"),Ku=document.getElementById("reset-btn"),ne=document.getElementById("feature-select"),Ju=document.getElementById("step-btn"),Zu=document.getElementById("status"),Xu=document.getElementById("slider-gene-env"),Mu=document.getElementById("label-gene-env"),Su=document.getElementById("slider-env-noise"),ju=document.getElementById("label-env-noise"),na=document.getElementById("slider-fin-weight"),ea=document.getElementById("label-fin-weight"),ra=document.getElementById("slider-fin-noise"),ta=document.getElementById("label-fin-noise"),ia=document.getElementById("slider-hom-gene"),oa=document.getElementById("label-hom-gene"),fa=document.getElementById("slider-hom-env"),ua=document.getElementById("label-hom-env"),dn=document.getElementById("raster"),Xr=dn.getContext("2d");if(!Xr)throw new Error("Canvas 2D context not available");dn.width=400;dn.height=400;const aa=$e("#lorenz"),sa=$e("#gini"),ca=$e("#histogram"),la=document.getElementById("hist-title");function da(n){const o=Math.ceil(Math.sqrt(n));return{rows:Math.ceil(n/o),cols:o}}function yn(n,o,s,r){const i=()=>{const l=parseFloat(n.value);switch(r(l),s){case"geneEnv":o.textContent=`Env ${((1-l)*100).toFixed(0)}% / ${(l*100).toFixed(0)}% Gene`;break;case"finWeight":o.textContent=`Parent wealth ${((1-l)*100).toFixed(0)}% / ${(l*100).toFixed(0)}% Education`;break;case"homEnv":case"homGene":o.textContent=`Random ${((1-l)*100).toFixed(0)}% / ${(l*100).toFixed(0)}% Homophily`;break;case"envNoise":case"finNoise":o.textContent=`Normal(0, ${l.toFixed(2)})`}};n.addEventListener("input",i),i()}const sr={meanAllele:sn(pu),env:sn(bu),educationScore:sn(wu),income:sn(gu),parentIncome:sn(yu)};function Mr(){Z={...jn,homophily:{...jn.homophily}},S=Cu(Z),ln.length=0,Fe=0;const n=S.map(o=>o.income);ln.push(Zr(n)),He()}function Le(){S=Ou(S,Z);const n=S.map(o=>o.income);ln.push(Zr(n)),Fe+=1,He(),pn&&setTimeout(Le,Uu)}function He(){const n=ne.value,o=Gu(S,n);Xr.clearRect(0,0,dn.width,dn.height);const{rows:s,cols:r}=da(o.length),[i,l]=Nn(o);sr[n].domain([i,l]),Bu(dn,o,s,r,sr[n]),Vu(aa,S),Wu(sa,ln),la.textContent=`Distribution of ${n}`,Du(ca,o,20,!!["income","educationScore"].includes(n));const c=ln[ln.length-1]??0;Zu.textContent=`Gen: ${Fe} | Gini: ${c.toFixed(2)} | Pop: ${S.length} | Feature: ${n}`}Qu.addEventListener("click",()=>{pn||(pn=!0,Le())});Yu.addEventListener("click",()=>{pn=!1});Ku.addEventListener("click",()=>{pn=!1,Mr()});Ju.addEventListener("click",()=>{pn||Le()});ne.addEventListener("change",He);yn(Xu,Mu,"geneEnv",n=>Z.geneEnvWeight=n);yn(Su,ju,"envNoise",n=>Z.envNoiseStd=n);yn(na,ea,"finWeight",n=>Z.financeWeight=n);yn(ra,ta,"finNoise",n=>Z.financeNoise=n);yn(ia,oa,"homGene",n=>Z.homophily.gene=n);yn(fa,ua,"homEnv",n=>Z.homophily.env=n);(function(){["meanAllele","env","educationScore","income","parentIncome"].forEach(o=>{const s=document.createElement("option");s.value=o,s.textContent=o,ne.appendChild(s)}),ne.value="income"})();Mr();
