(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const c of i)if(c.type==="childList")for(const l of c.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function s(i){const c={};return i.integrity&&(c.integrity=i.integrity),i.referrerPolicy&&(c.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?c.credentials="include":i.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function r(i){if(i.ep)return;i.ep=!0;const c=s(i);fetch(i.href,c)}})();function On(n,o){return n==null||o==null?NaN:n<o?-1:n>o?1:n>=o?0:NaN}function nt(n,o){return n==null||o==null?NaN:o<n?-1:o>n?1:o>=n?0:NaN}function dr(n){let o,s,r;n.length!==2?(o=On,s=(h,d)=>On(n(h),d),r=(h,d)=>n(h)-d):(o=n===On||n===nt?n:et,s=n,r=n);function i(h,d,f=0,e=h.length){if(f<e){if(o(d,d)!==0)return e;do{const t=f+e>>>1;s(h[t],d)<0?f=t+1:e=t}while(f<e)}return f}function c(h,d,f=0,e=h.length){if(f<e){if(o(d,d)!==0)return e;do{const t=f+e>>>1;s(h[t],d)<=0?f=t+1:e=t}while(f<e)}return f}function l(h,d,f=0,e=h.length){const t=i(h,d,f,e-1);return t>f&&r(h[t-1],d)>-r(h[t],d)?t-1:t}return{left:i,center:l,right:c}}function et(){return 0}function rt(n){return n===null?NaN:+n}const tt=dr(On),hr=tt.right;dr(rt).center;function it(n,o){let s=0;for(let r of n)r!=null&&(r=+r)>=r&&++s;return s}function Nn(n,o){let s,r;if(o===void 0)for(const i of n)i!=null&&(s===void 0?i>=i&&(s=r=i):(s>i&&(s=i),r<i&&(r=i)));else{let i=-1;for(let c of n)(c=o(c,++i,n))!=null&&(s===void 0?c>=c&&(s=r=c):(s>c&&(s=c),r<c&&(r=c)))}return[s,r]}function ot(n){return n}var ft=Array.prototype,ut=ft.slice;function se(n){return()=>n}const at=Math.sqrt(50),st=Math.sqrt(10),lt=Math.sqrt(2);function Vn(n,o,s){const r=(o-n)/Math.max(0,s),i=Math.floor(Math.log10(r)),c=r/Math.pow(10,i),l=c>=at?10:c>=st?5:c>=lt?2:1;let h,d,f;return i<0?(f=Math.pow(10,-i)/l,h=Math.round(n*f),d=Math.round(o*f),h/f<n&&++h,d/f>o&&--d,f=-f):(f=Math.pow(10,i)*l,h=Math.round(n/f),d=Math.round(o/f),h*f<n&&++h,d*f>o&&--d),d<h&&.5<=s&&s<2?Vn(n,o,s*2):[h,d,f]}function mr(n,o,s){if(o=+o,n=+n,s=+s,!(s>0))return[];if(n===o)return[n];const r=o<n,[i,c,l]=r?Vn(o,n,s):Vn(n,o,s);if(!(c>=i))return[];const h=c-i+1,d=new Array(h);if(r)if(l<0)for(let f=0;f<h;++f)d[f]=(c-f)/-l;else for(let f=0;f<h;++f)d[f]=(c-f)*l;else if(l<0)for(let f=0;f<h;++f)d[f]=(i+f)/-l;else for(let f=0;f<h;++f)d[f]=(i+f)*l;return d}function hn(n,o,s){return o=+o,n=+n,s=+s,Vn(n,o,s)[2]}function ct(n,o,s){o=+o,n=+n,s=+s;const r=o<n,i=r?hn(o,n,s):hn(n,o,s);return(r?-1:1)*(i<0?1/-i:i)}function dt(n,o,s){let r;for(;;){const i=hn(n,o,s);if(i===r||i===0||!isFinite(i))return[n,o];i>0?(n=Math.floor(n/i)*i,o=Math.ceil(o/i)*i):i<0&&(n=Math.ceil(n*i)/i,o=Math.floor(o*i)/i),r=i}}function ht(n){return Math.max(1,Math.ceil(Math.log(it(n))/Math.LN2)+1)}function mt(){var n=ot,o=Nn,s=ht;function r(i){Array.isArray(i)||(i=Array.from(i));var c,l=i.length,h,d,f=new Array(l);for(c=0;c<l;++c)f[c]=n(i[c],c,i);var e=o(f),t=e[0],u=e[1],a=s(f,t,u);if(!Array.isArray(a)){const p=u,b=+a;if(o===Nn&&([t,u]=dt(t,u,b)),a=mr(t,u,b),a[0]<=t&&(d=hn(t,u,b)),a[a.length-1]>=u)if(p>=u&&o===Nn){const _=hn(t,u,b);isFinite(_)&&(_>0?u=(Math.floor(u/_)+1)*_:_<0&&(u=(Math.ceil(u*-_)+1)/-_))}else a.pop()}for(var m=a.length,v=0,g=m;a[v]<=t;)++v;for(;a[g-1]>u;)--g;(v||g<m)&&(a=a.slice(v,g),m=g-v);var w=new Array(m+1),y;for(c=0;c<=m;++c)y=w[c]=[],y.x0=c>0?a[c-1]:t,y.x1=c<m?a[c]:u;if(isFinite(d)){if(d>0)for(c=0;c<l;++c)(h=f[c])!=null&&t<=h&&h<=u&&w[Math.min(m,Math.floor((h-t)/d))].push(i[c]);else if(d<0){for(c=0;c<l;++c)if((h=f[c])!=null&&t<=h&&h<=u){const p=Math.floor((t-h)*d);w[Math.min(m,p+(a[p]<=h))].push(i[c])}}}else for(c=0;c<l;++c)(h=f[c])!=null&&t<=h&&h<=u&&w[hr(a,h,0,m)].push(i[c]);return w}return r.value=function(i){return arguments.length?(n=typeof i=="function"?i:se(i),r):n},r.domain=function(i){return arguments.length?(o=typeof i=="function"?i:se([i[0],i[1]]),r):o},r.thresholds=function(i){return arguments.length?(s=typeof i=="function"?i:se(Array.isArray(i)?ut.call(i):i),r):s},r}function We(n,o){let s;if(o===void 0)for(const r of n)r!=null&&(s<r||s===void 0&&r>=r)&&(s=r);else{let r=-1;for(let i of n)(i=o(i,++r,n))!=null&&(s<i||s===void 0&&i>=i)&&(s=i)}return s}function vt(n,o){let s;for(const r of n)r!=null&&(s>r||s===void 0&&r>=r)&&(s=r);return s}function gt(n,o,s){n=+n,o=+o,s=(i=arguments.length)<2?(o=n,n=0,1):i<3?1:+s;for(var r=-1,i=Math.max(0,Math.ceil((o-n)/s))|0,c=new Array(i);++r<i;)c[r]=n+r*s;return c}function pt(n,o){let s=0;if(o===void 0)for(let r of n)(r=+r)&&(s+=r);else{let r=-1;for(let i of n)(i=+o(i,++r,n))&&(s+=i)}return s}function wt(n){return n}var le=1,ce=2,me=3,xn=4,He=1e-6;function yt(n){return"translate("+n+",0)"}function bt(n){return"translate(0,"+n+")"}function _t(n){return o=>+n(o)}function xt(n,o){return o=Math.max(0,n.bandwidth()-o*2)/2,n.round()&&(o=Math.round(o)),s=>+n(s)+o}function kt(){return!this.__axis}function vr(n,o){var s=[],r=null,i=null,c=6,l=6,h=3,d=typeof window<"u"&&window.devicePixelRatio>1?0:.5,f=n===le||n===xn?-1:1,e=n===xn||n===ce?"x":"y",t=n===le||n===me?yt:bt;function u(a){var m=r??(o.ticks?o.ticks.apply(o,s):o.domain()),v=i??(o.tickFormat?o.tickFormat.apply(o,s):wt),g=Math.max(c,0)+h,w=o.range(),y=+w[0]+d,p=+w[w.length-1]+d,b=(o.bandwidth?xt:_t)(o.copy(),d),_=a.selection?a.selection():a,x=_.selectAll(".domain").data([null]),k=_.selectAll(".tick").data(m,o).order(),E=k.exit(),N=k.enter().append("g").attr("class","tick"),$=k.select("line"),A=k.select("text");x=x.merge(x.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),k=k.merge(N),$=$.merge(N.append("line").attr("stroke","currentColor").attr(e+"2",f*c)),A=A.merge(N.append("text").attr("fill","currentColor").attr(e,f*g).attr("dy",n===le?"0em":n===me?"0.71em":"0.32em")),a!==_&&(x=x.transition(a),k=k.transition(a),$=$.transition(a),A=A.transition(a),E=E.transition(a).attr("opacity",He).attr("transform",function(q){return isFinite(q=b(q))?t(q+d):this.getAttribute("transform")}),N.attr("opacity",He).attr("transform",function(q){var R=this.parentNode.__axis;return t((R&&isFinite(R=R(q))?R:b(q))+d)})),E.remove(),x.attr("d",n===xn||n===ce?l?"M"+f*l+","+y+"H"+d+"V"+p+"H"+f*l:"M"+d+","+y+"V"+p:l?"M"+y+","+f*l+"V"+d+"H"+p+"V"+f*l:"M"+y+","+d+"H"+p),k.attr("opacity",1).attr("transform",function(q){return t(b(q)+d)}),$.attr(e+"2",f*c),A.attr(e,f*g).text(v),_.filter(kt).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",n===ce?"start":n===xn?"end":"middle"),_.each(function(){this.__axis=b})}return u.scale=function(a){return arguments.length?(o=a,u):o},u.ticks=function(){return s=Array.from(arguments),u},u.tickArguments=function(a){return arguments.length?(s=a==null?[]:Array.from(a),u):s.slice()},u.tickValues=function(a){return arguments.length?(r=a==null?null:Array.from(a),u):r&&r.slice()},u.tickFormat=function(a){return arguments.length?(i=a,u):i},u.tickSize=function(a){return arguments.length?(c=l=+a,u):c},u.tickSizeInner=function(a){return arguments.length?(c=+a,u):c},u.tickSizeOuter=function(a){return arguments.length?(l=+a,u):l},u.tickPadding=function(a){return arguments.length?(h=+a,u):h},u.offset=function(a){return arguments.length?(d=+a,u):d},u}function Dn(n){return vr(me,n)}function Ae(n){return vr(xn,n)}var Et={value:()=>{}};function gr(){for(var n=0,o=arguments.length,s={},r;n<o;++n){if(!(r=arguments[n]+"")||r in s||/[\s.]/.test(r))throw new Error("illegal type: "+r);s[r]=[]}return new Wn(s)}function Wn(n){this._=n}function At(n,o){return n.trim().split(/^|\s+/).map(function(s){var r="",i=s.indexOf(".");if(i>=0&&(r=s.slice(i+1),s=s.slice(0,i)),s&&!o.hasOwnProperty(s))throw new Error("unknown type: "+s);return{type:s,name:r}})}Wn.prototype=gr.prototype={constructor:Wn,on:function(n,o){var s=this._,r=At(n+"",s),i,c=-1,l=r.length;if(arguments.length<2){for(;++c<l;)if((i=(n=r[c]).type)&&(i=Nt(s[i],n.name)))return i;return}if(o!=null&&typeof o!="function")throw new Error("invalid callback: "+o);for(;++c<l;)if(i=(n=r[c]).type)s[i]=Ge(s[i],n.name,o);else if(o==null)for(i in s)s[i]=Ge(s[i],n.name,null);return this},copy:function(){var n={},o=this._;for(var s in o)n[s]=o[s].slice();return new Wn(n)},call:function(n,o){if((i=arguments.length-2)>0)for(var s=new Array(i),r=0,i,c;r<i;++r)s[r]=arguments[r+2];if(!this._.hasOwnProperty(n))throw new Error("unknown type: "+n);for(c=this._[n],r=0,i=c.length;r<i;++r)c[r].value.apply(o,s)},apply:function(n,o,s){if(!this._.hasOwnProperty(n))throw new Error("unknown type: "+n);for(var r=this._[n],i=0,c=r.length;i<c;++i)r[i].value.apply(o,s)}};function Nt(n,o){for(var s=0,r=n.length,i;s<r;++s)if((i=n[s]).name===o)return i.value}function Ge(n,o,s){for(var r=0,i=n.length;r<i;++r)if(n[r].name===o){n[r]=Et,n=n.slice(0,r).concat(n.slice(r+1));break}return s!=null&&n.push({name:o,value:s}),n}var ve="http://www.w3.org/1999/xhtml";const Be={svg:"http://www.w3.org/2000/svg",xhtml:ve,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function ee(n){var o=n+="",s=o.indexOf(":");return s>=0&&(o=n.slice(0,s))!=="xmlns"&&(n=n.slice(s+1)),Be.hasOwnProperty(o)?{space:Be[o],local:n}:n}function $t(n){return function(){var o=this.ownerDocument,s=this.namespaceURI;return s===ve&&o.documentElement.namespaceURI===ve?o.createElement(n):o.createElementNS(s,n)}}function qt(n){return function(){return this.ownerDocument.createElementNS(n.space,n.local)}}function pr(n){var o=ee(n);return(o.local?qt:$t)(o)}function Rt(){}function Ne(n){return n==null?Rt:function(){return this.querySelector(n)}}function It(n){typeof n!="function"&&(n=Ne(n));for(var o=this._groups,s=o.length,r=new Array(s),i=0;i<s;++i)for(var c=o[i],l=c.length,h=r[i]=new Array(l),d,f,e=0;e<l;++e)(d=c[e])&&(f=n.call(d,d.__data__,e,c))&&("__data__"in d&&(f.__data__=d.__data__),h[e]=f);return new F(r,this._parents)}function Pt(n){return n==null?[]:Array.isArray(n)?n:Array.from(n)}function Tt(){return[]}function wr(n){return n==null?Tt:function(){return this.querySelectorAll(n)}}function zt(n){return function(){return Pt(n.apply(this,arguments))}}function Ct(n){typeof n=="function"?n=zt(n):n=wr(n);for(var o=this._groups,s=o.length,r=[],i=[],c=0;c<s;++c)for(var l=o[c],h=l.length,d,f=0;f<h;++f)(d=l[f])&&(r.push(n.call(d,d.__data__,f,l)),i.push(d));return new F(r,i)}function yr(n){return function(){return this.matches(n)}}function br(n){return function(o){return o.matches(n)}}var Ft=Array.prototype.find;function Lt(n){return function(){return Ft.call(this.children,n)}}function Ot(){return this.firstElementChild}function Wt(n){return this.select(n==null?Ot:Lt(typeof n=="function"?n:br(n)))}var Ht=Array.prototype.filter;function Gt(){return Array.from(this.children)}function Bt(n){return function(){return Ht.call(this.children,n)}}function Vt(n){return this.selectAll(n==null?Gt:Bt(typeof n=="function"?n:br(n)))}function Dt(n){typeof n!="function"&&(n=yr(n));for(var o=this._groups,s=o.length,r=new Array(s),i=0;i<s;++i)for(var c=o[i],l=c.length,h=r[i]=[],d,f=0;f<l;++f)(d=c[f])&&n.call(d,d.__data__,f,c)&&h.push(d);return new F(r,this._parents)}function _r(n){return new Array(n.length)}function Ut(){return new F(this._enter||this._groups.map(_r),this._parents)}function Un(n,o){this.ownerDocument=n.ownerDocument,this.namespaceURI=n.namespaceURI,this._next=null,this._parent=n,this.__data__=o}Un.prototype={constructor:Un,appendChild:function(n){return this._parent.insertBefore(n,this._next)},insertBefore:function(n,o){return this._parent.insertBefore(n,o)},querySelector:function(n){return this._parent.querySelector(n)},querySelectorAll:function(n){return this._parent.querySelectorAll(n)}};function Qt(n){return function(){return n}}function Yt(n,o,s,r,i,c){for(var l=0,h,d=o.length,f=c.length;l<f;++l)(h=o[l])?(h.__data__=c[l],r[l]=h):s[l]=new Un(n,c[l]);for(;l<d;++l)(h=o[l])&&(i[l]=h)}function Kt(n,o,s,r,i,c,l){var h,d,f=new Map,e=o.length,t=c.length,u=new Array(e),a;for(h=0;h<e;++h)(d=o[h])&&(u[h]=a=l.call(d,d.__data__,h,o)+"",f.has(a)?i[h]=d:f.set(a,d));for(h=0;h<t;++h)a=l.call(n,c[h],h,c)+"",(d=f.get(a))?(r[h]=d,d.__data__=c[h],f.delete(a)):s[h]=new Un(n,c[h]);for(h=0;h<e;++h)(d=o[h])&&f.get(u[h])===d&&(i[h]=d)}function Jt(n){return n.__data__}function Zt(n,o){if(!arguments.length)return Array.from(this,Jt);var s=o?Kt:Yt,r=this._parents,i=this._groups;typeof n!="function"&&(n=Qt(n));for(var c=i.length,l=new Array(c),h=new Array(c),d=new Array(c),f=0;f<c;++f){var e=r[f],t=i[f],u=t.length,a=Xt(n.call(e,e&&e.__data__,f,r)),m=a.length,v=h[f]=new Array(m),g=l[f]=new Array(m),w=d[f]=new Array(u);s(e,t,v,g,w,a,o);for(var y=0,p=0,b,_;y<m;++y)if(b=v[y]){for(y>=p&&(p=y+1);!(_=g[p])&&++p<m;);b._next=_||null}}return l=new F(l,r),l._enter=h,l._exit=d,l}function Xt(n){return typeof n=="object"&&"length"in n?n:Array.from(n)}function Mt(){return new F(this._exit||this._groups.map(_r),this._parents)}function St(n,o,s){var r=this.enter(),i=this,c=this.exit();return typeof n=="function"?(r=n(r),r&&(r=r.selection())):r=r.append(n+""),o!=null&&(i=o(i),i&&(i=i.selection())),s==null?c.remove():s(c),r&&i?r.merge(i).order():i}function jt(n){for(var o=n.selection?n.selection():n,s=this._groups,r=o._groups,i=s.length,c=r.length,l=Math.min(i,c),h=new Array(i),d=0;d<l;++d)for(var f=s[d],e=r[d],t=f.length,u=h[d]=new Array(t),a,m=0;m<t;++m)(a=f[m]||e[m])&&(u[m]=a);for(;d<i;++d)h[d]=s[d];return new F(h,this._parents)}function ni(){for(var n=this._groups,o=-1,s=n.length;++o<s;)for(var r=n[o],i=r.length-1,c=r[i],l;--i>=0;)(l=r[i])&&(c&&l.compareDocumentPosition(c)^4&&c.parentNode.insertBefore(l,c),c=l);return this}function ei(n){n||(n=ri);function o(t,u){return t&&u?n(t.__data__,u.__data__):!t-!u}for(var s=this._groups,r=s.length,i=new Array(r),c=0;c<r;++c){for(var l=s[c],h=l.length,d=i[c]=new Array(h),f,e=0;e<h;++e)(f=l[e])&&(d[e]=f);d.sort(o)}return new F(i,this._parents).order()}function ri(n,o){return n<o?-1:n>o?1:n>=o?0:NaN}function ti(){var n=arguments[0];return arguments[0]=this,n.apply(null,arguments),this}function ii(){return Array.from(this)}function oi(){for(var n=this._groups,o=0,s=n.length;o<s;++o)for(var r=n[o],i=0,c=r.length;i<c;++i){var l=r[i];if(l)return l}return null}function fi(){let n=0;for(const o of this)++n;return n}function ui(){return!this.node()}function ai(n){for(var o=this._groups,s=0,r=o.length;s<r;++s)for(var i=o[s],c=0,l=i.length,h;c<l;++c)(h=i[c])&&n.call(h,h.__data__,c,i);return this}function si(n){return function(){this.removeAttribute(n)}}function li(n){return function(){this.removeAttributeNS(n.space,n.local)}}function ci(n,o){return function(){this.setAttribute(n,o)}}function di(n,o){return function(){this.setAttributeNS(n.space,n.local,o)}}function hi(n,o){return function(){var s=o.apply(this,arguments);s==null?this.removeAttribute(n):this.setAttribute(n,s)}}function mi(n,o){return function(){var s=o.apply(this,arguments);s==null?this.removeAttributeNS(n.space,n.local):this.setAttributeNS(n.space,n.local,s)}}function vi(n,o){var s=ee(n);if(arguments.length<2){var r=this.node();return s.local?r.getAttributeNS(s.space,s.local):r.getAttribute(s)}return this.each((o==null?s.local?li:si:typeof o=="function"?s.local?mi:hi:s.local?di:ci)(s,o))}function xr(n){return n.ownerDocument&&n.ownerDocument.defaultView||n.document&&n||n.defaultView}function gi(n){return function(){this.style.removeProperty(n)}}function pi(n,o,s){return function(){this.style.setProperty(n,o,s)}}function wi(n,o,s){return function(){var r=o.apply(this,arguments);r==null?this.style.removeProperty(n):this.style.setProperty(n,r,s)}}function yi(n,o,s){return arguments.length>1?this.each((o==null?gi:typeof o=="function"?wi:pi)(n,o,s??"")):mn(this.node(),n)}function mn(n,o){return n.style.getPropertyValue(o)||xr(n).getComputedStyle(n,null).getPropertyValue(o)}function bi(n){return function(){delete this[n]}}function _i(n,o){return function(){this[n]=o}}function xi(n,o){return function(){var s=o.apply(this,arguments);s==null?delete this[n]:this[n]=s}}function ki(n,o){return arguments.length>1?this.each((o==null?bi:typeof o=="function"?xi:_i)(n,o)):this.node()[n]}function kr(n){return n.trim().split(/^|\s+/)}function $e(n){return n.classList||new Er(n)}function Er(n){this._node=n,this._names=kr(n.getAttribute("class")||"")}Er.prototype={add:function(n){var o=this._names.indexOf(n);o<0&&(this._names.push(n),this._node.setAttribute("class",this._names.join(" ")))},remove:function(n){var o=this._names.indexOf(n);o>=0&&(this._names.splice(o,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(n){return this._names.indexOf(n)>=0}};function Ar(n,o){for(var s=$e(n),r=-1,i=o.length;++r<i;)s.add(o[r])}function Nr(n,o){for(var s=$e(n),r=-1,i=o.length;++r<i;)s.remove(o[r])}function Ei(n){return function(){Ar(this,n)}}function Ai(n){return function(){Nr(this,n)}}function Ni(n,o){return function(){(o.apply(this,arguments)?Ar:Nr)(this,n)}}function $i(n,o){var s=kr(n+"");if(arguments.length<2){for(var r=$e(this.node()),i=-1,c=s.length;++i<c;)if(!r.contains(s[i]))return!1;return!0}return this.each((typeof o=="function"?Ni:o?Ei:Ai)(s,o))}function qi(){this.textContent=""}function Ri(n){return function(){this.textContent=n}}function Ii(n){return function(){var o=n.apply(this,arguments);this.textContent=o??""}}function Pi(n){return arguments.length?this.each(n==null?qi:(typeof n=="function"?Ii:Ri)(n)):this.node().textContent}function Ti(){this.innerHTML=""}function zi(n){return function(){this.innerHTML=n}}function Ci(n){return function(){var o=n.apply(this,arguments);this.innerHTML=o??""}}function Fi(n){return arguments.length?this.each(n==null?Ti:(typeof n=="function"?Ci:zi)(n)):this.node().innerHTML}function Li(){this.nextSibling&&this.parentNode.appendChild(this)}function Oi(){return this.each(Li)}function Wi(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Hi(){return this.each(Wi)}function Gi(n){var o=typeof n=="function"?n:pr(n);return this.select(function(){return this.appendChild(o.apply(this,arguments))})}function Bi(){return null}function Vi(n,o){var s=typeof n=="function"?n:pr(n),r=o==null?Bi:typeof o=="function"?o:Ne(o);return this.select(function(){return this.insertBefore(s.apply(this,arguments),r.apply(this,arguments)||null)})}function Di(){var n=this.parentNode;n&&n.removeChild(this)}function Ui(){return this.each(Di)}function Qi(){var n=this.cloneNode(!1),o=this.parentNode;return o?o.insertBefore(n,this.nextSibling):n}function Yi(){var n=this.cloneNode(!0),o=this.parentNode;return o?o.insertBefore(n,this.nextSibling):n}function Ki(n){return this.select(n?Yi:Qi)}function Ji(n){return arguments.length?this.property("__data__",n):this.node().__data__}function Zi(n){return function(o){n.call(this,o,this.__data__)}}function Xi(n){return n.trim().split(/^|\s+/).map(function(o){var s="",r=o.indexOf(".");return r>=0&&(s=o.slice(r+1),o=o.slice(0,r)),{type:o,name:s}})}function Mi(n){return function(){var o=this.__on;if(o){for(var s=0,r=-1,i=o.length,c;s<i;++s)c=o[s],(!n.type||c.type===n.type)&&c.name===n.name?this.removeEventListener(c.type,c.listener,c.options):o[++r]=c;++r?o.length=r:delete this.__on}}}function Si(n,o,s){return function(){var r=this.__on,i,c=Zi(o);if(r){for(var l=0,h=r.length;l<h;++l)if((i=r[l]).type===n.type&&i.name===n.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=c,i.options=s),i.value=o;return}}this.addEventListener(n.type,c,s),i={type:n.type,name:n.name,value:o,listener:c,options:s},r?r.push(i):this.__on=[i]}}function ji(n,o,s){var r=Xi(n+""),i,c=r.length,l;if(arguments.length<2){var h=this.node().__on;if(h){for(var d=0,f=h.length,e;d<f;++d)for(i=0,e=h[d];i<c;++i)if((l=r[i]).type===e.type&&l.name===e.name)return e.value}return}for(h=o?Si:Mi,i=0;i<c;++i)this.each(h(r[i],o,s));return this}function $r(n,o,s){var r=xr(n),i=r.CustomEvent;typeof i=="function"?i=new i(o,s):(i=r.document.createEvent("Event"),s?(i.initEvent(o,s.bubbles,s.cancelable),i.detail=s.detail):i.initEvent(o,!1,!1)),n.dispatchEvent(i)}function no(n,o){return function(){return $r(this,n,o)}}function eo(n,o){return function(){return $r(this,n,o.apply(this,arguments))}}function ro(n,o){return this.each((typeof o=="function"?eo:no)(n,o))}function*to(){for(var n=this._groups,o=0,s=n.length;o<s;++o)for(var r=n[o],i=0,c=r.length,l;i<c;++i)(l=r[i])&&(yield l)}var qr=[null];function F(n,o){this._groups=n,this._parents=o}function In(){return new F([[document.documentElement]],qr)}function io(){return this}F.prototype=In.prototype={constructor:F,select:It,selectAll:Ct,selectChild:Wt,selectChildren:Vt,filter:Dt,data:Zt,enter:Ut,exit:Mt,join:St,merge:jt,selection:io,order:ni,sort:ei,call:ti,nodes:ii,node:oi,size:fi,empty:ui,each:ai,attr:vi,style:yi,property:ki,classed:$i,text:Pi,html:Fi,raise:Oi,lower:Hi,append:Gi,insert:Vi,remove:Ui,clone:Ki,datum:Ji,on:ji,dispatch:ro,[Symbol.iterator]:to};function re(n){return typeof n=="string"?new F([[document.querySelector(n)]],[document.documentElement]):new F([[n]],qr)}function qe(n,o,s){n.prototype=o.prototype=s,s.constructor=n}function Rr(n,o){var s=Object.create(n.prototype);for(var r in o)s[r]=o[r];return s}function Pn(){}var $n=.7,Qn=1/$n,ln="\\s*([+-]?\\d+)\\s*",qn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Q="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",oo=/^#([0-9a-f]{3,8})$/,fo=new RegExp(`^rgb\\(${ln},${ln},${ln}\\)$`),uo=new RegExp(`^rgb\\(${Q},${Q},${Q}\\)$`),ao=new RegExp(`^rgba\\(${ln},${ln},${ln},${qn}\\)$`),so=new RegExp(`^rgba\\(${Q},${Q},${Q},${qn}\\)$`),lo=new RegExp(`^hsl\\(${qn},${Q},${Q}\\)$`),co=new RegExp(`^hsla\\(${qn},${Q},${Q},${qn}\\)$`),Ve={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};qe(Pn,tn,{copy(n){return Object.assign(new this.constructor,this,n)},displayable(){return this.rgb().displayable()},hex:De,formatHex:De,formatHex8:ho,formatHsl:mo,formatRgb:Ue,toString:Ue});function De(){return this.rgb().formatHex()}function ho(){return this.rgb().formatHex8()}function mo(){return Ir(this).formatHsl()}function Ue(){return this.rgb().formatRgb()}function tn(n){var o,s;return n=(n+"").trim().toLowerCase(),(o=oo.exec(n))?(s=o[1].length,o=parseInt(o[1],16),s===6?Qe(o):s===3?new C(o>>8&15|o>>4&240,o>>4&15|o&240,(o&15)<<4|o&15,1):s===8?Tn(o>>24&255,o>>16&255,o>>8&255,(o&255)/255):s===4?Tn(o>>12&15|o>>8&240,o>>8&15|o>>4&240,o>>4&15|o&240,((o&15)<<4|o&15)/255):null):(o=fo.exec(n))?new C(o[1],o[2],o[3],1):(o=uo.exec(n))?new C(o[1]*255/100,o[2]*255/100,o[3]*255/100,1):(o=ao.exec(n))?Tn(o[1],o[2],o[3],o[4]):(o=so.exec(n))?Tn(o[1]*255/100,o[2]*255/100,o[3]*255/100,o[4]):(o=lo.exec(n))?Je(o[1],o[2]/100,o[3]/100,1):(o=co.exec(n))?Je(o[1],o[2]/100,o[3]/100,o[4]):Ve.hasOwnProperty(n)?Qe(Ve[n]):n==="transparent"?new C(NaN,NaN,NaN,0):null}function Qe(n){return new C(n>>16&255,n>>8&255,n&255,1)}function Tn(n,o,s,r){return r<=0&&(n=o=s=NaN),new C(n,o,s,r)}function vo(n){return n instanceof Pn||(n=tn(n)),n?(n=n.rgb(),new C(n.r,n.g,n.b,n.opacity)):new C}function ge(n,o,s,r){return arguments.length===1?vo(n):new C(n,o,s,r??1)}function C(n,o,s,r){this.r=+n,this.g=+o,this.b=+s,this.opacity=+r}qe(C,ge,Rr(Pn,{brighter(n){return n=n==null?Qn:Math.pow(Qn,n),new C(this.r*n,this.g*n,this.b*n,this.opacity)},darker(n){return n=n==null?$n:Math.pow($n,n),new C(this.r*n,this.g*n,this.b*n,this.opacity)},rgb(){return this},clamp(){return new C(rn(this.r),rn(this.g),rn(this.b),Yn(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ye,formatHex:Ye,formatHex8:go,formatRgb:Ke,toString:Ke}));function Ye(){return`#${en(this.r)}${en(this.g)}${en(this.b)}`}function go(){return`#${en(this.r)}${en(this.g)}${en(this.b)}${en((isNaN(this.opacity)?1:this.opacity)*255)}`}function Ke(){const n=Yn(this.opacity);return`${n===1?"rgb(":"rgba("}${rn(this.r)}, ${rn(this.g)}, ${rn(this.b)}${n===1?")":`, ${n})`}`}function Yn(n){return isNaN(n)?1:Math.max(0,Math.min(1,n))}function rn(n){return Math.max(0,Math.min(255,Math.round(n)||0))}function en(n){return n=rn(n),(n<16?"0":"")+n.toString(16)}function Je(n,o,s,r){return r<=0?n=o=s=NaN:s<=0||s>=1?n=o=NaN:o<=0&&(n=NaN),new G(n,o,s,r)}function Ir(n){if(n instanceof G)return new G(n.h,n.s,n.l,n.opacity);if(n instanceof Pn||(n=tn(n)),!n)return new G;if(n instanceof G)return n;n=n.rgb();var o=n.r/255,s=n.g/255,r=n.b/255,i=Math.min(o,s,r),c=Math.max(o,s,r),l=NaN,h=c-i,d=(c+i)/2;return h?(o===c?l=(s-r)/h+(s<r)*6:s===c?l=(r-o)/h+2:l=(o-s)/h+4,h/=d<.5?c+i:2-c-i,l*=60):h=d>0&&d<1?0:l,new G(l,h,d,n.opacity)}function po(n,o,s,r){return arguments.length===1?Ir(n):new G(n,o,s,r??1)}function G(n,o,s,r){this.h=+n,this.s=+o,this.l=+s,this.opacity=+r}qe(G,po,Rr(Pn,{brighter(n){return n=n==null?Qn:Math.pow(Qn,n),new G(this.h,this.s,this.l*n,this.opacity)},darker(n){return n=n==null?$n:Math.pow($n,n),new G(this.h,this.s,this.l*n,this.opacity)},rgb(){var n=this.h%360+(this.h<0)*360,o=isNaN(n)||isNaN(this.s)?0:this.s,s=this.l,r=s+(s<.5?s:1-s)*o,i=2*s-r;return new C(de(n>=240?n-240:n+120,i,r),de(n,i,r),de(n<120?n+240:n-120,i,r),this.opacity)},clamp(){return new G(Ze(this.h),zn(this.s),zn(this.l),Yn(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const n=Yn(this.opacity);return`${n===1?"hsl(":"hsla("}${Ze(this.h)}, ${zn(this.s)*100}%, ${zn(this.l)*100}%${n===1?")":`, ${n})`}`}}));function Ze(n){return n=(n||0)%360,n<0?n+360:n}function zn(n){return Math.max(0,Math.min(1,n||0))}function de(n,o,s){return(n<60?o+(s-o)*n/60:n<180?s:n<240?o+(s-o)*(240-n)/60:o)*255}const Re=n=>()=>n;function wo(n,o){return function(s){return n+s*o}}function yo(n,o,s){return n=Math.pow(n,s),o=Math.pow(o,s)-n,s=1/s,function(r){return Math.pow(n+r*o,s)}}function bo(n){return(n=+n)==1?Pr:function(o,s){return s-o?yo(o,s,n):Re(isNaN(o)?s:o)}}function Pr(n,o){var s=o-n;return s?wo(n,s):Re(isNaN(n)?o:n)}const Kn=function n(o){var s=bo(o);function r(i,c){var l=s((i=ge(i)).r,(c=ge(c)).r),h=s(i.g,c.g),d=s(i.b,c.b),f=Pr(i.opacity,c.opacity);return function(e){return i.r=l(e),i.g=h(e),i.b=d(e),i.opacity=f(e),i+""}}return r.gamma=n,r}(1);function _o(n,o){o||(o=[]);var s=n?Math.min(o.length,n.length):0,r=o.slice(),i;return function(c){for(i=0;i<s;++i)r[i]=n[i]*(1-c)+o[i]*c;return r}}function xo(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function ko(n,o){var s=o?o.length:0,r=n?Math.min(s,n.length):0,i=new Array(r),c=new Array(s),l;for(l=0;l<r;++l)i[l]=te(n[l],o[l]);for(;l<s;++l)c[l]=o[l];return function(h){for(l=0;l<r;++l)c[l]=i[l](h);return c}}function Eo(n,o){var s=new Date;return n=+n,o=+o,function(r){return s.setTime(n*(1-r)+o*r),s}}function H(n,o){return n=+n,o=+o,function(s){return n*(1-s)+o*s}}function Ao(n,o){var s={},r={},i;(n===null||typeof n!="object")&&(n={}),(o===null||typeof o!="object")&&(o={});for(i in o)i in n?s[i]=te(n[i],o[i]):r[i]=o[i];return function(c){for(i in s)r[i]=s[i](c);return r}}var pe=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,he=new RegExp(pe.source,"g");function No(n){return function(){return n}}function $o(n){return function(o){return n(o)+""}}function Tr(n,o){var s=pe.lastIndex=he.lastIndex=0,r,i,c,l=-1,h=[],d=[];for(n=n+"",o=o+"";(r=pe.exec(n))&&(i=he.exec(o));)(c=i.index)>s&&(c=o.slice(s,c),h[l]?h[l]+=c:h[++l]=c),(r=r[0])===(i=i[0])?h[l]?h[l]+=i:h[++l]=i:(h[++l]=null,d.push({i:l,x:H(r,i)})),s=he.lastIndex;return s<o.length&&(c=o.slice(s),h[l]?h[l]+=c:h[++l]=c),h.length<2?d[0]?$o(d[0].x):No(o):(o=d.length,function(f){for(var e=0,t;e<o;++e)h[(t=d[e]).i]=t.x(f);return h.join("")})}function te(n,o){var s=typeof o,r;return o==null||s==="boolean"?Re(o):(s==="number"?H:s==="string"?(r=tn(o))?(o=r,Kn):Tr:o instanceof tn?Kn:o instanceof Date?Eo:xo(o)?_o:Array.isArray(o)?ko:typeof o.valueOf!="function"&&typeof o.toString!="function"||isNaN(o)?Ao:H)(n,o)}function zr(n,o){return n=+n,o=+o,function(s){return Math.round(n*(1-s)+o*s)}}var Xe=180/Math.PI,we={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Cr(n,o,s,r,i,c){var l,h,d;return(l=Math.sqrt(n*n+o*o))&&(n/=l,o/=l),(d=n*s+o*r)&&(s-=n*d,r-=o*d),(h=Math.sqrt(s*s+r*r))&&(s/=h,r/=h,d/=h),n*r<o*s&&(n=-n,o=-o,d=-d,l=-l),{translateX:i,translateY:c,rotate:Math.atan2(o,n)*Xe,skewX:Math.atan(d)*Xe,scaleX:l,scaleY:h}}var Cn;function qo(n){const o=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(n+"");return o.isIdentity?we:Cr(o.a,o.b,o.c,o.d,o.e,o.f)}function Ro(n){return n==null||(Cn||(Cn=document.createElementNS("http://www.w3.org/2000/svg","g")),Cn.setAttribute("transform",n),!(n=Cn.transform.baseVal.consolidate()))?we:(n=n.matrix,Cr(n.a,n.b,n.c,n.d,n.e,n.f))}function Fr(n,o,s,r){function i(f){return f.length?f.pop()+" ":""}function c(f,e,t,u,a,m){if(f!==t||e!==u){var v=a.push("translate(",null,o,null,s);m.push({i:v-4,x:H(f,t)},{i:v-2,x:H(e,u)})}else(t||u)&&a.push("translate("+t+o+u+s)}function l(f,e,t,u){f!==e?(f-e>180?e+=360:e-f>180&&(f+=360),u.push({i:t.push(i(t)+"rotate(",null,r)-2,x:H(f,e)})):e&&t.push(i(t)+"rotate("+e+r)}function h(f,e,t,u){f!==e?u.push({i:t.push(i(t)+"skewX(",null,r)-2,x:H(f,e)}):e&&t.push(i(t)+"skewX("+e+r)}function d(f,e,t,u,a,m){if(f!==t||e!==u){var v=a.push(i(a)+"scale(",null,",",null,")");m.push({i:v-4,x:H(f,t)},{i:v-2,x:H(e,u)})}else(t!==1||u!==1)&&a.push(i(a)+"scale("+t+","+u+")")}return function(f,e){var t=[],u=[];return f=n(f),e=n(e),c(f.translateX,f.translateY,e.translateX,e.translateY,t,u),l(f.rotate,e.rotate,t,u),h(f.skewX,e.skewX,t,u),d(f.scaleX,f.scaleY,e.scaleX,e.scaleY,t,u),f=e=null,function(a){for(var m=-1,v=u.length,g;++m<v;)t[(g=u[m]).i]=g.x(a);return t.join("")}}}var Io=Fr(qo,"px, ","px)","deg)"),Po=Fr(Ro,", ",")",")"),vn=0,kn=0,bn=0,Lr=1e3,Jn,En,Zn=0,on=0,ie=0,Rn=typeof performance=="object"&&performance.now?performance:Date,Or=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(n){setTimeout(n,17)};function Ie(){return on||(Or(To),on=Rn.now()+ie)}function To(){on=0}function Xn(){this._call=this._time=this._next=null}Xn.prototype=Wr.prototype={constructor:Xn,restart:function(n,o,s){if(typeof n!="function")throw new TypeError("callback is not a function");s=(s==null?Ie():+s)+(o==null?0:+o),!this._next&&En!==this&&(En?En._next=this:Jn=this,En=this),this._call=n,this._time=s,ye()},stop:function(){this._call&&(this._call=null,this._time=1/0,ye())}};function Wr(n,o,s){var r=new Xn;return r.restart(n,o,s),r}function zo(){Ie(),++vn;for(var n=Jn,o;n;)(o=on-n._time)>=0&&n._call.call(void 0,o),n=n._next;--vn}function Me(){on=(Zn=Rn.now())+ie,vn=kn=0;try{zo()}finally{vn=0,Fo(),on=0}}function Co(){var n=Rn.now(),o=n-Zn;o>Lr&&(ie-=o,Zn=n)}function Fo(){for(var n,o=Jn,s,r=1/0;o;)o._call?(r>o._time&&(r=o._time),n=o,o=o._next):(s=o._next,o._next=null,o=n?n._next=s:Jn=s);En=n,ye(r)}function ye(n){if(!vn){kn&&(kn=clearTimeout(kn));var o=n-on;o>24?(n<1/0&&(kn=setTimeout(Me,n-Rn.now()-ie)),bn&&(bn=clearInterval(bn))):(bn||(Zn=Rn.now(),bn=setInterval(Co,Lr)),vn=1,Or(Me))}}function Se(n,o,s){var r=new Xn;return o=o==null?0:+o,r.restart(i=>{r.stop(),n(i+o)},o,s),r}var Lo=gr("start","end","cancel","interrupt"),Oo=[],Hr=0,je=1,be=2,Hn=3,nr=4,_e=5,Gn=6;function oe(n,o,s,r,i,c){var l=n.__transition;if(!l)n.__transition={};else if(s in l)return;Wo(n,s,{name:o,index:r,group:i,on:Lo,tween:Oo,time:c.time,delay:c.delay,duration:c.duration,ease:c.ease,timer:null,state:Hr})}function Pe(n,o){var s=B(n,o);if(s.state>Hr)throw new Error("too late; already scheduled");return s}function Y(n,o){var s=B(n,o);if(s.state>Hn)throw new Error("too late; already running");return s}function B(n,o){var s=n.__transition;if(!s||!(s=s[o]))throw new Error("transition not found");return s}function Wo(n,o,s){var r=n.__transition,i;r[o]=s,s.timer=Wr(c,0,s.time);function c(f){s.state=je,s.timer.restart(l,s.delay,s.time),s.delay<=f&&l(f-s.delay)}function l(f){var e,t,u,a;if(s.state!==je)return d();for(e in r)if(a=r[e],a.name===s.name){if(a.state===Hn)return Se(l);a.state===nr?(a.state=Gn,a.timer.stop(),a.on.call("interrupt",n,n.__data__,a.index,a.group),delete r[e]):+e<o&&(a.state=Gn,a.timer.stop(),a.on.call("cancel",n,n.__data__,a.index,a.group),delete r[e])}if(Se(function(){s.state===Hn&&(s.state=nr,s.timer.restart(h,s.delay,s.time),h(f))}),s.state=be,s.on.call("start",n,n.__data__,s.index,s.group),s.state===be){for(s.state=Hn,i=new Array(u=s.tween.length),e=0,t=-1;e<u;++e)(a=s.tween[e].value.call(n,n.__data__,s.index,s.group))&&(i[++t]=a);i.length=t+1}}function h(f){for(var e=f<s.duration?s.ease.call(null,f/s.duration):(s.timer.restart(d),s.state=_e,1),t=-1,u=i.length;++t<u;)i[t].call(n,e);s.state===_e&&(s.on.call("end",n,n.__data__,s.index,s.group),d())}function d(){s.state=Gn,s.timer.stop(),delete r[o];for(var f in r)return;delete n.__transition}}function Ho(n,o){var s=n.__transition,r,i,c=!0,l;if(s){o=o==null?null:o+"";for(l in s){if((r=s[l]).name!==o){c=!1;continue}i=r.state>be&&r.state<_e,r.state=Gn,r.timer.stop(),r.on.call(i?"interrupt":"cancel",n,n.__data__,r.index,r.group),delete s[l]}c&&delete n.__transition}}function Go(n){return this.each(function(){Ho(this,n)})}function Bo(n,o){var s,r;return function(){var i=Y(this,n),c=i.tween;if(c!==s){r=s=c;for(var l=0,h=r.length;l<h;++l)if(r[l].name===o){r=r.slice(),r.splice(l,1);break}}i.tween=r}}function Vo(n,o,s){var r,i;if(typeof s!="function")throw new Error;return function(){var c=Y(this,n),l=c.tween;if(l!==r){i=(r=l).slice();for(var h={name:o,value:s},d=0,f=i.length;d<f;++d)if(i[d].name===o){i[d]=h;break}d===f&&i.push(h)}c.tween=i}}function Do(n,o){var s=this._id;if(n+="",arguments.length<2){for(var r=B(this.node(),s).tween,i=0,c=r.length,l;i<c;++i)if((l=r[i]).name===n)return l.value;return null}return this.each((o==null?Bo:Vo)(s,n,o))}function Te(n,o,s){var r=n._id;return n.each(function(){var i=Y(this,r);(i.value||(i.value={}))[o]=s.apply(this,arguments)}),function(i){return B(i,r).value[o]}}function Gr(n,o){var s;return(typeof o=="number"?H:o instanceof tn?Kn:(s=tn(o))?(o=s,Kn):Tr)(n,o)}function Uo(n){return function(){this.removeAttribute(n)}}function Qo(n){return function(){this.removeAttributeNS(n.space,n.local)}}function Yo(n,o,s){var r,i=s+"",c;return function(){var l=this.getAttribute(n);return l===i?null:l===r?c:c=o(r=l,s)}}function Ko(n,o,s){var r,i=s+"",c;return function(){var l=this.getAttributeNS(n.space,n.local);return l===i?null:l===r?c:c=o(r=l,s)}}function Jo(n,o,s){var r,i,c;return function(){var l,h=s(this),d;return h==null?void this.removeAttribute(n):(l=this.getAttribute(n),d=h+"",l===d?null:l===r&&d===i?c:(i=d,c=o(r=l,h)))}}function Zo(n,o,s){var r,i,c;return function(){var l,h=s(this),d;return h==null?void this.removeAttributeNS(n.space,n.local):(l=this.getAttributeNS(n.space,n.local),d=h+"",l===d?null:l===r&&d===i?c:(i=d,c=o(r=l,h)))}}function Xo(n,o){var s=ee(n),r=s==="transform"?Po:Gr;return this.attrTween(n,typeof o=="function"?(s.local?Zo:Jo)(s,r,Te(this,"attr."+n,o)):o==null?(s.local?Qo:Uo)(s):(s.local?Ko:Yo)(s,r,o))}function Mo(n,o){return function(s){this.setAttribute(n,o.call(this,s))}}function So(n,o){return function(s){this.setAttributeNS(n.space,n.local,o.call(this,s))}}function jo(n,o){var s,r;function i(){var c=o.apply(this,arguments);return c!==r&&(s=(r=c)&&So(n,c)),s}return i._value=o,i}function nf(n,o){var s,r;function i(){var c=o.apply(this,arguments);return c!==r&&(s=(r=c)&&Mo(n,c)),s}return i._value=o,i}function ef(n,o){var s="attr."+n;if(arguments.length<2)return(s=this.tween(s))&&s._value;if(o==null)return this.tween(s,null);if(typeof o!="function")throw new Error;var r=ee(n);return this.tween(s,(r.local?jo:nf)(r,o))}function rf(n,o){return function(){Pe(this,n).delay=+o.apply(this,arguments)}}function tf(n,o){return o=+o,function(){Pe(this,n).delay=o}}function of(n){var o=this._id;return arguments.length?this.each((typeof n=="function"?rf:tf)(o,n)):B(this.node(),o).delay}function ff(n,o){return function(){Y(this,n).duration=+o.apply(this,arguments)}}function uf(n,o){return o=+o,function(){Y(this,n).duration=o}}function af(n){var o=this._id;return arguments.length?this.each((typeof n=="function"?ff:uf)(o,n)):B(this.node(),o).duration}function sf(n,o){if(typeof o!="function")throw new Error;return function(){Y(this,n).ease=o}}function lf(n){var o=this._id;return arguments.length?this.each(sf(o,n)):B(this.node(),o).ease}function cf(n,o){return function(){var s=o.apply(this,arguments);if(typeof s!="function")throw new Error;Y(this,n).ease=s}}function df(n){if(typeof n!="function")throw new Error;return this.each(cf(this._id,n))}function hf(n){typeof n!="function"&&(n=yr(n));for(var o=this._groups,s=o.length,r=new Array(s),i=0;i<s;++i)for(var c=o[i],l=c.length,h=r[i]=[],d,f=0;f<l;++f)(d=c[f])&&n.call(d,d.__data__,f,c)&&h.push(d);return new Z(r,this._parents,this._name,this._id)}function mf(n){if(n._id!==this._id)throw new Error;for(var o=this._groups,s=n._groups,r=o.length,i=s.length,c=Math.min(r,i),l=new Array(r),h=0;h<c;++h)for(var d=o[h],f=s[h],e=d.length,t=l[h]=new Array(e),u,a=0;a<e;++a)(u=d[a]||f[a])&&(t[a]=u);for(;h<r;++h)l[h]=o[h];return new Z(l,this._parents,this._name,this._id)}function vf(n){return(n+"").trim().split(/^|\s+/).every(function(o){var s=o.indexOf(".");return s>=0&&(o=o.slice(0,s)),!o||o==="start"})}function gf(n,o,s){var r,i,c=vf(o)?Pe:Y;return function(){var l=c(this,n),h=l.on;h!==r&&(i=(r=h).copy()).on(o,s),l.on=i}}function pf(n,o){var s=this._id;return arguments.length<2?B(this.node(),s).on.on(n):this.each(gf(s,n,o))}function wf(n){return function(){var o=this.parentNode;for(var s in this.__transition)if(+s!==n)return;o&&o.removeChild(this)}}function yf(){return this.on("end.remove",wf(this._id))}function bf(n){var o=this._name,s=this._id;typeof n!="function"&&(n=Ne(n));for(var r=this._groups,i=r.length,c=new Array(i),l=0;l<i;++l)for(var h=r[l],d=h.length,f=c[l]=new Array(d),e,t,u=0;u<d;++u)(e=h[u])&&(t=n.call(e,e.__data__,u,h))&&("__data__"in e&&(t.__data__=e.__data__),f[u]=t,oe(f[u],o,s,u,f,B(e,s)));return new Z(c,this._parents,o,s)}function _f(n){var o=this._name,s=this._id;typeof n!="function"&&(n=wr(n));for(var r=this._groups,i=r.length,c=[],l=[],h=0;h<i;++h)for(var d=r[h],f=d.length,e,t=0;t<f;++t)if(e=d[t]){for(var u=n.call(e,e.__data__,t,d),a,m=B(e,s),v=0,g=u.length;v<g;++v)(a=u[v])&&oe(a,o,s,v,u,m);c.push(u),l.push(e)}return new Z(c,l,o,s)}var xf=In.prototype.constructor;function kf(){return new xf(this._groups,this._parents)}function Ef(n,o){var s,r,i;return function(){var c=mn(this,n),l=(this.style.removeProperty(n),mn(this,n));return c===l?null:c===s&&l===r?i:i=o(s=c,r=l)}}function Br(n){return function(){this.style.removeProperty(n)}}function Af(n,o,s){var r,i=s+"",c;return function(){var l=mn(this,n);return l===i?null:l===r?c:c=o(r=l,s)}}function Nf(n,o,s){var r,i,c;return function(){var l=mn(this,n),h=s(this),d=h+"";return h==null&&(d=h=(this.style.removeProperty(n),mn(this,n))),l===d?null:l===r&&d===i?c:(i=d,c=o(r=l,h))}}function $f(n,o){var s,r,i,c="style."+o,l="end."+c,h;return function(){var d=Y(this,n),f=d.on,e=d.value[c]==null?h||(h=Br(o)):void 0;(f!==s||i!==e)&&(r=(s=f).copy()).on(l,i=e),d.on=r}}function qf(n,o,s){var r=(n+="")=="transform"?Io:Gr;return o==null?this.styleTween(n,Ef(n,r)).on("end.style."+n,Br(n)):typeof o=="function"?this.styleTween(n,Nf(n,r,Te(this,"style."+n,o))).each($f(this._id,n)):this.styleTween(n,Af(n,r,o),s).on("end.style."+n,null)}function Rf(n,o,s){return function(r){this.style.setProperty(n,o.call(this,r),s)}}function If(n,o,s){var r,i;function c(){var l=o.apply(this,arguments);return l!==i&&(r=(i=l)&&Rf(n,l,s)),r}return c._value=o,c}function Pf(n,o,s){var r="style."+(n+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(o==null)return this.tween(r,null);if(typeof o!="function")throw new Error;return this.tween(r,If(n,o,s??""))}function Tf(n){return function(){this.textContent=n}}function zf(n){return function(){var o=n(this);this.textContent=o??""}}function Cf(n){return this.tween("text",typeof n=="function"?zf(Te(this,"text",n)):Tf(n==null?"":n+""))}function Ff(n){return function(o){this.textContent=n.call(this,o)}}function Lf(n){var o,s;function r(){var i=n.apply(this,arguments);return i!==s&&(o=(s=i)&&Ff(i)),o}return r._value=n,r}function Of(n){var o="text";if(arguments.length<1)return(o=this.tween(o))&&o._value;if(n==null)return this.tween(o,null);if(typeof n!="function")throw new Error;return this.tween(o,Lf(n))}function Wf(){for(var n=this._name,o=this._id,s=Vr(),r=this._groups,i=r.length,c=0;c<i;++c)for(var l=r[c],h=l.length,d,f=0;f<h;++f)if(d=l[f]){var e=B(d,o);oe(d,n,s,f,l,{time:e.time+e.delay+e.duration,delay:0,duration:e.duration,ease:e.ease})}return new Z(r,this._parents,n,s)}function Hf(){var n,o,s=this,r=s._id,i=s.size();return new Promise(function(c,l){var h={value:l},d={value:function(){--i===0&&c()}};s.each(function(){var f=Y(this,r),e=f.on;e!==n&&(o=(n=e).copy(),o._.cancel.push(h),o._.interrupt.push(h),o._.end.push(d)),f.on=o}),i===0&&c()})}var Gf=0;function Z(n,o,s,r){this._groups=n,this._parents=o,this._name=s,this._id=r}function Vr(){return++Gf}var K=In.prototype;Z.prototype={constructor:Z,select:bf,selectAll:_f,selectChild:K.selectChild,selectChildren:K.selectChildren,filter:hf,merge:mf,selection:kf,transition:Wf,call:K.call,nodes:K.nodes,node:K.node,size:K.size,empty:K.empty,each:K.each,on:pf,attr:Xo,attrTween:ef,style:qf,styleTween:Pf,text:Cf,textTween:Of,remove:yf,tween:Do,delay:of,duration:af,ease:lf,easeVarying:df,end:Hf,[Symbol.iterator]:K[Symbol.iterator]};function Bf(n){return((n*=2)<=1?n*n*n:(n-=2)*n*n+2)/2}var Vf={time:null,delay:0,duration:250,ease:Bf};function Df(n,o){for(var s;!(s=n.__transition)||!(s=s[o]);)if(!(n=n.parentNode))throw new Error(`transition ${o} not found`);return s}function Uf(n){var o,s;n instanceof Z?(o=n._id,n=n._name):(o=Vr(),(s=Vf).time=Ie(),n=n==null?null:n+"");for(var r=this._groups,i=r.length,c=0;c<i;++c)for(var l=r[c],h=l.length,d,f=0;f<h;++f)(d=l[f])&&oe(d,n,o,f,l,s||Df(d,o));return new Z(r,this._parents,n,o)}In.prototype.interrupt=Go;In.prototype.transition=Uf;const xe=Math.PI,ke=2*xe,nn=1e-6,Qf=ke-nn;function Dr(n){this._+=n[0];for(let o=1,s=n.length;o<s;++o)this._+=arguments[o]+n[o]}function Yf(n){let o=Math.floor(n);if(!(o>=0))throw new Error(`invalid digits: ${n}`);if(o>15)return Dr;const s=10**o;return function(r){this._+=r[0];for(let i=1,c=r.length;i<c;++i)this._+=Math.round(arguments[i]*s)/s+r[i]}}class Kf{constructor(o){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=o==null?Dr:Yf(o)}moveTo(o,s){this._append`M${this._x0=this._x1=+o},${this._y0=this._y1=+s}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(o,s){this._append`L${this._x1=+o},${this._y1=+s}`}quadraticCurveTo(o,s,r,i){this._append`Q${+o},${+s},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(o,s,r,i,c,l){this._append`C${+o},${+s},${+r},${+i},${this._x1=+c},${this._y1=+l}`}arcTo(o,s,r,i,c){if(o=+o,s=+s,r=+r,i=+i,c=+c,c<0)throw new Error(`negative radius: ${c}`);let l=this._x1,h=this._y1,d=r-o,f=i-s,e=l-o,t=h-s,u=e*e+t*t;if(this._x1===null)this._append`M${this._x1=o},${this._y1=s}`;else if(u>nn)if(!(Math.abs(t*d-f*e)>nn)||!c)this._append`L${this._x1=o},${this._y1=s}`;else{let a=r-l,m=i-h,v=d*d+f*f,g=a*a+m*m,w=Math.sqrt(v),y=Math.sqrt(u),p=c*Math.tan((xe-Math.acos((v+u-g)/(2*w*y)))/2),b=p/y,_=p/w;Math.abs(b-1)>nn&&this._append`L${o+b*e},${s+b*t}`,this._append`A${c},${c},0,0,${+(t*a>e*m)},${this._x1=o+_*d},${this._y1=s+_*f}`}}arc(o,s,r,i,c,l){if(o=+o,s=+s,r=+r,l=!!l,r<0)throw new Error(`negative radius: ${r}`);let h=r*Math.cos(i),d=r*Math.sin(i),f=o+h,e=s+d,t=1^l,u=l?i-c:c-i;this._x1===null?this._append`M${f},${e}`:(Math.abs(this._x1-f)>nn||Math.abs(this._y1-e)>nn)&&this._append`L${f},${e}`,r&&(u<0&&(u=u%ke+ke),u>Qf?this._append`A${r},${r},0,1,${t},${o-h},${s-d}A${r},${r},0,1,${t},${this._x1=f},${this._y1=e}`:u>nn&&this._append`A${r},${r},0,${+(u>=xe)},${t},${this._x1=o+r*Math.cos(c)},${this._y1=s+r*Math.sin(c)}`)}rect(o,s,r,i){this._append`M${this._x0=this._x1=+o},${this._y0=this._y1=+s}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}}function Jf(n){return Math.abs(n=Math.round(n))>=1e21?n.toLocaleString("en").replace(/,/g,""):n.toString(10)}function Mn(n,o){if((s=(n=o?n.toExponential(o-1):n.toExponential()).indexOf("e"))<0)return null;var s,r=n.slice(0,s);return[r.length>1?r[0]+r.slice(2):r,+n.slice(s+1)]}function gn(n){return n=Mn(Math.abs(n)),n?n[1]:NaN}function Zf(n,o){return function(s,r){for(var i=s.length,c=[],l=0,h=n[0],d=0;i>0&&h>0&&(d+h+1>r&&(h=Math.max(1,r-d)),c.push(s.substring(i-=h,i+h)),!((d+=h+1)>r));)h=n[l=(l+1)%n.length];return c.reverse().join(o)}}function Xf(n){return function(o){return o.replace(/[0-9]/g,function(s){return n[+s]})}}var Mf=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Sn(n){if(!(o=Mf.exec(n)))throw new Error("invalid format: "+n);var o;return new ze({fill:o[1],align:o[2],sign:o[3],symbol:o[4],zero:o[5],width:o[6],comma:o[7],precision:o[8]&&o[8].slice(1),trim:o[9],type:o[10]})}Sn.prototype=ze.prototype;function ze(n){this.fill=n.fill===void 0?" ":n.fill+"",this.align=n.align===void 0?">":n.align+"",this.sign=n.sign===void 0?"-":n.sign+"",this.symbol=n.symbol===void 0?"":n.symbol+"",this.zero=!!n.zero,this.width=n.width===void 0?void 0:+n.width,this.comma=!!n.comma,this.precision=n.precision===void 0?void 0:+n.precision,this.trim=!!n.trim,this.type=n.type===void 0?"":n.type+""}ze.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Sf(n){n:for(var o=n.length,s=1,r=-1,i;s<o;++s)switch(n[s]){case".":r=i=s;break;case"0":r===0&&(r=s),i=s;break;default:if(!+n[s])break n;r>0&&(r=0);break}return r>0?n.slice(0,r)+n.slice(i+1):n}var Ur;function jf(n,o){var s=Mn(n,o);if(!s)return n+"";var r=s[0],i=s[1],c=i-(Ur=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,l=r.length;return c===l?r:c>l?r+new Array(c-l+1).join("0"):c>0?r.slice(0,c)+"."+r.slice(c):"0."+new Array(1-c).join("0")+Mn(n,Math.max(0,o+c-1))[0]}function er(n,o){var s=Mn(n,o);if(!s)return n+"";var r=s[0],i=s[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const rr={"%":(n,o)=>(n*100).toFixed(o),b:n=>Math.round(n).toString(2),c:n=>n+"",d:Jf,e:(n,o)=>n.toExponential(o),f:(n,o)=>n.toFixed(o),g:(n,o)=>n.toPrecision(o),o:n=>Math.round(n).toString(8),p:(n,o)=>er(n*100,o),r:er,s:jf,X:n=>Math.round(n).toString(16).toUpperCase(),x:n=>Math.round(n).toString(16)};function tr(n){return n}var ir=Array.prototype.map,or=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function nu(n){var o=n.grouping===void 0||n.thousands===void 0?tr:Zf(ir.call(n.grouping,Number),n.thousands+""),s=n.currency===void 0?"":n.currency[0]+"",r=n.currency===void 0?"":n.currency[1]+"",i=n.decimal===void 0?".":n.decimal+"",c=n.numerals===void 0?tr:Xf(ir.call(n.numerals,String)),l=n.percent===void 0?"%":n.percent+"",h=n.minus===void 0?"−":n.minus+"",d=n.nan===void 0?"NaN":n.nan+"";function f(t){t=Sn(t);var u=t.fill,a=t.align,m=t.sign,v=t.symbol,g=t.zero,w=t.width,y=t.comma,p=t.precision,b=t.trim,_=t.type;_==="n"?(y=!0,_="g"):rr[_]||(p===void 0&&(p=12),b=!0,_="g"),(g||u==="0"&&a==="=")&&(g=!0,u="0",a="=");var x=v==="$"?s:v==="#"&&/[boxX]/.test(_)?"0"+_.toLowerCase():"",k=v==="$"?r:/[%p]/.test(_)?l:"",E=rr[_],N=/[defgprs%]/.test(_);p=p===void 0?6:/[gprs]/.test(_)?Math.max(1,Math.min(21,p)):Math.max(0,Math.min(20,p));function $(A){var q=x,R=k,I,V,W;if(_==="c")R=E(A)+R,A="";else{A=+A;var P=A<0||1/A<0;if(A=isNaN(A)?d:E(Math.abs(A),p),b&&(A=Sf(A)),P&&+A==0&&m!=="+"&&(P=!1),q=(P?m==="("?m:h:m==="-"||m==="("?"":m)+q,R=(_==="s"?or[8+Ur/3]:"")+R+(P&&m==="("?")":""),N){for(I=-1,V=A.length;++I<V;)if(W=A.charCodeAt(I),48>W||W>57){R=(W===46?i+A.slice(I+1):A.slice(I))+R,A=A.slice(0,I);break}}}y&&!g&&(A=o(A,1/0));var L=q.length+A.length+R.length,T=L<w?new Array(w-L+1).join(u):"";switch(y&&g&&(A=o(T+A,T.length?w-R.length:1/0),T=""),a){case"<":A=q+A+R+T;break;case"=":A=q+T+A+R;break;case"^":A=T.slice(0,L=T.length>>1)+q+A+R+T.slice(L);break;default:A=T+q+A+R;break}return c(A)}return $.toString=function(){return t+""},$}function e(t,u){var a=f((t=Sn(t),t.type="f",t)),m=Math.max(-8,Math.min(8,Math.floor(gn(u)/3)))*3,v=Math.pow(10,-m),g=or[8+m/3];return function(w){return a(v*w)+g}}return{format:f,formatPrefix:e}}var Fn,Ce,Qr;eu({thousands:",",grouping:[3],currency:["$",""]});function eu(n){return Fn=nu(n),Ce=Fn.format,Qr=Fn.formatPrefix,Fn}function ru(n){return Math.max(0,-gn(Math.abs(n)))}function tu(n,o){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(gn(o)/3)))*3-gn(Math.abs(n)))}function iu(n,o){return n=Math.abs(n),o=Math.abs(o)-n,Math.max(0,gn(o)-gn(n))+1}function ou(n,o){switch(arguments.length){case 0:break;case 1:this.range(n);break;default:this.range(o).domain(n);break}return this}function fu(n,o){switch(arguments.length){case 0:break;case 1:{typeof n=="function"?this.interpolator(n):this.range(n);break}default:{this.domain(n),typeof o=="function"?this.interpolator(o):this.range(o);break}}return this}function uu(n){return function(){return n}}function au(n){return+n}var fr=[0,1];function S(n){return n}function Ee(n,o){return(o-=n=+n)?function(s){return(s-n)/o}:uu(isNaN(o)?NaN:.5)}function su(n,o){var s;return n>o&&(s=n,n=o,o=s),function(r){return Math.max(n,Math.min(o,r))}}function lu(n,o,s){var r=n[0],i=n[1],c=o[0],l=o[1];return i<r?(r=Ee(i,r),c=s(l,c)):(r=Ee(r,i),c=s(c,l)),function(h){return c(r(h))}}function cu(n,o,s){var r=Math.min(n.length,o.length)-1,i=new Array(r),c=new Array(r),l=-1;for(n[r]<n[0]&&(n=n.slice().reverse(),o=o.slice().reverse());++l<r;)i[l]=Ee(n[l],n[l+1]),c[l]=s(o[l],o[l+1]);return function(h){var d=hr(n,h,1,r)-1;return c[d](i[d](h))}}function du(n,o){return o.domain(n.domain()).range(n.range()).interpolate(n.interpolate()).clamp(n.clamp()).unknown(n.unknown())}function hu(){var n=fr,o=fr,s=te,r,i,c,l=S,h,d,f;function e(){var u=Math.min(n.length,o.length);return l!==S&&(l=su(n[0],n[u-1])),h=u>2?cu:lu,d=f=null,t}function t(u){return u==null||isNaN(u=+u)?c:(d||(d=h(n.map(r),o,s)))(r(l(u)))}return t.invert=function(u){return l(i((f||(f=h(o,n.map(r),H)))(u)))},t.domain=function(u){return arguments.length?(n=Array.from(u,au),e()):n.slice()},t.range=function(u){return arguments.length?(o=Array.from(u),e()):o.slice()},t.rangeRound=function(u){return o=Array.from(u),s=zr,e()},t.clamp=function(u){return arguments.length?(l=u?!0:S,e()):l!==S},t.interpolate=function(u){return arguments.length?(s=u,e()):s},t.unknown=function(u){return arguments.length?(c=u,t):c},function(u,a){return r=u,i=a,e()}}function mu(){return hu()(S,S)}function vu(n,o,s,r){var i=ct(n,o,s),c;switch(r=Sn(r??",f"),r.type){case"s":{var l=Math.max(Math.abs(n),Math.abs(o));return r.precision==null&&!isNaN(c=tu(i,l))&&(r.precision=c),Qr(r,l)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(c=iu(i,Math.max(Math.abs(n),Math.abs(o))))&&(r.precision=c-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(c=ru(i))&&(r.precision=c-(r.type==="%")*2);break}}return Ce(r)}function Yr(n){var o=n.domain;return n.ticks=function(s){var r=o();return mr(r[0],r[r.length-1],s??10)},n.tickFormat=function(s,r){var i=o();return vu(i[0],i[i.length-1],s??10,r)},n.nice=function(s){s==null&&(s=10);var r=o(),i=0,c=r.length-1,l=r[i],h=r[c],d,f,e=10;for(h<l&&(f=l,l=h,h=f,f=i,i=c,c=f);e-- >0;){if(f=hn(l,h,s),f===d)return r[i]=l,r[c]=h,o(r);if(f>0)l=Math.floor(l/f)*f,h=Math.ceil(h/f)*f;else if(f<0)l=Math.ceil(l*f)/f,h=Math.floor(h*f)/f;else break;d=f}return n},n}function fn(){var n=mu();return n.copy=function(){return du(n,fn())},ou.apply(n,arguments),Yr(n)}function gu(){var n=0,o=1,s,r,i,c,l=S,h=!1,d;function f(t){return t==null||isNaN(t=+t)?d:l(i===0?.5:(t=(c(t)-s)*i,h?Math.max(0,Math.min(1,t)):t))}f.domain=function(t){return arguments.length?([n,o]=t,s=c(n=+n),r=c(o=+o),i=s===r?0:1/(r-s),f):[n,o]},f.clamp=function(t){return arguments.length?(h=!!t,f):h},f.interpolator=function(t){return arguments.length?(l=t,f):l};function e(t){return function(u){var a,m;return arguments.length?([a,m]=u,l=t(a,m),f):[l(0),l(1)]}}return f.range=e(te),f.rangeRound=e(zr),f.unknown=function(t){return arguments.length?(d=t,f):d},function(t){return c=t,s=t(n),r=t(o),i=s===r?0:1/(r-s),f}}function pu(n,o){return o.domain(n.domain()).interpolator(n.interpolator()).clamp(n.clamp()).unknown(n.unknown())}function sn(){var n=Yr(gu()(S));return n.copy=function(){return pu(n,sn())},fu.apply(n,arguments)}function fe(n){for(var o=n.length/6|0,s=new Array(o),r=0;r<o;)s[r]="#"+n.slice(r*6,++r*6);return s}function wu(n){return n=Math.max(0,Math.min(1,n)),"rgb("+Math.max(0,Math.min(255,Math.round(-4.54-n*(35.34-n*(2381.73-n*(6402.7-n*(7024.72-n*2710.57)))))))+", "+Math.max(0,Math.min(255,Math.round(32.49+n*(170.73+n*(52.82-n*(131.46-n*(176.58-n*67.37)))))))+", "+Math.max(0,Math.min(255,Math.round(81.24+n*(442.36-n*(2482.43-n*(6167.24-n*(6614.94-n*2475.67)))))))+")"}function ue(n){var o=n.length;return function(s){return n[Math.max(0,Math.min(o-1,Math.floor(s*o)))]}}const yu=ue(fe("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725"));var bu=ue(fe("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),_u=ue(fe("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),xu=ue(fe("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));function an(n){return function(){return n}}function ku(n){let o=3;return n.digits=function(s){if(!arguments.length)return o;if(s==null)o=null;else{const r=Math.floor(s);if(!(r>=0))throw new RangeError(`invalid digits: ${s}`);o=r}return n},()=>new Kf(o)}function Eu(n){return typeof n=="object"&&"length"in n?n:Array.from(n)}function Kr(n){this._context=n}Kr.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(n,o){switch(n=+n,o=+o,this._point){case 0:this._point=1,this._line?this._context.lineTo(n,o):this._context.moveTo(n,o);break;case 1:this._point=2;default:this._context.lineTo(n,o);break}}};function Au(n){return new Kr(n)}function Nu(n){return n[0]}function $u(n){return n[1]}function Jr(n,o){var s=an(!0),r=null,i=Au,c=null,l=ku(h);n=typeof n=="function"?n:n===void 0?Nu:an(n),o=typeof o=="function"?o:o===void 0?$u:an(o);function h(d){var f,e=(d=Eu(d)).length,t,u=!1,a;for(r==null&&(c=i(a=l())),f=0;f<=e;++f)!(f<e&&s(t=d[f],f,d))===u&&((u=!u)?c.lineStart():c.lineEnd()),u&&c.point(+n(t,f,d),+o(t,f,d));if(a)return c=null,a+""||null}return h.x=function(d){return arguments.length?(n=typeof d=="function"?d:an(+d),h):n},h.y=function(d){return arguments.length?(o=typeof d=="function"?d:an(+d),h):o},h.defined=function(d){return arguments.length?(s=typeof d=="function"?d:an(!!d),h):s},h.curve=function(d){return arguments.length?(i=d,r!=null&&(c=i(r)),h):i},h.context=function(d){return arguments.length?(d==null?r=c=null:c=i(r=d),h):r},h}function An(n,o,s){this.k=n,this.x=o,this.y=s}An.prototype={constructor:An,scale:function(n){return n===1?this:new An(this.k*n,this.x,this.y)},translate:function(n,o){return n===0&o===0?this:new An(this.k,this.x+this.k*n,this.y+this.k*o)},apply:function(n){return[n[0]*this.k+this.x,n[1]*this.k+this.y]},applyX:function(n){return n*this.k+this.x},applyY:function(n){return n*this.k+this.y},invert:function(n){return[(n[0]-this.x)/this.k,(n[1]-this.y)/this.k]},invertX:function(n){return(n-this.x)/this.k},invertY:function(n){return(n-this.y)/this.k},rescaleX:function(n){return n.copy().domain(n.range().map(this.invertX,this).map(n.invert,n))},rescaleY:function(n){return n.copy().domain(n.range().map(this.invertY,this).map(n.invert,n))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};An.prototype;var Ln={};/**
 * k-d Tree JavaScript - V 1.01
 *
 * https://github.com/ubilabs/kd-tree-javascript
 *
 * @author Mircea Pricop <pricop@ubilabs.net>, 2012
 * @author Martin Kleppe <kleppe@ubilabs.net>, 2012
 * @author Ubilabs http://ubilabs.net, 2012
 * @license MIT License <http://www.opensource.org/licenses/mit-license.php>
 */var ur;function qu(){return ur||(ur=1,function(n){(function(o,s){s(n)})(Ln,function(o){function s(i,c,l){this.obj=i,this.left=null,this.right=null,this.parent=l,this.dimension=c}function r(i){this.content=[],this.scoreFunction=i}r.prototype={push:function(i){this.content.push(i),this.bubbleUp(this.content.length-1)},pop:function(){var i=this.content[0],c=this.content.pop();return this.content.length>0&&(this.content[0]=c,this.sinkDown(0)),i},peek:function(){return this.content[0]},remove:function(i){for(var c=this.content.length,l=0;l<c;l++)if(this.content[l]==i){var h=this.content.pop();return void(l!=c-1&&(this.content[l]=h,this.scoreFunction(h)<this.scoreFunction(i)?this.bubbleUp(l):this.sinkDown(l)))}throw new Error("Node not found.")},size:function(){return this.content.length},bubbleUp:function(i){for(var c=this.content[i];i>0;){var l=Math.floor((i+1)/2)-1,h=this.content[l];if(!(this.scoreFunction(c)<this.scoreFunction(h)))break;this.content[l]=c,this.content[i]=h,i=l}},sinkDown:function(i){for(var c=this.content.length,l=this.content[i],h=this.scoreFunction(l);;){var d=2*(i+1),f=d-1,e=null;if(f<c){var t=this.content[f],u=this.scoreFunction(t);u<h&&(e=f)}if(d<c){var a=this.content[d];this.scoreFunction(a)<(e==null?h:u)&&(e=d)}if(e==null)break;this.content[i]=this.content[e],this.content[e]=l,i=e}}},o.kdTree=function(i,c,l){function h(f,e,t){var u,a,m=e%l.length;return f.length===0?null:f.length===1?new s(f[0],m,t):(f.sort(function(v,g){return v[l[m]]-g[l[m]]}),u=Math.floor(f.length/2),a=new s(f[u],m,t),a.left=h(f.slice(0,u),e+1,a),a.right=h(f.slice(u+1),e+1,a),a)}var d=this;Array.isArray(i)?this.root=h(i,0,null):function(f){function e(t){t.left&&(t.left.parent=t,e(t.left)),t.right&&(t.right.parent=t,e(t.right))}d.root=f,e(d.root)}(i),this.toJSON=function(f){f||(f=this.root);var e=new s(f.obj,f.dimension,null);return f.left&&(e.left=d.toJSON(f.left)),f.right&&(e.right=d.toJSON(f.right)),e},this.insert=function(f){function e(m,v){if(m===null)return v;var g=l[m.dimension];return f[g]<m.obj[g]?e(m.left,m):e(m.right,m)}var t,u,a=e(this.root,null);a!==null?(t=new s(f,(a.dimension+1)%l.length,a),u=l[a.dimension],f[u]<a.obj[u]?a.left=t:a.right=t):this.root=new s(f,0,null)},this.remove=function(f){function e(a){if(a===null)return null;if(a.obj===f)return a;var m=l[a.dimension];return f[m]<a.obj[m]?e(a.left):e(a.right)}function t(a){function m(y,p){var b,_,x,k,E;return y===null?null:(b=l[p],y.dimension===p?y.left!==null?m(y.left,p):y:(_=y.obj[b],x=m(y.left,p),k=m(y.right,p),E=y,x!==null&&x.obj[b]<_&&(E=x),k!==null&&k.obj[b]<E.obj[b]&&(E=k),E))}var v,g,w;if(a.left===null&&a.right===null)return a.parent===null?void(d.root=null):(w=l[a.parent.dimension],void(a.obj[w]<a.parent.obj[w]?a.parent.left=null:a.parent.right=null));a.right!==null?(g=(v=m(a.right,a.dimension)).obj,t(v),a.obj=g):(g=(v=m(a.left,a.dimension)).obj,t(v),a.right=a.left,a.left=null,a.obj=g)}var u;(u=e(d.root))!==null&&t(u)},this.nearest=function(f,e,t){function u(g){function w(N,$){v.push([N,$]),v.size()>e&&v.pop()}var y,p,b,_,x=l[g.dimension],k=c(f,g.obj),E={};for(_=0;_<l.length;_+=1)_===g.dimension?E[l[_]]=f[l[_]]:E[l[_]]=g.obj[l[_]];p=c(E,g.obj),g.right!==null||g.left!==null?(u(y=g.right===null?g.left:g.left===null?g.right:f[x]<g.obj[x]?g.left:g.right),(v.size()<e||k<v.peek()[1])&&w(g,k),(v.size()<e||Math.abs(p)<v.peek()[1])&&(b=y===g.left?g.right:g.left)!==null&&u(b)):(v.size()<e||k<v.peek()[1])&&w(g,k)}var a,m,v;if(v=new r(function(g){return-g[1]}),t)for(a=0;a<e;a+=1)v.push([null,t]);for(d.root&&u(d.root),m=[],a=0;a<Math.min(e,v.content.length);a+=1)v.content[a][0]&&m.push([v.content[a][0].obj,v.content[a][1]]);return m},this.balanceFactor=function(){function f(t){return t===null?0:Math.max(f(t.left),f(t.right))+1}function e(t){return t===null?0:e(t.left)+e(t.right)+1}return f(d.root)/(Math.log(e(d.root))/Math.log(2))}},o.BinaryHeap=r})}(Ln)),Ln}var Ru=qu(),Bn={exports:{}},Iu=Bn.exports,ar;function Pu(){return ar||(ar=1,function(n,o){(function(s,r){n.exports=r()})(Iu,function(){var s=function(r,i){var c=Array.prototype.concat,l=Array.prototype.slice,h=Object.prototype.toString;function d(y,p){var b=y>p?y:p;return r.pow(10,17-~~(r.log(b>0?b:-b)*r.LOG10E))}var f=Array.isArray||function(p){return h.call(p)==="[object Array]"};function e(y){return h.call(y)==="[object Function]"}function t(y){return typeof y=="number"?y-y===0:!1}function u(y){return c.apply([],y)}function a(){return new a._init(arguments)}a.fn=a.prototype,a._init=function(p){if(f(p[0]))if(f(p[0][0])){e(p[1])&&(p[0]=a.map(p[0],p[1]));for(var b=0;b<p[0].length;b++)this[b]=p[0][b];this.length=p[0].length}else this[0]=e(p[1])?a.map(p[0],p[1]):p[0],this.length=1;else if(t(p[0]))this[0]=a.seq.apply(null,p),this.length=1;else{if(p[0]instanceof a)return a(p[0].toArray());this[0]=[],this.length=1}return this},a._init.prototype=a.prototype,a._init.constructor=a,a.utils={calcRdx:d,isArray:f,isFunction:e,isNumber:t,toVector:u},a._random_fn=r.random,a.setRandom=function(p){if(typeof p!="function")throw new TypeError("fn is not a function");a._random_fn=p},a.extend=function(p){var b,_;if(arguments.length===1){for(_ in p)a[_]=p[_];return this}for(b=1;b<arguments.length;b++)for(_ in arguments[b])p[_]=arguments[b][_];return p},a.rows=function(p){return p.length||1},a.cols=function(p){return p[0].length||1},a.dimensions=function(p){return{rows:a.rows(p),cols:a.cols(p)}},a.row=function(p,b){return f(b)?b.map(function(_){return a.row(p,_)}):p[b]},a.rowa=function(p,b){return a.row(p,b)},a.col=function(p,b){if(f(b)){var _=a.arange(p.length).map(function(){return new Array(b.length)});return b.forEach(function(E,N){a.arange(p.length).forEach(function($){_[$][N]=p[$][E]})}),_}for(var x=new Array(p.length),k=0;k<p.length;k++)x[k]=[p[k][b]];return x},a.cola=function(p,b){return a.col(p,b).map(function(_){return _[0]})},a.diag=function(p){for(var b=a.rows(p),_=new Array(b),x=0;x<b;x++)_[x]=[p[x][x]];return _},a.antidiag=function(p){for(var b=a.rows(p)-1,_=new Array(b),x=0;b>=0;b--,x++)_[x]=[p[x][b]];return _},a.transpose=function(p){var b=[],_,x,k,E,N;for(f(p[0])||(p=[p]),x=p.length,k=p[0].length,N=0;N<k;N++){for(_=new Array(x),E=0;E<x;E++)_[E]=p[E][N];b.push(_)}return b.length===1?b[0]:b},a.map=function(p,b,_){var x,k,E,N,$;for(f(p[0])||(p=[p]),k=p.length,E=p[0].length,N=_?p:new Array(k),x=0;x<k;x++)for(N[x]||(N[x]=new Array(E)),$=0;$<E;$++)N[x][$]=b(p[x][$],x,$);return N.length===1?N[0]:N},a.cumreduce=function(p,b,_){var x,k,E,N,$;for(f(p[0])||(p=[p]),k=p.length,E=p[0].length,N=_?p:new Array(k),x=0;x<k;x++)for(N[x]||(N[x]=new Array(E)),E>0&&(N[x][0]=p[x][0]),$=1;$<E;$++)N[x][$]=b(N[x][$-1],p[x][$]);return N.length===1?N[0]:N},a.alter=function(p,b){return a.map(p,b,!0)},a.create=function(p,b,_){var x=new Array(p),k,E;for(e(b)&&(_=b,b=p),k=0;k<p;k++)for(x[k]=new Array(b),E=0;E<b;E++)x[k][E]=_(k,E);return x};function m(){return 0}a.zeros=function(p,b){return t(b)||(b=p),a.create(p,b,m)};function v(){return 1}a.ones=function(p,b){return t(b)||(b=p),a.create(p,b,v)},a.rand=function(p,b){return t(b)||(b=p),a.create(p,b,a._random_fn)};function g(y,p){return y===p?1:0}a.identity=function(p,b){return t(b)||(b=p),a.create(p,b,g)},a.symmetric=function(p){var b=p.length,_,x;if(p.length!==p[0].length)return!1;for(_=0;_<b;_++)for(x=0;x<b;x++)if(p[x][_]!==p[_][x])return!1;return!0},a.clear=function(p){return a.alter(p,m)},a.seq=function(p,b,_,x){e(x)||(x=!1);var k=[],E=d(p,b),N=(b*E-p*E)/((_-1)*E),$=p,A;for(A=0;$<=b&&A<_;A++,$=(p*E+N*E*A)/E)k.push(x?x($,A):$);return k},a.arange=function(p,b,_){var x=[],k;if(_=_||1,b===i&&(b=p,p=0),p===b||_===0)return[];if(p<b&&_<0)return[];if(p>b&&_>0)return[];if(_>0)for(k=p;k<b;k+=_)x.push(k);else for(k=p;k>b;k+=_)x.push(k);return x},a.slice=function(){function y(b,_,x,k){var E,N=[],$=b.length;if(_===i&&x===i&&k===i)return a.copy(b);if(_=_||0,x=x||b.length,_=_>=0?_:$+_,x=x>=0?x:$+x,k=k||1,_===x||k===0)return[];if(_<x&&k<0)return[];if(_>x&&k>0)return[];if(k>0)for(E=_;E<x;E+=k)N.push(b[E]);else for(E=_;E>x;E+=k)N.push(b[E]);return N}function p(b,_){var x,k;if(_=_||{},t(_.row)){if(t(_.col))return b[_.row][_.col];var E=a.rowa(b,_.row);return x=_.col||{},y(E,x.start,x.end,x.step)}if(t(_.col)){var N=a.cola(b,_.col);return k=_.row||{},y(N,k.start,k.end,k.step)}k=_.row||{},x=_.col||{};var $=y(b,k.start,k.end,k.step);return $.map(function(A){return y(A,x.start,x.end,x.step)})}return p}(),a.sliceAssign=function(p,b,_){var x,k;if(t(b.row)){if(t(b.col))return p[b.row][b.col]=_;b.col=b.col||{},b.col.start=b.col.start||0,b.col.end=b.col.end||p[0].length,b.col.step=b.col.step||1,x=a.arange(b.col.start,r.min(p.length,b.col.end),b.col.step);var E=b.row;return x.forEach(function($,A){p[E][$]=_[A]}),p}if(t(b.col)){b.row=b.row||{},b.row.start=b.row.start||0,b.row.end=b.row.end||p.length,b.row.step=b.row.step||1,k=a.arange(b.row.start,r.min(p[0].length,b.row.end),b.row.step);var N=b.col;return k.forEach(function($,A){p[$][N]=_[A]}),p}return _[0].length===i&&(_=[_]),b.row.start=b.row.start||0,b.row.end=b.row.end||p.length,b.row.step=b.row.step||1,b.col.start=b.col.start||0,b.col.end=b.col.end||p[0].length,b.col.step=b.col.step||1,k=a.arange(b.row.start,r.min(p.length,b.row.end),b.row.step),x=a.arange(b.col.start,r.min(p[0].length,b.col.end),b.col.step),k.forEach(function($,A){x.forEach(function(q,R){p[$][q]=_[A][R]})}),p},a.diagonal=function(p){var b=a.zeros(p.length,p.length);return p.forEach(function(_,x){b[x][x]=_}),b},a.copy=function(p){return p.map(function(b){return t(b)?b:b.map(function(_){return _})})};var w=a.prototype;return w.length=0,w.push=Array.prototype.push,w.sort=Array.prototype.sort,w.splice=Array.prototype.splice,w.slice=Array.prototype.slice,w.toArray=function(){return this.length>1?l.call(this):l.call(this)[0]},w.map=function(p,b){return a(a.map(this,p,b))},w.cumreduce=function(p,b){return a(a.cumreduce(this,p,b))},w.alter=function(p){return a.alter(this,p),this},function(y){for(var p=0;p<y.length;p++)(function(b){w[b]=function(_){var x=this,k;return _?(setTimeout(function(){_.call(x,w[b].call(x))}),this):(k=a[b](this),f(k)?a(k):k)}})(y[p])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(y){for(var p=0;p<y.length;p++)(function(b){w[b]=function(_,x){var k=this;return x?(setTimeout(function(){x.call(k,w[b].call(k,_))}),this):a(a[b](this,_))}})(y[p])}("row col".split(" ")),function(y){for(var p=0;p<y.length;p++)(function(b){w[b]=function(){return a(a[b].apply(null,arguments))}})(y[p])}("create zeros ones rand identity".split(" ")),a}(Math);return function(r,i){var c=r.utils.isFunction;function l(f,e){return f-e}function h(f,e,t){return i.max(e,i.min(f,t))}r.sum=function(e){for(var t=0,u=e.length;--u>=0;)t+=e[u];return t},r.sumsqrd=function(e){for(var t=0,u=e.length;--u>=0;)t+=e[u]*e[u];return t},r.sumsqerr=function(e){for(var t=r.mean(e),u=0,a=e.length,m;--a>=0;)m=e[a]-t,u+=m*m;return u},r.sumrow=function(e){for(var t=0,u=e.length;--u>=0;)t+=e[u];return t},r.product=function(e){for(var t=1,u=e.length;--u>=0;)t*=e[u];return t},r.min=function(e){for(var t=e[0],u=0;++u<e.length;)e[u]<t&&(t=e[u]);return t},r.max=function(e){for(var t=e[0],u=0;++u<e.length;)e[u]>t&&(t=e[u]);return t},r.unique=function(e){for(var t={},u=[],a=0;a<e.length;a++)t[e[a]]||(t[e[a]]=!0,u.push(e[a]));return u},r.mean=function(e){return r.sum(e)/e.length},r.meansqerr=function(e){return r.sumsqerr(e)/e.length},r.geomean=function(e){var t=e.map(i.log),u=r.mean(t);return i.exp(u)},r.median=function(e){var t=e.length,u=e.slice().sort(l);return t&1?u[t/2|0]:(u[t/2-1]+u[t/2])/2},r.cumsum=function(e){return r.cumreduce(e,function(t,u){return t+u})},r.cumprod=function(e){return r.cumreduce(e,function(t,u){return t*u})},r.diff=function(e){var t=[],u=e.length,a;for(a=1;a<u;a++)t.push(e[a]-e[a-1]);return t},r.rank=function(f){var e,t=[],u={};for(e=0;e<f.length;e++){var a=f[e];u[a]?u[a]++:(u[a]=1,t.push(a))}var m=t.sort(l),v={},g=1;for(e=0;e<m.length;e++){var a=m[e],w=u[a],y=g,p=g+w-1,b=(y+p)/2;v[a]=b,g+=w}return f.map(function(_){return v[_]})},r.mode=function(e){var t=e.length,u=e.slice().sort(l),a=1,m=0,v=0,g=[],w;for(w=0;w<t;w++)u[w]===u[w+1]?a++:(a>m?(g=[u[w]],m=a,v=0):a===m&&(g.push(u[w]),v++),a=1);return v===0?g[0]:g},r.range=function(e){return r.max(e)-r.min(e)},r.variance=function(e,t){return r.sumsqerr(e)/(e.length-(t?1:0))},r.pooledvariance=function(e){var t=e.reduce(function(a,m){return a+r.sumsqerr(m)},0),u=e.reduce(function(a,m){return a+m.length},0);return t/(u-e.length)},r.deviation=function(f){for(var e=r.mean(f),t=f.length,u=new Array(t),a=0;a<t;a++)u[a]=f[a]-e;return u},r.stdev=function(e,t){return i.sqrt(r.variance(e,t))},r.pooledstdev=function(e){return i.sqrt(r.pooledvariance(e))},r.meandev=function(e){for(var t=r.mean(e),u=[],a=e.length-1;a>=0;a--)u.push(i.abs(e[a]-t));return r.mean(u)},r.meddev=function(e){for(var t=r.median(e),u=[],a=e.length-1;a>=0;a--)u.push(i.abs(e[a]-t));return r.median(u)},r.coeffvar=function(e){return r.stdev(e)/r.mean(e)},r.quartiles=function(e){var t=e.length,u=e.slice().sort(l);return[u[i.round(t/4)-1],u[i.round(t/2)-1],u[i.round(t*3/4)-1]]},r.quantiles=function(e,t,u,a){var m=e.slice().sort(l),v=[t.length],g=e.length,w,y,p,b,_,x;for(typeof u>"u"&&(u=3/8),typeof a>"u"&&(a=3/8),w=0;w<t.length;w++)y=t[w],p=u+y*(1-u-a),b=g*y+p,_=i.floor(h(b,1,g-1)),x=h(b-_,0,1),v[w]=(1-x)*m[_-1]+x*m[_];return v},r.percentile=function(e,t,u){var a=e.slice().sort(l),m=t*(a.length+(u?1:-1))+(u?0:1),v=parseInt(m),g=m-v;return v+1<a.length?a[v-1]+g*(a[v]-a[v-1]):a[v-1]},r.percentileOfScore=function(e,t,u){var a=0,m=e.length,v=!1,g,w;for(u==="strict"&&(v=!0),w=0;w<m;w++)g=e[w],(v&&g<t||!v&&g<=t)&&a++;return a/m},r.histogram=function(e,t){t=t||4;var u=r.min(e),a=(r.max(e)-u)/t,m=e.length,v=[],g;for(g=0;g<t;g++)v[g]=0;for(g=0;g<m;g++)v[i.min(i.floor((e[g]-u)/a),t-1)]+=1;return v},r.covariance=function(e,t){var u=r.mean(e),a=r.mean(t),m=e.length,v=new Array(m),g;for(g=0;g<m;g++)v[g]=(e[g]-u)*(t[g]-a);return r.sum(v)/(m-1)},r.corrcoeff=function(e,t){return r.covariance(e,t)/r.stdev(e,1)/r.stdev(t,1)},r.spearmancoeff=function(f,e){return f=r.rank(f),e=r.rank(e),r.corrcoeff(f,e)},r.stanMoment=function(e,t){for(var u=r.mean(e),a=r.stdev(e),m=e.length,v=0,g=0;g<m;g++)v+=i.pow((e[g]-u)/a,t);return v/e.length},r.skewness=function(e){return r.stanMoment(e,3)},r.kurtosis=function(e){return r.stanMoment(e,4)-3};var d=r.prototype;(function(f){for(var e=0;e<f.length;e++)(function(t){d[t]=function(u,a){var m=[],v=0,g=this;if(c(u)&&(a=u,u=!1),a)return setTimeout(function(){a.call(g,d[t].call(g,u))}),this;if(this.length>1){for(g=u===!0?this:this.transpose();v<g.length;v++)m[v]=r[t](g[v]);return m}return r[t](this[0],u)}})(f[e])})("cumsum cumprod".split(" ")),function(f){for(var e=0;e<f.length;e++)(function(t){d[t]=function(u,a){var m=[],v=0,g=this;if(c(u)&&(a=u,u=!1),a)return setTimeout(function(){a.call(g,d[t].call(g,u))}),this;if(this.length>1){for(t!=="sumrow"&&(g=u===!0?this:this.transpose());v<g.length;v++)m[v]=r[t](g[v]);return u===!0?r[t](r.utils.toVector(m)):m}return r[t](this[0],u)}})(f[e])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(f){for(var e=0;e<f.length;e++)(function(t){d[t]=function(){var u=[],a=0,m=this,v=Array.prototype.slice.call(arguments),g;if(c(v[v.length-1])){g=v[v.length-1];var w=v.slice(0,v.length-1);return setTimeout(function(){g.call(m,d[t].apply(m,w))}),this}else{g=void 0;var y=function(b){return r[t].apply(m,[b].concat(v))}}if(this.length>1){for(m=m.transpose();a<m.length;a++)u[a]=y(m[a]);return u}return y(this[0])}})(f[e])}("quantiles percentileOfScore".split(" "))}(s,Math),function(r,i){r.gammaln=function(l){var h=0,d=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],f=1.000000000190015,e,t,u;for(u=(t=e=l)+5.5,u-=(e+.5)*i.log(u);h<6;h++)f+=d[h]/++t;return i.log(2.5066282746310007*f/e)-u},r.loggam=function(l){var h,d,f,e,t,u,a,m=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(h=l,a=0,l==1||l==2)return 0;for(l<=7&&(a=i.floor(7-l),h=l+a),d=1/(h*h),f=2*i.PI,t=m[9],u=8;u>=0;u--)t*=d,t+=m[u];if(e=t/h+.5*i.log(f)+(h-.5)*i.log(h)-h,l<=7)for(u=1;u<=a;u++)e-=i.log(h-1),h-=1;return e},r.gammafn=function(l){var h=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],d=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],f=!1,e=0,t=0,u=0,a=l,m,v,g,w;if(l>171.6243769536076)return 1/0;if(a<=0)if(w=a%1+36e-17,w)f=(a&1?-1:1)*i.PI/i.sin(i.PI*w),a=1-a;else return 1/0;for(g=a,a<1?v=a++:v=(a-=e=(a|0)-1)-1,m=0;m<8;++m)u=(u+h[m])*v,t=t*v+d[m];if(w=u/t+1,g<a)w/=g;else if(g>a)for(m=0;m<e;++m)w*=a,a++;return f&&(w=f/w),w},r.gammap=function(l,h){return r.lowRegGamma(l,h)*r.gammafn(l)},r.lowRegGamma=function(l,h){var d=r.gammaln(l),f=l,e=1/l,t=e,u=h+1-l,a=1/1e-30,m=1/u,v=m,g=1,w=-~(i.log(l>=1?l:1/l)*8.5+l*.4+17),y;if(h<0||l<=0)return NaN;if(h<l+1){for(;g<=w;g++)e+=t*=h/++f;return e*i.exp(-h+l*i.log(h)-d)}for(;g<=w;g++)y=-g*(g-l),u+=2,m=y*m+u,a=u+y/a,m=1/m,v*=m*a;return 1-v*i.exp(-h+l*i.log(h)-d)},r.factorialln=function(l){return l<0?NaN:r.gammaln(l+1)},r.factorial=function(l){return l<0?NaN:r.gammafn(l+1)},r.combination=function(l,h){return l>170||h>170?i.exp(r.combinationln(l,h)):r.factorial(l)/r.factorial(h)/r.factorial(l-h)},r.combinationln=function(l,h){return r.factorialln(l)-r.factorialln(h)-r.factorialln(l-h)},r.permutation=function(l,h){return r.factorial(l)/r.factorial(l-h)},r.betafn=function(l,h){if(!(l<=0||h<=0))return l+h>170?i.exp(r.betaln(l,h)):r.gammafn(l)*r.gammafn(h)/r.gammafn(l+h)},r.betaln=function(l,h){return r.gammaln(l)+r.gammaln(h)-r.gammaln(l+h)},r.betacf=function(l,h,d){var f=1e-30,e=1,t=h+d,u=h+1,a=h-1,m=1,v=1-t*l/u,g,w,y,p;for(i.abs(v)<f&&(v=f),v=1/v,p=v;e<=100&&(g=2*e,w=e*(d-e)*l/((a+g)*(h+g)),v=1+w*v,i.abs(v)<f&&(v=f),m=1+w/m,i.abs(m)<f&&(m=f),v=1/v,p*=v*m,w=-(h+e)*(t+e)*l/((h+g)*(u+g)),v=1+w*v,i.abs(v)<f&&(v=f),m=1+w/m,i.abs(m)<f&&(m=f),v=1/v,y=v*m,p*=y,!(i.abs(y-1)<3e-7));e++);return p},r.gammapinv=function(l,h){var d=0,f=h-1,e=1e-8,t=r.gammaln(h),u,a,m,v,g,w,y;if(l>=1)return i.max(100,h+100*i.sqrt(h));if(l<=0)return 0;for(h>1?(w=i.log(f),y=i.exp(f*(w-1)-t),g=l<.5?l:1-l,m=i.sqrt(-2*i.log(g)),u=(2.30753+m*.27061)/(1+m*(.99229+m*.04481))-m,l<.5&&(u=-u),u=i.max(.001,h*i.pow(1-1/(9*h)-u/(3*i.sqrt(h)),3))):(m=1-h*(.253+h*.12),l<m?u=i.pow(l/m,1/h):u=1-i.log(1-(l-m)/(1-m)));d<12;d++){if(u<=0)return 0;if(a=r.lowRegGamma(h,u)-l,h>1?m=y*i.exp(-(u-f)+f*(i.log(u)-w)):m=i.exp(-u+f*i.log(u)-t),v=a/m,u-=m=v/(1-.5*i.min(1,v*((h-1)/u-1))),u<=0&&(u=.5*(u+m)),i.abs(m)<e*u)break}return u},r.erf=function(l){var h=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],d=h.length-1,f=!1,e=0,t=0,u,a,m,v;for(l<0&&(l=-l,f=!0),u=2/(2+l),a=4*u-2;d>0;d--)m=e,e=a*e-t+h[d],t=m;return v=u*i.exp(-l*l+.5*(h[0]+a*e)-t),f?v-1:1-v},r.erfc=function(l){return 1-r.erf(l)},r.erfcinv=function(l){var h=0,d,f,e,t;if(l>=2)return-100;if(l<=0)return 100;for(t=l<1?l:2-l,e=i.sqrt(-2*i.log(t/2)),d=-.70711*((2.30753+e*.27061)/(1+e*(.99229+e*.04481))-e);h<2;h++)f=r.erfc(d)-t,d+=f/(1.1283791670955126*i.exp(-d*d)-d*f);return l<1?d:-d},r.ibetainv=function(l,h,d){var f=1e-8,e=h-1,t=d-1,u=0,a,m,v,g,w,y,p,b,_,x,k;if(l<=0)return 0;if(l>=1)return 1;for(h>=1&&d>=1?(v=l<.5?l:1-l,g=i.sqrt(-2*i.log(v)),p=(2.30753+g*.27061)/(1+g*(.99229+g*.04481))-g,l<.5&&(p=-p),b=(p*p-3)/6,_=2/(1/(2*h-1)+1/(2*d-1)),x=p*i.sqrt(b+_)/_-(1/(2*d-1)-1/(2*h-1))*(b+5/6-2/(3*_)),p=h/(h+d*i.exp(2*x))):(a=i.log(h/(h+d)),m=i.log(d/(h+d)),g=i.exp(h*a)/h,w=i.exp(d*m)/d,x=g+w,l<g/x?p=i.pow(h*x*l,1/h):p=1-i.pow(d*x*(1-l),1/d)),k=-r.gammaln(h)-r.gammaln(d)+r.gammaln(h+d);u<10;u++){if(p===0||p===1)return p;if(y=r.ibeta(p,h,d)-l,g=i.exp(e*i.log(p)+t*i.log(1-p)+k),w=y/g,p-=g=w/(1-.5*i.min(1,w*(e/p-t/(1-p)))),p<=0&&(p=.5*(p+g)),p>=1&&(p=.5*(p+g+1)),i.abs(g)<f*p&&u>0)break}return p},r.ibeta=function(l,h,d){var f=l===0||l===1?0:i.exp(r.gammaln(h+d)-r.gammaln(h)-r.gammaln(d)+h*i.log(l)+d*i.log(1-l));return l<0||l>1?!1:l<(h+1)/(h+d+2)?f*r.betacf(l,h,d)/h:1-f*r.betacf(1-l,d,h)/d},r.randn=function(l,h){var d,f,e,t,u;if(h||(h=l),l)return r.create(l,h,function(){return r.randn()});do d=r._random_fn(),f=1.7156*(r._random_fn()-.5),e=d-.449871,t=i.abs(f)+.386595,u=e*e+t*(.196*t-.25472*e);while(u>.27597&&(u>.27846||f*f>-4*i.log(d)*d*d));return f/d},r.randg=function(l,h,d){var f=l,e,t,u,a,m,v;if(d||(d=h),l||(l=1),h)return v=r.zeros(h,d),v.alter(function(){return r.randg(l)}),v;l<1&&(l+=1),e=l-1/3,t=1/i.sqrt(9*e);do{do m=r.randn(),a=1+t*m;while(a<=0);a=a*a*a,u=r._random_fn()}while(u>1-.331*i.pow(m,4)&&i.log(u)>.5*m*m+e*(1-a+i.log(a)));if(l==f)return e*a;do u=r._random_fn();while(u===0);return i.pow(u,1/f)*e*a},function(c){for(var l=0;l<c.length;l++)(function(h){r.fn[h]=function(){return r(r.map(this,function(d){return r[h](d)}))}})(c[l])}("gammaln gammafn factorial factorialln".split(" ")),function(c){for(var l=0;l<c.length;l++)(function(h){r.fn[h]=function(){return r(r[h].apply(null,arguments))}})(c[l])}("randn".split(" "))}(s,Math),function(r,i){(function(f){for(var e=0;e<f.length;e++)(function(t){r[t]=function u(a,m,v){return this instanceof u?(this._a=a,this._b=m,this._c=v,this):new u(a,m,v)},r.fn[t]=function(u,a,m){var v=r[t](u,a,m);return v.data=this,v},r[t].prototype.sample=function(u){var a=this._a,m=this._b,v=this._c;return u?r.alter(u,function(){return r[t].sample(a,m,v)}):r[t].sample(a,m,v)},function(u){for(var a=0;a<u.length;a++)(function(m){r[t].prototype[m]=function(v){var g=this._a,w=this._b,y=this._c;return!v&&v!==0&&(v=this.data),typeof v!="number"?r.fn.map.call(v,function(p){return r[t][m](p,g,w,y)}):r[t][m](v,g,w,y)}})(u[a])}("pdf cdf inv".split(" ")),function(u){for(var a=0;a<u.length;a++)(function(m){r[t].prototype[m]=function(){return r[t][m](this._a,this._b,this._c)}})(u[a])}("mean median mode variance".split(" "))})(f[e])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),r.extend(r.beta,{pdf:function(e,t,u){return e>1||e<0?0:t==1&&u==1?1:t<512&&u<512?i.pow(e,t-1)*i.pow(1-e,u-1)/r.betafn(t,u):i.exp((t-1)*i.log(e)+(u-1)*i.log(1-e)-r.betaln(t,u))},cdf:function(e,t,u){return e>1||e<0?(e>1)*1:r.ibeta(e,t,u)},inv:function(e,t,u){return r.ibetainv(e,t,u)},mean:function(e,t){return e/(e+t)},median:function(e,t){return r.ibetainv(.5,e,t)},mode:function(e,t){return(e-1)/(e+t-2)},sample:function(e,t){var u=r.randg(e);return u/(u+r.randg(t))},variance:function(e,t){return e*t/(i.pow(e+t,2)*(e+t+1))}}),r.extend(r.centralF,{pdf:function(e,t,u){var a,m,v;return e<0?0:t<=2?e===0&&t<2?1/0:e===0&&t===2?1:1/r.betafn(t/2,u/2)*i.pow(t/u,t/2)*i.pow(e,t/2-1)*i.pow(1+t/u*e,-(t+u)/2):(a=t*e/(u+e*t),m=u/(u+e*t),v=t*m/2,v*r.binomial.pdf((t-2)/2,(t+u-2)/2,a))},cdf:function(e,t,u){return e<0?0:r.ibeta(t*e/(t*e+u),t/2,u/2)},inv:function(e,t,u){return u/(t*(1/r.ibetainv(e,t/2,u/2)-1))},mean:function(e,t){return t>2?t/(t-2):void 0},mode:function(e,t){return e>2?t*(e-2)/(e*(t+2)):void 0},sample:function(e,t){var u=r.randg(e/2)*2,a=r.randg(t/2)*2;return u/e/(a/t)},variance:function(e,t){if(!(t<=4))return 2*t*t*(e+t-2)/(e*(t-2)*(t-2)*(t-4))}}),r.extend(r.cauchy,{pdf:function(e,t,u){return u<0?0:u/(i.pow(e-t,2)+i.pow(u,2))/i.PI},cdf:function(e,t,u){return i.atan((e-t)/u)/i.PI+.5},inv:function(f,e,t){return e+t*i.tan(i.PI*(f-.5))},median:function(e){return e},mode:function(e){return e},sample:function(e,t){return r.randn()*i.sqrt(1/(2*r.randg(.5)))*t+e}}),r.extend(r.chisquare,{pdf:function(e,t){return e<0?0:e===0&&t===2?.5:i.exp((t/2-1)*i.log(e)-e/2-t/2*i.log(2)-r.gammaln(t/2))},cdf:function(e,t){return e<0?0:r.lowRegGamma(t/2,e/2)},inv:function(f,e){return 2*r.gammapinv(f,.5*e)},mean:function(f){return f},median:function(e){return e*i.pow(1-2/(9*e),3)},mode:function(e){return e-2>0?e-2:0},sample:function(e){return r.randg(e/2)*2},variance:function(e){return 2*e}}),r.extend(r.exponential,{pdf:function(e,t){return e<0?0:t*i.exp(-t*e)},cdf:function(e,t){return e<0?0:1-i.exp(-t*e)},inv:function(f,e){return-i.log(1-f)/e},mean:function(f){return 1/f},median:function(f){return 1/f*i.log(2)},mode:function(){return 0},sample:function(e){return-1/e*i.log(r._random_fn())},variance:function(f){return i.pow(f,-2)}}),r.extend(r.gamma,{pdf:function(e,t,u){return e<0?0:e===0&&t===1?1/u:i.exp((t-1)*i.log(e)-e/u-r.gammaln(t)-t*i.log(u))},cdf:function(e,t,u){return e<0?0:r.lowRegGamma(t,e/u)},inv:function(f,e,t){return r.gammapinv(f,e)*t},mean:function(f,e){return f*e},mode:function(e,t){if(e>1)return(e-1)*t},sample:function(e,t){return r.randg(e)*t},variance:function(e,t){return e*t*t}}),r.extend(r.invgamma,{pdf:function(e,t,u){return e<=0?0:i.exp(-(t+1)*i.log(e)-u/e-r.gammaln(t)+t*i.log(u))},cdf:function(e,t,u){return e<=0?0:1-r.lowRegGamma(t,u/e)},inv:function(f,e,t){return t/r.gammapinv(1-f,e)},mean:function(f,e){return f>1?e/(f-1):void 0},mode:function(e,t){return t/(e+1)},sample:function(e,t){return t/r.randg(e)},variance:function(e,t){if(!(e<=2))return t*t/((e-1)*(e-1)*(e-2))}}),r.extend(r.kumaraswamy,{pdf:function(e,t,u){return e===0&&t===1?u:e===1&&u===1?t:i.exp(i.log(t)+i.log(u)+(t-1)*i.log(e)+(u-1)*i.log(1-i.pow(e,t)))},cdf:function(e,t,u){return e<0?0:e>1?1:1-i.pow(1-i.pow(e,t),u)},inv:function(e,t,u){return i.pow(1-i.pow(1-e,1/u),1/t)},mean:function(f,e){return e*r.gammafn(1+1/f)*r.gammafn(e)/r.gammafn(1+1/f+e)},median:function(e,t){return i.pow(1-i.pow(2,-1/t),1/e)},mode:function(e,t){if(e>=1&&t>=1&&e!==1&&t!==1)return i.pow((e-1)/(e*t-1),1/e)},variance:function(){throw new Error("variance not yet implemented")}}),r.extend(r.lognormal,{pdf:function(e,t,u){return e<=0?0:i.exp(-i.log(e)-.5*i.log(2*i.PI)-i.log(u)-i.pow(i.log(e)-t,2)/(2*u*u))},cdf:function(e,t,u){return e<0?0:.5+.5*r.erf((i.log(e)-t)/i.sqrt(2*u*u))},inv:function(f,e,t){return i.exp(-1.4142135623730951*t*r.erfcinv(2*f)+e)},mean:function(e,t){return i.exp(e+t*t/2)},median:function(e){return i.exp(e)},mode:function(e,t){return i.exp(e-t*t)},sample:function(e,t){return i.exp(r.randn()*t+e)},variance:function(e,t){return(i.exp(t*t)-1)*i.exp(2*e+t*t)}}),r.extend(r.noncentralt,{pdf:function(e,t,u){var a=1e-14;return i.abs(u)<a?r.studentt.pdf(e,t):i.abs(e)<a?i.exp(r.gammaln((t+1)/2)-u*u/2-.5*i.log(i.PI*t)-r.gammaln(t/2)):t/e*(r.noncentralt.cdf(e*i.sqrt(1+2/t),t+2,u)-r.noncentralt.cdf(e,t,u))},cdf:function(e,t,u){var a=1e-14,m=200;if(i.abs(u)<a)return r.studentt.cdf(e,t);var v=!1;e<0&&(v=!0,u=-u);for(var g=r.normal.cdf(-u,0,1),w=a+1,y=w,p=e*e/(e*e+t),b=0,_=i.exp(-u*u/2),x=i.exp(-u*u/2-.5*i.log(2)-r.gammaln(3/2))*u;b<m||y>a||w>a;)y=w,b>0&&(_*=u*u/(2*b),x*=u*u/(2*(b+1/2))),w=_*r.beta.cdf(p,b+.5,t/2)+x*r.beta.cdf(p,b+1,t/2),g+=.5*w,b++;return v?1-g:g}}),r.extend(r.normal,{pdf:function(e,t,u){return i.exp(-.5*i.log(2*i.PI)-i.log(u)-i.pow(e-t,2)/(2*u*u))},cdf:function(e,t,u){return .5*(1+r.erf((e-t)/i.sqrt(2*u*u)))},inv:function(f,e,t){return-1.4142135623730951*t*r.erfcinv(2*f)+e},mean:function(f){return f},median:function(e){return e},mode:function(f){return f},sample:function(e,t){return r.randn()*t+e},variance:function(f,e){return e*e}}),r.extend(r.pareto,{pdf:function(e,t,u){return e<t?0:u*i.pow(t,u)/i.pow(e,u+1)},cdf:function(e,t,u){return e<t?0:1-i.pow(t/e,u)},inv:function(e,t,u){return t/i.pow(1-e,1/u)},mean:function(e,t){if(!(t<=1))return t*i.pow(e,t)/(t-1)},median:function(e,t){return e*(t*i.SQRT2)},mode:function(e){return e},variance:function(f,e){if(!(e<=2))return f*f*e/(i.pow(e-1,2)*(e-2))}}),r.extend(r.studentt,{pdf:function(e,t){return t=t>1e100?1e100:t,1/(i.sqrt(t)*r.betafn(.5,t/2))*i.pow(1+e*e/t,-((t+1)/2))},cdf:function(e,t){var u=t/2;return r.ibeta((e+i.sqrt(e*e+t))/(2*i.sqrt(e*e+t)),u,u)},inv:function(f,e){var t=r.ibetainv(2*i.min(f,1-f),.5*e,.5);return t=i.sqrt(e*(1-t)/t),f>.5?t:-t},mean:function(e){return e>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(e){return r.randn()*i.sqrt(e/(2*r.randg(e/2)))},variance:function(e){return e>2?e/(e-2):e>1?1/0:void 0}}),r.extend(r.weibull,{pdf:function(e,t,u){return e<0||t<0||u<0?0:u/t*i.pow(e/t,u-1)*i.exp(-i.pow(e/t,u))},cdf:function(e,t,u){return e<0?0:1-i.exp(-i.pow(e/t,u))},inv:function(f,e,t){return e*i.pow(-i.log(1-f),1/t)},mean:function(f,e){return f*r.gammafn(1+1/e)},median:function(e,t){return e*i.pow(i.log(2),1/t)},mode:function(e,t){return t<=1?0:e*i.pow((t-1)/t,1/t)},sample:function(e,t){return e*i.pow(-i.log(r._random_fn()),1/t)},variance:function(e,t){return e*e*r.gammafn(1+2/t)-i.pow(r.weibull.mean(e,t),2)}}),r.extend(r.uniform,{pdf:function(e,t,u){return e<t||e>u?0:1/(u-t)},cdf:function(e,t,u){return e<t?0:e<u?(e-t)/(u-t):1},inv:function(f,e,t){return e+f*(t-e)},mean:function(e,t){return .5*(e+t)},median:function(e,t){return r.mean(e,t)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(e,t){return e/2+t/2+(t/2-e/2)*(2*r._random_fn()-1)},variance:function(e,t){return i.pow(t-e,2)/12}});function c(f,e,t,u){for(var a=0,m=1,v=1,g=1,w=0,y=0,p;i.abs((v-y)/v)>u;)y=v,p=-(e+w)*(e+t+w)*f/(e+2*w)/(e+2*w+1),a=v+p*a,m=g+p*m,w=w+1,p=w*(t-w)*f/(e+2*w-1)/(e+2*w),v=a+p*v,g=m+p*g,a=a/g,m=m/g,v=v/g,g=1;return v/e}r.extend(r.binomial,{pdf:function(e,t,u){return u===0||u===1?t*u===e?1:0:r.combination(t,e)*i.pow(u,e)*i.pow(1-u,t-e)},cdf:function(e,t,u){var a,m=1e-10;if(e<0)return 0;if(e>=t)return 1;if(u<0||u>1||t<=0)return NaN;e=i.floor(e);var v=u,g=e+1,w=t-e,y=g+w,p=i.exp(r.gammaln(y)-r.gammaln(w)-r.gammaln(g)+g*i.log(v)+w*i.log(1-v));return v<(g+1)/(y+2)?a=p*c(v,g,w,m):a=1-p*c(1-v,w,g,m),i.round((1-a)*(1/m))/(1/m)}}),r.extend(r.negbin,{pdf:function(e,t,u){return e!==e>>>0?!1:e<0?0:r.combination(e+t-1,t-1)*i.pow(1-u,e)*i.pow(u,t)},cdf:function(e,t,u){var a=0,m=0;if(e<0)return 0;for(;m<=e;m++)a+=r.negbin.pdf(m,t,u);return a}}),r.extend(r.hypgeom,{pdf:function(e,t,u,a){if(e!==e|0)return!1;if(e<0||e<u-(t-a))return 0;if(e>a||e>u)return 0;if(u*2>t)return a*2>t?r.hypgeom.pdf(t-u-a+e,t,t-u,t-a):r.hypgeom.pdf(a-e,t,t-u,a);if(a*2>t)return r.hypgeom.pdf(u-e,t,u,t-a);if(u<a)return r.hypgeom.pdf(e,t,a,u);for(var m=1,v=0,g=0;g<e;g++){for(;m>1&&v<a;)m*=1-u/(t-v),v++;m*=(a-g)*(u-g)/((g+1)*(t-u-a+g+1))}for(;v<a;v++)m*=1-u/(t-v);return i.min(1,i.max(0,m))},cdf:function(e,t,u,a){if(e<0||e<u-(t-a))return 0;if(e>=a||e>=u)return 1;if(u*2>t)return a*2>t?r.hypgeom.cdf(t-u-a+e,t,t-u,t-a):1-r.hypgeom.cdf(a-e-1,t,t-u,a);if(a*2>t)return 1-r.hypgeom.cdf(u-e-1,t,u,t-a);if(u<a)return r.hypgeom.cdf(e,t,a,u);for(var m=1,v=1,g=0,w=0;w<e;w++){for(;m>1&&g<a;){var y=1-u/(t-g);v*=y,m*=y,g++}v*=(a-w)*(u-w)/((w+1)*(t-u-a+w+1)),m+=v}for(;g<a;g++)m*=1-u/(t-g);return i.min(1,i.max(0,m))}}),r.extend(r.poisson,{pdf:function(e,t){return t<0||e%1!==0||e<0?0:i.pow(t,e)*i.exp(-t)/r.factorial(e)},cdf:function(e,t){var u=[],a=0;if(e<0)return 0;for(;a<=e;a++)u.push(r.poisson.pdf(a,t));return r.sum(u)},mean:function(f){return f},variance:function(f){return f},sampleSmall:function(e){var t=1,u=0,a=i.exp(-e);do u++,t*=r._random_fn();while(t>a);return u-1},sampleLarge:function(e){var t=e,u,a,m,v,g,w,y,p,b,_;for(v=i.sqrt(t),g=i.log(t),y=.931+2.53*v,w=-.059+.02483*y,p=1.1239+1.1328/(y-3.4),b=.9277-3.6224/(y-2);;){if(a=i.random()-.5,m=i.random(),_=.5-i.abs(a),u=i.floor((2*w/_+y)*a+t+.43),_>=.07&&m<=b)return u;if(!(u<0||_<.013&&m>_)&&i.log(m)+i.log(p)-i.log(w/(_*_)+y)<=-t+u*g-r.loggam(u+1))return u}},sample:function(e){return e<10?this.sampleSmall(e):this.sampleLarge(e)}}),r.extend(r.triangular,{pdf:function(e,t,u,a){return u<=t||a<t||a>u?NaN:e<t||e>u?0:e<a?2*(e-t)/((u-t)*(a-t)):e===a?2/(u-t):2*(u-e)/((u-t)*(u-a))},cdf:function(e,t,u,a){return u<=t||a<t||a>u?NaN:e<=t?0:e>=u?1:e<=a?i.pow(e-t,2)/((u-t)*(a-t)):1-i.pow(u-e,2)/((u-t)*(u-a))},inv:function(e,t,u,a){return u<=t||a<t||a>u?NaN:e<=(a-t)/(u-t)?t+(u-t)*i.sqrt(e*((a-t)/(u-t))):t+(u-t)*(1-i.sqrt((1-e)*(1-(a-t)/(u-t))))},mean:function(e,t,u){return(e+t+u)/3},median:function(e,t,u){if(u<=(e+t)/2)return t-i.sqrt((t-e)*(t-u))/i.sqrt(2);if(u>(e+t)/2)return e+i.sqrt((t-e)*(u-e))/i.sqrt(2)},mode:function(e,t,u){return u},sample:function(e,t,u){var a=r._random_fn();return a<(u-e)/(t-e)?e+i.sqrt(a*(t-e)*(u-e)):t-i.sqrt((1-a)*(t-e)*(t-u))},variance:function(e,t,u){return(e*e+t*t+u*u-e*t-e*u-t*u)/18}}),r.extend(r.arcsine,{pdf:function(e,t,u){return u<=t?NaN:e<=t||e>=u?0:2/i.PI*i.pow(i.pow(u-t,2)-i.pow(2*e-t-u,2),-.5)},cdf:function(e,t,u){return e<t?0:e<u?2/i.PI*i.asin(i.sqrt((e-t)/(u-t))):1},inv:function(f,e,t){return e+(.5-.5*i.cos(i.PI*f))*(t-e)},mean:function(e,t){return t<=e?NaN:(e+t)/2},median:function(e,t){return t<=e?NaN:(e+t)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(e,t){return(e+t)/2+(t-e)/2*i.sin(2*i.PI*r.uniform.sample(0,1))},variance:function(e,t){return t<=e?NaN:i.pow(t-e,2)/8}});function l(f){return f/i.abs(f)}r.extend(r.laplace,{pdf:function(e,t,u){return u<=0?0:i.exp(-i.abs(e-t)/u)/(2*u)},cdf:function(e,t,u){return u<=0?0:e<t?.5*i.exp((e-t)/u):1-.5*i.exp(-(e-t)/u)},mean:function(f){return f},median:function(f){return f},mode:function(f){return f},variance:function(f,e){return 2*e*e},sample:function(e,t){var u=r._random_fn()-.5;return e-t*l(u)*i.log(1-2*i.abs(u))}});function h(f,e,t){var u=12,a=6,m=-30,v=-50,g=60,w=8,y=3,p=2,b=3,_=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],x=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],k=f*.5;if(k>=w)return 1;var E=2*r.normal.cdf(k,0,1,1,0)-1;E>=i.exp(v/t)?E=i.pow(E,t):E=0;var N;f>y?N=p:N=b;for(var $=k,A=(w-k)/N,q=$+A,R=0,I=t-1,V=1;V<=N;V++){for(var W=0,P=.5*(q+$),L=.5*(q-$),T=1;T<=u;T++){var D,U;a<T?(D=u-T+1,U=_[D-1]):(D=T,U=-_[D-1]);var M=L*U,z=P+M,j=z*z;if(j>g)break;var yn=2*r.normal.cdf(z,0,1,1,0),ae=2*r.normal.cdf(z,f,1,1,0),un=yn*.5-ae*.5;un>=i.exp(m/I)&&(un=x[D-1]*i.exp(-(.5*j))*i.pow(un,I),W+=un)}W*=2*L*t/i.sqrt(2*i.PI),R+=W,$=q,q+=A}return E+=R,E<=i.exp(m/e)?0:(E=i.pow(E,e),E>=1?1:E)}function d(f,e,t){var u=.322232421088,a=.099348462606,m=-1,v=.588581570495,g=-.342242088547,w=.531103462366,y=-.204231210125,p=.10353775285,b=-453642210148e-16,_=.0038560700634,x=.8832,k=.2368,E=1.208,N=1.4142,$=120,A=.5-.5*f,q=i.sqrt(i.log(1/(A*A))),R=q+((((q*b+y)*q+g)*q+m)*q+u)/((((q*_+p)*q+w)*q+v)*q+a);t<$&&(R+=(R*R*R+R)/t/4);var I=x-k*R;return t<$&&(I+=-1.214/t+E*R/t),R*(I*i.log(e-1)+N)}r.extend(r.tukey,{cdf:function(e,t,u){var a=1,m=t,v=16,g=8,w=-30,y=1e-14,p=100,b=800,_=5e3,x=25e3,k=1,E=.5,N=.25,$=.125,A=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],q=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(e<=0)return 0;if(u<2||a<1||m<2)return NaN;if(!Number.isFinite(e))return 1;if(u>x)return h(e,a,m);var R=u*.5,I=R*i.log(u)-u*i.log(2)-r.gammaln(R),V=R-1,W=u*.25,P;u<=p?P=k:u<=b?P=E:u<=_?P=N:P=$,I+=i.log(P);for(var L=0,T=1;T<=50;T++){for(var D=0,U=(2*T-1)*P,M=1;M<=v;M++){var z,j;g<M?(z=M-g-1,j=I+V*i.log(U+A[z]*P)-(A[z]*P+U)*W):(z=M-1,j=I+V*i.log(U-A[z]*P)+(A[z]*P-U)*W);var yn;if(j>=w){g<M?yn=e*i.sqrt((A[z]*P+U)*.5):yn=e*i.sqrt((-(A[z]*P)+U)*.5);var ae=h(yn,a,m),un=ae*q[z]*i.exp(j);D+=un}}if(T*P>=1&&D<=y)break;L+=D}if(D>y)throw new Error("tukey.cdf failed to converge");return L>1&&(L=1),L},inv:function(f,e,t){var u=1,a=e,m=1e-4,v=50;if(t<2||u<1||a<2)return NaN;if(f<0||f>1)return NaN;if(f===0)return 0;if(f===1)return 1/0;var g=d(f,a,t),w=r.tukey.cdf(g,e,t)-f,y;w>0?y=i.max(0,g-1):y=g+1;for(var p=r.tukey.cdf(y,e,t)-f,b,_=1;_<v;_++){b=y-p*(y-g)/(p-w),w=p,g=y,b<0&&(b=0,p=-f),p=r.tukey.cdf(b,e,t)-f,y=b;var x=i.abs(y-g);if(x<m)return b}throw new Error("tukey.inv failed to converge")}})}(s,Math),function(r,i){var c=Array.prototype.push,l=r.utils.isArray;function h(d){return l(d)||d instanceof r}r.extend({add:function(f,e){return h(e)?(h(e[0])||(e=[e]),r.map(f,function(t,u,a){return t+e[u][a]})):r.map(f,function(t){return t+e})},subtract:function(f,e){return h(e)?(h(e[0])||(e=[e]),r.map(f,function(t,u,a){return t-e[u][a]||0})):r.map(f,function(t){return t-e})},divide:function(f,e){return h(e)?(h(e[0])||(e=[e]),r.multiply(f,r.inv(e))):r.map(f,function(t){return t/e})},multiply:function(f,e){var t,u,a,m,v,g,w,y;if(f.length===void 0&&e.length===void 0)return f*e;if(v=f.length,g=f[0].length,w=r.zeros(v,a=h(e)?e[0].length:g),y=0,h(e)){for(;y<a;y++)for(t=0;t<v;t++){for(m=0,u=0;u<g;u++)m+=f[t][u]*e[u][y];w[t][y]=m}return v===1&&y===1?w[0][0]:w}return r.map(f,function(p){return p*e})},outer:function(f,e){return r.multiply(f.map(function(t){return[t]}),[e])},dot:function(f,e){h(f[0])||(f=[f]),h(e[0])||(e=[e]);for(var t=f[0].length===1&&f.length!==1?r.transpose(f):f,u=e[0].length===1&&e.length!==1?r.transpose(e):e,a=[],m=0,v=t.length,g=t[0].length,w,y;m<v;m++){for(a[m]=[],w=0,y=0;y<g;y++)w+=t[m][y]*u[m][y];a[m]=w}return a.length===1?a[0]:a},pow:function(f,e){return r.map(f,function(t){return i.pow(t,e)})},exp:function(f){return r.map(f,function(e){return i.exp(e)})},log:function(f){return r.map(f,function(e){return i.log(e)})},abs:function(f){return r.map(f,function(e){return i.abs(e)})},norm:function(f,e){var t=0,u=0;for(isNaN(e)&&(e=2),h(f[0])&&(f=f[0]);u<f.length;u++)t+=i.pow(i.abs(f[u]),e);return i.pow(t,1/e)},angle:function(f,e){return i.acos(r.dot(f,e)/(r.norm(f)*r.norm(e)))},aug:function(f,e){var t=[],u;for(u=0;u<f.length;u++)t.push(f[u].slice());for(u=0;u<t.length;u++)c.apply(t[u],e[u]);return t},inv:function(f){for(var e=f.length,t=f[0].length,u=r.identity(e,t),a=r.gauss_jordan(f,u),m=[],v=0,g;v<e;v++)for(m[v]=[],g=t;g<a[0].length;g++)m[v][g-t]=a[v][g];return m},det:function d(f){if(f.length===2)return f[0][0]*f[1][1]-f[0][1]*f[1][0];for(var e=0,t=0;t<f.length;t++){for(var u=[],a=1;a<f.length;a++){u[a-1]=[];for(var m=0;m<f.length;m++)m<t?u[a-1][m]=f[a][m]:m>t&&(u[a-1][m-1]=f[a][m])}var v=t%2?-1:1;e+=d(u)*f[0][t]*v}return e},gauss_elimination:function(f,e){var t=0,u=0,a=f.length,m=f[0].length,v=1,g=0,w=[],y,p,b,_;for(f=r.aug(f,e),y=f[0].length,t=0;t<a;t++){for(p=f[t][t],u=t,_=t+1;_<m;_++)p<i.abs(f[_][t])&&(p=f[_][t],u=_);if(u!=t)for(_=0;_<y;_++)b=f[t][_],f[t][_]=f[u][_],f[u][_]=b;for(u=t+1;u<a;u++)for(v=f[u][t]/f[t][t],_=t;_<y;_++)f[u][_]=f[u][_]-v*f[t][_]}for(t=a-1;t>=0;t--){for(g=0,u=t+1;u<=a-1;u++)g=g+w[u]*f[t][u];w[t]=(f[t][y-1]-g)/f[t][t]}return w},gauss_jordan:function(f,e){var t=r.aug(f,e),u=t.length,a=t[0].length,m=0,v,g,w;for(g=0;g<u;g++){var y=g;for(w=g+1;w<u;w++)i.abs(t[w][g])>i.abs(t[y][g])&&(y=w);var p=t[g];for(t[g]=t[y],t[y]=p,w=g+1;w<u;w++)for(m=t[w][g]/t[g][g],v=g;v<a;v++)t[w][v]-=t[g][v]*m}for(g=u-1;g>=0;g--){for(m=t[g][g],w=0;w<g;w++)for(v=a-1;v>g-1;v--)t[w][v]-=t[g][v]*t[w][g]/m;for(t[g][g]/=m,v=u;v<a;v++)t[g][v]/=m}return t},triaUpSolve:function(f,e){var t=f[0].length,u=r.zeros(1,t)[0],a,m=!1;return e[0].length!=null&&(e=e.map(function(v){return v[0]}),m=!0),r.arange(t-1,-1,-1).forEach(function(v){a=r.arange(v+1,t).map(function(g){return u[g]*f[v][g]}),u[v]=(e[v]-r.sum(a))/f[v][v]}),m?u.map(function(v){return[v]}):u},triaLowSolve:function(f,e){var t=f[0].length,u=r.zeros(1,t)[0],a,m=!1;return e[0].length!=null&&(e=e.map(function(v){return v[0]}),m=!0),r.arange(t).forEach(function(v){a=r.arange(v).map(function(g){return f[v][g]*u[g]}),u[v]=(e[v]-r.sum(a))/f[v][v]}),m?u.map(function(v){return[v]}):u},lu:function(f){var e=f.length,t=r.identity(e),u=r.zeros(f.length,f[0].length),a;return r.arange(e).forEach(function(m){u[0][m]=f[0][m]}),r.arange(1,e).forEach(function(m){r.arange(m).forEach(function(v){a=r.arange(v).map(function(g){return t[m][g]*u[g][v]}),t[m][v]=(f[m][v]-r.sum(a))/u[v][v]}),r.arange(m,e).forEach(function(v){a=r.arange(m).map(function(g){return t[m][g]*u[g][v]}),u[m][v]=f[a.length][v]-r.sum(a)})}),[t,u]},cholesky:function(f){var e=f.length,t=r.zeros(f.length,f[0].length),u;return r.arange(e).forEach(function(a){u=r.arange(a).map(function(m){return i.pow(t[a][m],2)}),t[a][a]=i.sqrt(f[a][a]-r.sum(u)),r.arange(a+1,e).forEach(function(m){u=r.arange(a).map(function(v){return t[a][v]*t[m][v]}),t[m][a]=(f[a][m]-r.sum(u))/t[a][a]})}),t},gauss_jacobi:function(f,e,t,u){for(var a=0,m=0,v=f.length,g=[],w=[],y=[],p,b,_,x;a<v;a++)for(g[a]=[],w[a]=[],y[a]=[],m=0;m<v;m++)a>m?(g[a][m]=f[a][m],w[a][m]=y[a][m]=0):a<m?(w[a][m]=f[a][m],g[a][m]=y[a][m]=0):(y[a][m]=f[a][m],g[a][m]=w[a][m]=0);for(_=r.multiply(r.multiply(r.inv(y),r.add(g,w)),-1),b=r.multiply(r.inv(y),e),p=t,x=r.add(r.multiply(_,t),b),a=2;i.abs(r.norm(r.subtract(x,p)))>u;)p=x,x=r.add(r.multiply(_,p),b),a++;return x},gauss_seidel:function(f,e,t,u){for(var a=0,m=f.length,v=[],g=[],w=[],y,p,b,_,x;a<m;a++)for(v[a]=[],g[a]=[],w[a]=[],y=0;y<m;y++)a>y?(v[a][y]=f[a][y],g[a][y]=w[a][y]=0):a<y?(g[a][y]=f[a][y],v[a][y]=w[a][y]=0):(w[a][y]=f[a][y],v[a][y]=g[a][y]=0);for(_=r.multiply(r.multiply(r.inv(r.add(w,v)),g),-1),b=r.multiply(r.inv(r.add(w,v)),e),p=t,x=r.add(r.multiply(_,t),b),a=2;i.abs(r.norm(r.subtract(x,p)))>u;)p=x,x=r.add(r.multiply(_,p),b),a=a+1;return x},SOR:function(f,e,t,u,a){for(var m=0,v=f.length,g=[],w=[],y=[],p,b,_,x,k;m<v;m++)for(g[m]=[],w[m]=[],y[m]=[],p=0;p<v;p++)m>p?(g[m][p]=f[m][p],w[m][p]=y[m][p]=0):m<p?(w[m][p]=f[m][p],g[m][p]=y[m][p]=0):(y[m][p]=f[m][p],g[m][p]=w[m][p]=0);for(x=r.multiply(r.inv(r.add(y,r.multiply(g,a))),r.subtract(r.multiply(y,1-a),r.multiply(w,a))),_=r.multiply(r.multiply(r.inv(r.add(y,r.multiply(g,a))),e),a),b=t,k=r.add(r.multiply(x,t),_),m=2;i.abs(r.norm(r.subtract(k,b)))>u;)b=k,k=r.add(r.multiply(x,b),_),m++;return k},householder:function(f){for(var e=f.length,t=f[0].length,u=0,a=[],m=[],v,g,w,y,p;u<e-1;u++){for(v=0,y=u+1;y<t;y++)v+=f[y][u]*f[y][u];for(p=f[u+1][u]>0?-1:1,v=p*i.sqrt(v),g=i.sqrt((v*v-f[u+1][u]*v)/2),a=r.zeros(e,1),a[u+1][0]=(f[u+1][u]-v)/(2*g),w=u+2;w<e;w++)a[w][0]=f[w][u]/(2*g);m=r.subtract(r.identity(e,t),r.multiply(r.multiply(a,r.transpose(a)),2)),f=r.multiply(m,r.multiply(f,m))}return f},QR:function(){var d=r.sum,f=r.arange;function e(t){var u=t.length,a=t[0].length,m=r.zeros(a,a);t=r.copy(t);var v,g,w;for(g=0;g<a;g++){for(m[g][g]=i.sqrt(d(f(u).map(function(y){return t[y][g]*t[y][g]}))),v=0;v<u;v++)t[v][g]=t[v][g]/m[g][g];for(w=g+1;w<a;w++)for(m[g][w]=d(f(u).map(function(y){return t[y][g]*t[y][w]})),v=0;v<u;v++)t[v][w]=t[v][w]-t[v][g]*m[g][w]}return[t,m]}return e}(),lstsq:function(){function d(e){e=r.copy(e);var t=e.length,u=r.identity(t);return r.arange(t-1,-1,-1).forEach(function(a){r.sliceAssign(u,{row:a},r.divide(r.slice(u,{row:a}),e[a][a])),r.sliceAssign(e,{row:a},r.divide(r.slice(e,{row:a}),e[a][a])),r.arange(a).forEach(function(m){var v=r.multiply(e[m][a],-1),g=r.slice(e,{row:m}),w=r.multiply(r.slice(e,{row:a}),v);r.sliceAssign(e,{row:m},r.add(g,w));var y=r.slice(u,{row:m}),p=r.multiply(r.slice(u,{row:a}),v);r.sliceAssign(u,{row:m},r.add(y,p))})}),u}function f(e,t){var u=!1;t[0].length===void 0&&(t=t.map(function(x){return[x]}),u=!0);var a=r.QR(e),m=a[0],v=a[1],g=e[0].length,w=r.slice(m,{col:{end:g}}),y=r.slice(v,{row:{end:g}}),p=d(y),b=r.transpose(w);b[0].length===void 0&&(b=[b]);var _=r.multiply(r.multiply(p,b),t);return _.length===void 0&&(_=[[_]]),u?_.map(function(x){return x[0]}):_}return f}(),jacobi:function(f){for(var e=1,t=f.length,u=r.identity(t,t),a=[],m,v,g,w,y,p,b,_;e===1;){for(p=f[0][1],w=0,y=1,v=0;v<t;v++)for(g=0;g<t;g++)v!=g&&p<i.abs(f[v][g])&&(p=i.abs(f[v][g]),w=v,y=g);for(f[w][w]===f[y][y]?b=f[w][y]>0?i.PI/4:-i.PI/4:b=i.atan(2*f[w][y]/(f[w][w]-f[y][y]))/2,_=r.identity(t,t),_[w][w]=i.cos(b),_[w][y]=-i.sin(b),_[y][w]=i.sin(b),_[y][y]=i.cos(b),u=r.multiply(u,_),m=r.multiply(r.multiply(r.inv(_),f),_),f=m,e=0,v=1;v<t;v++)for(g=1;g<t;g++)v!=g&&i.abs(f[v][g])>.001&&(e=1)}for(v=0;v<t;v++)a.push(f[v][v]);return[u,a]},rungekutta:function(f,e,t,u,a,m){var v,g,w,y,p;if(m===2)for(;u<=t;)v=e*f(u,a),g=e*f(u+e,a+v),w=a+(v+g)/2,a=w,u=u+e;if(m===4)for(;u<=t;)v=e*f(u,a),g=e*f(u+e/2,a+v/2),y=e*f(u+e/2,a+g/2),p=e*f(u+e,a+y),w=a+(v+2*g+2*y+p)/6,a=w,u=u+e;return a},romberg:function(f,e,t,u){for(var a=0,m=(t-e)/2,v=[],g=[],w=[],y,p,b,_,x;a<u/2;){for(x=f(e),b=e,_=0;b<=t;b=b+m,_++)v[_]=b;for(y=v.length,b=1;b<y-1;b++)x+=(b%2!==0?4:2)*f(v[b]);x=m/3*(x+f(t)),w[a]=x,m/=2,a++}for(p=w.length,y=1;p!==1;){for(b=0;b<p-1;b++)g[b]=(i.pow(4,y)*w[b+1]-w[b])/(i.pow(4,y)-1);p=g.length,w=g,g=[],y++}return w},richardson:function(f,e,t,u){function a(k,E){for(var N=0,$=k.length,A;N<$;N++)k[N]===E&&(A=N);return A}for(var m=i.abs(t-f[a(f,t)+1]),v=0,g=[],w=[],y,p,b,_,x;u>=m;)y=a(f,t+u),p=a(f,t),g[v]=(e[y]-2*e[p]+e[2*p-y])/(u*u),u/=2,v++;for(_=g.length,b=1;_!=1;){for(x=0;x<_-1;x++)w[x]=(i.pow(4,b)*g[x+1]-g[x])/(i.pow(4,b)-1);_=w.length,g=w,w=[],b++}return g},simpson:function(f,e,t,u){for(var a=(t-e)/u,m=f(e),v=[],g=e,w=0,y=1,p;g<=t;g=g+a,w++)v[w]=g;for(p=v.length;y<p-1;y++)m+=(y%2!==0?4:2)*f(v[y]);return a/3*(m+f(t))},hermite:function(f,e,t,u){for(var a=f.length,m=0,v=0,g=[],w=[],y=[],p=[],b;v<a;v++){for(g[v]=1,b=0;b<a;b++)v!=b&&(g[v]*=(u-f[b])/(f[v]-f[b]));for(w[v]=0,b=0;b<a;b++)v!=b&&(w[v]+=1/(f[v]-f[b]));y[v]=(1-2*(u-f[v])*w[v])*(g[v]*g[v]),p[v]=(u-f[v])*(g[v]*g[v]),m+=y[v]*e[v]+p[v]*t[v]}return m},lagrange:function(f,e,t){for(var u=0,a=0,m,v,g=f.length;a<g;a++){for(v=e[a],m=0;m<g;m++)a!=m&&(v*=(t-f[m])/(f[a]-f[m]));u+=v}return u},cubic_spline:function(f,e,t){for(var u=f.length,a=0,m,v=[],g=[],w=[],y=[],p=[],b=[],_=[];a<u-1;a++)p[a]=f[a+1]-f[a];for(w[0]=0,a=1;a<u-1;a++)w[a]=3/p[a]*(e[a+1]-e[a])-3/p[a-1]*(e[a]-e[a-1]);for(a=1;a<u-1;a++)v[a]=[],g[a]=[],v[a][a-1]=p[a-1],v[a][a]=2*(p[a-1]+p[a]),v[a][a+1]=p[a],g[a][0]=w[a];for(y=r.multiply(r.inv(v),g),m=0;m<u-1;m++)b[m]=(e[m+1]-e[m])/p[m]-p[m]*(y[m+1][0]+2*y[m][0])/3,_[m]=(y[m+1][0]-y[m][0])/(3*p[m]);for(m=0;m<u&&!(f[m]>t);m++);return m-=1,e[m]+(t-f[m])*b[m]+r.sq(t-f[m])*y[m]+(t-f[m])*r.sq(t-f[m])*_[m]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(f){var e=f.length,t=f[0].length,u=0,a,m,v=[],g=[],w=[],y=[],p=[],b=[],_=[],x=[],k=[],E=[];for(u=0;u<e;u++)v[u]=r.sum(f[u])/t;for(u=0;u<t;u++)for(_[u]=[],a=0;a<e;a++)_[u][a]=f[a][u]-v[a];for(_=r.transpose(_),u=0;u<e;u++)for(x[u]=[],a=0;a<e;a++)x[u][a]=r.dot([_[u]],[_[a]])/(t-1);for(w=r.jacobi(x),k=w[0],g=w[1],E=r.transpose(k),u=0;u<g.length;u++)for(a=u;a<g.length;a++)g[u]<g[a]&&(m=g[u],g[u]=g[a],g[a]=m,y=E[u],E[u]=E[a],E[a]=y);for(b=r.transpose(_),u=0;u<e;u++)for(p[u]=[],a=0;a<b.length;a++)p[u][a]=r.dot([E[u]],[b[a]]);return[f,g,E,p]}}),function(d){for(var f=0;f<d.length;f++)(function(e){r.fn[e]=function(t,u){var a=this;return u?(setTimeout(function(){u.call(a,r.fn[e].call(a,t))},15),this):typeof r[e](this,t)=="number"?r[e](this,t):r(r[e](this,t))}})(d[f])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(s,Math),function(r,i){var c=[].slice,l=r.utils.isNumber,h=r.utils.isArray;r.extend({zscore:function(){var e=c.call(arguments);return l(e[1])?(e[0]-e[1])/e[2]:(e[0]-r.mean(e[1]))/r.stdev(e[1],e[2])},ztest:function(){var e=c.call(arguments),t;return h(e[1])?(t=r.zscore(e[0],e[1],e[3]),e[2]===1?r.normal.cdf(-i.abs(t),0,1):r.normal.cdf(-i.abs(t),0,1)*2):e.length>2?(t=r.zscore(e[0],e[1],e[2]),e[3]===1?r.normal.cdf(-i.abs(t),0,1):r.normal.cdf(-i.abs(t),0,1)*2):(t=e[0],e[1]===1?r.normal.cdf(-i.abs(t),0,1):r.normal.cdf(-i.abs(t),0,1)*2)}}),r.extend(r.fn,{zscore:function(e,t){return(e-this.mean())/this.stdev(t)},ztest:function(e,t,u){var a=i.abs(this.zscore(e,u));return t===1?r.normal.cdf(-a,0,1):r.normal.cdf(-a,0,1)*2}}),r.extend({tscore:function(){var e=c.call(arguments);return e.length===4?(e[0]-e[1])/(e[2]/i.sqrt(e[3])):(e[0]-r.mean(e[1]))/(r.stdev(e[1],!0)/i.sqrt(e[1].length))},ttest:function(){var e=c.call(arguments),t;return e.length===5?(t=i.abs(r.tscore(e[0],e[1],e[2],e[3])),e[4]===1?r.studentt.cdf(-t,e[3]-1):r.studentt.cdf(-t,e[3]-1)*2):l(e[1])?(t=i.abs(e[0]),e[2]==1?r.studentt.cdf(-t,e[1]-1):r.studentt.cdf(-t,e[1]-1)*2):(t=i.abs(r.tscore(e[0],e[1])),e[2]==1?r.studentt.cdf(-t,e[1].length-1):r.studentt.cdf(-t,e[1].length-1)*2)}}),r.extend(r.fn,{tscore:function(e){return(e-this.mean())/(this.stdev(!0)/i.sqrt(this.cols()))},ttest:function(e,t){return t===1?1-r.studentt.cdf(i.abs(this.tscore(e)),this.cols()-1):r.studentt.cdf(-i.abs(this.tscore(e)),this.cols()-1)*2}}),r.extend({anovafscore:function(){var e=c.call(arguments),t,u,a,m,v,g,w,y;if(e.length===1){for(v=new Array(e[0].length),w=0;w<e[0].length;w++)v[w]=e[0][w];e=v}for(u=new Array,w=0;w<e.length;w++)u=u.concat(e[w]);for(a=r.mean(u),t=0,w=0;w<e.length;w++)t=t+e[w].length*i.pow(r.mean(e[w])-a,2);for(t/=e.length-1,g=0,w=0;w<e.length;w++)for(m=r.mean(e[w]),y=0;y<e[w].length;y++)g+=i.pow(e[w][y]-m,2);return g/=u.length-e.length,t/g},anovaftest:function(){var e=c.call(arguments),t,u,a,m;if(l(e[0]))return 1-r.centralF.cdf(e[0],e[1],e[2]);var v=r.anovafscore(e);for(t=e.length-1,a=0,m=0;m<e.length;m++)a=a+e[m].length;return u=a-t-1,1-r.centralF.cdf(v,t,u)},ftest:function(e,t,u){return 1-r.centralF.cdf(e,t,u)}}),r.extend(r.fn,{anovafscore:function(){return r.anovafscore(this.toArray())},anovaftes:function(){var e=0,t;for(t=0;t<this.length;t++)e=e+this[t].length;return r.ftest(this.anovafscore(),this.length-1,e-this.length)}}),r.extend({qscore:function(){var e=c.call(arguments),t,u,a,m,v;return l(e[0])?(t=e[0],u=e[1],a=e[2],m=e[3],v=e[4]):(t=r.mean(e[0]),u=r.mean(e[1]),a=e[0].length,m=e[1].length,v=e[2]),i.abs(t-u)/(v*i.sqrt((1/a+1/m)/2))},qtest:function(){var e=c.call(arguments),t;e.length===3?(t=e[0],e=e.slice(1)):e.length===7?(t=r.qscore(e[0],e[1],e[2],e[3],e[4]),e=e.slice(5)):(t=r.qscore(e[0],e[1],e[2]),e=e.slice(3));var u=e[0],a=e[1];return 1-r.tukey.cdf(t,a,u-a)},tukeyhsd:function(e){for(var t=r.pooledstdev(e),u=e.map(function(y){return r.mean(y)}),a=e.reduce(function(y,p){return y+p.length},0),m=[],v=0;v<e.length;++v)for(var g=v+1;g<e.length;++g){var w=r.qtest(u[v],u[g],e[v].length,e[g].length,t,a,e.length);m.push([[v,g],w])}return m}}),r.extend({normalci:function(){var e=c.call(arguments),t=new Array(2),u;return e.length===4?u=i.abs(r.normal.inv(e[1]/2,0,1)*e[2]/i.sqrt(e[3])):u=i.abs(r.normal.inv(e[1]/2,0,1)*r.stdev(e[2])/i.sqrt(e[2].length)),t[0]=e[0]-u,t[1]=e[0]+u,t},tci:function(){var e=c.call(arguments),t=new Array(2),u;return e.length===4?u=i.abs(r.studentt.inv(e[1]/2,e[3]-1)*e[2]/i.sqrt(e[3])):u=i.abs(r.studentt.inv(e[1]/2,e[2].length-1)*r.stdev(e[2],!0)/i.sqrt(e[2].length)),t[0]=e[0]-u,t[1]=e[0]+u,t},significant:function(e,t){return e<t}}),r.extend(r.fn,{normalci:function(e,t){return r.normalci(e,t,this.toArray())},tci:function(e,t){return r.tci(e,t,this.toArray())}});function d(f,e,t,u){if(f>1||t>1||f<=0||t<=0)throw new Error("Proportions should be greater than 0 and less than 1");var a=(f*e+t*u)/(e+u),m=i.sqrt(a*(1-a)*(1/e+1/u));return(f-t)/m}r.extend(r.fn,{oneSidedDifferenceOfProportions:function(e,t,u,a){var m=d(e,t,u,a);return r.ztest(m,1)},twoSidedDifferenceOfProportions:function(e,t,u,a){var m=d(e,t,u,a);return r.ztest(m,2)}})}(s,Math),s.models=function(){function r(d){var f=d[0].length,e=s.arange(f).map(function(t){var u=s.arange(f).filter(function(a){return a!==t});return i(s.col(d,t).map(function(a){return a[0]}),s.col(d,u))});return e}function i(d,f){var e=d.length,t=f[0].length-1,u=e-t-1,a=s.lstsq(f,d),m=s.multiply(f,a.map(function(_){return[_]})).map(function(_){return _[0]}),v=s.subtract(d,m),g=s.mean(d),w=s.sum(m.map(function(_){return Math.pow(_-g,2)})),y=s.sum(d.map(function(_,x){return Math.pow(_-m[x],2)})),p=w+y,b=w/p;return{exog:f,endog:d,nobs:e,df_model:t,df_resid:u,coef:a,predict:m,resid:v,ybar:g,SST:p,SSE:w,SSR:y,R2:b}}function c(d){var f=r(d.exog),e=Math.sqrt(d.SSR/d.df_resid),t=f.map(function(g){var w=g.SST,y=g.R2;return e/Math.sqrt(w*(1-y))}),u=d.coef.map(function(g,w){return(g-0)/t[w]}),a=u.map(function(g){var w=s.studentt.cdf(g,d.df_resid);return(w>.5?1-w:w)*2}),m=s.studentt.inv(.975,d.df_resid),v=d.coef.map(function(g,w){var y=m*t[w];return[g-y,g+y]});return{se:t,t:u,p:a,sigmaHat:e,interval95:v}}function l(d){var f=d.R2/d.df_model/((1-d.R2)/d.df_resid),e=function(u,a,m){return s.beta.cdf(u/(m/a+u),a/2,m/2)},t=1-e(f,d.df_model,d.df_resid);return{F_statistic:f,pvalue:t}}function h(d,f){var e=i(d,f),t=c(e),u=l(e),a=1-(1-e.R2)*((e.nobs-1)/e.df_resid);return e.t=t,e.f=u,e.adjust_R2=a,e}return{ols:h}}(),s.extend({buildxmatrix:function(){for(var i=new Array(arguments.length),c=0;c<arguments.length;c++){var l=[1];i[c]=l.concat(arguments[c])}return s(i)},builddxmatrix:function(){for(var i=new Array(arguments[0].length),c=0;c<arguments[0].length;c++){var l=[1];i[c]=l.concat(arguments[0][c])}return s(i)},buildjxmatrix:function(i){for(var c=new Array(i.length),l=0;l<i.length;l++)c[l]=i[l];return s.builddxmatrix(c)},buildymatrix:function(i){return s(i).transpose()},buildjymatrix:function(i){return i.transpose()},matrixmult:function(i,c){var l,h,d,f,e;if(i.cols()==c.rows()){if(c.rows()>1){for(f=[],l=0;l<i.rows();l++)for(f[l]=[],h=0;h<c.cols();h++){for(e=0,d=0;d<i.cols();d++)e+=i.toArray()[l][d]*c.toArray()[d][h];f[l][h]=e}return s(f)}for(f=[],l=0;l<i.rows();l++)for(f[l]=[],h=0;h<c.cols();h++){for(e=0,d=0;d<i.cols();d++)e+=i.toArray()[l][d]*c.toArray()[h];f[l][h]=e}return s(f)}},regress:function(i,c){var l=s.xtranspxinv(i),h=i.transpose(),d=s.matrixmult(s(l),h);return s.matrixmult(d,c)},regresst:function(i,c,l){var h=s.regress(i,c),d={};d.anova={};var f=s.jMatYBar(i,h);d.yBar=f;var e=c.mean();d.anova.residuals=s.residuals(c,f),d.anova.ssr=s.ssr(f,e),d.anova.msr=d.anova.ssr/(i[0].length-1),d.anova.sse=s.sse(c,f),d.anova.mse=d.anova.sse/(c.length-(i[0].length-1)-1),d.anova.sst=s.sst(c,e),d.anova.mst=d.anova.sst/(c.length-1),d.anova.r2=1-d.anova.sse/d.anova.sst,d.anova.r2<0&&(d.anova.r2=0),d.anova.fratio=d.anova.msr/d.anova.mse,d.anova.pvalue=s.anovaftest(d.anova.fratio,i[0].length-1,c.length-(i[0].length-1)-1),d.anova.rmse=Math.sqrt(d.anova.mse),d.anova.r2adj=1-d.anova.mse/d.anova.mst,d.anova.r2adj<0&&(d.anova.r2adj=0),d.stats=new Array(i[0].length);for(var t=s.xtranspxinv(i),u,a,m,v=0;v<h.length;v++)u=Math.sqrt(d.anova.mse*Math.abs(t[v][v])),a=Math.abs(h[v]/u),m=s.ttest(a,c.length-i[0].length-1,l),d.stats[v]=[h[v],u,a,m];return d.regress=h,d},xtranspx:function(i){return s.matrixmult(i.transpose(),i)},xtranspxinv:function(i){var c=s.matrixmult(i.transpose(),i),l=s.inv(c);return l},jMatYBar:function(i,c){var l=s.matrixmult(i,c);return new s(l)},residuals:function(i,c){return s.matrixsubtract(i,c)},ssr:function(i,c){for(var l=0,h=0;h<i.length;h++)l+=Math.pow(i[h]-c,2);return l},sse:function(i,c){for(var l=0,h=0;h<i.length;h++)l+=Math.pow(i[h]-c[h],2);return l},sst:function(i,c){for(var l=0,h=0;h<i.length;h++)l+=Math.pow(i[h]-c,2);return l},matrixsubtract:function(i,c){for(var l=new Array(i.length),h=0;h<i.length;h++){l[h]=new Array(i[h].length);for(var d=0;d<i[h].length;d++)l[h][d]=i[h][d]-c[h][d]}return s(l)}}),s.jStat=s,s})}(Bn)),Bn.exports}var O=Pu();const Tu=Math.log(1e3),zu=.5,Cu=1,jn={populationSize:6400,geneEnvWeight:.5,envNoiseStd:.1,financeWeight:.7,financeNoise:.1,homophily:{gene:0,env:0}};function Fu(n){const o=[];for(let s=0;s<n.populationSize;s++){const r=[O.normal.sample(0,1),O.normal.sample(0,1)],i=O.normal.sample(0,1),c={id:s,alleles:r,meanAllele:(r[0]+r[1])/2,parentWealth:1e5,env:i,rawenv:i,educationScore:O.normal.sample(0,1),parents:null,wealth:0};c.wealth=Zr(c,n),o.push(c)}return o}function Lu(n,o){return o.geneEnvWeight*n.meanAllele+(1-o.geneEnvWeight)*n.env}function Ou(n,o){const s=n.map(h=>h.parentWealth),r=O.rank(s),c=s.length+1,l=1/c;n.forEach((h,d)=>{const f=Math.max(r[d]/c,l);h.rawenv=O.normal.inv(f,0,1),h.env=h.rawenv+O.normal.sample(0,o.envNoiseStd)})}function Zr(n,o){function s(c,l){const h=l===0?0:O.normal.sample(0,l),d=Math.exp(Tu+zu*c+h),f=O.normal.cdf(c,0,1),e=Math.min(Math.max(1-f,Number.EPSILON),1),t=Math.pow(e,-1/Cu);return d*t}const r=s(n.educationScore,o.financeNoise);return o.financeWeight*r+(1-o.financeWeight)*(s(n.rawenv,0)+n.parentWealth*O.beta.sample(.01,1))}function Wu(n,o){const s=n.length;if(n.length<2)throw new Error(`selectMatingPool: need at least two agents, got ${n.length}`);const{homophily:r,kd:i}=o,c=(i==null?void 0:i.kNeighbors)??10,l=125,h=r.gene===1?l:r.gene/(1-r.gene),d=r.env===1?l:r.env/(1-r.env),f=n.map((w,y)=>({meanAllele:w.meanAllele,env:w.env,idx:y})),e=(w,y)=>h*Math.abs(w.meanAllele-y.meanAllele)+d*Math.abs(w.env-y.env),t=new Ru.kdTree(f,e,["meanAllele","env"]);function u(w){const y=w.slice();for(let p=y.length-1;p>0;p--){const b=Math.floor(Math.random()*(p+1));[y[p],y[b]]=[y[b],y[p]]}return y}const a=Math.floor(s/2),m=u(f).slice(0,a),v=[],g=(r.gene+r.env)/2;for(const w of m){let y=-1;if(Math.random()>g)y=Math.floor(Math.random()*s);else{let p=t.nearest(w,c+1).filter(([I])=>I.idx!==w.idx);if(p.length===0)throw new Error(`selectMatingPool: no available mates for agent index ${w.idx}`);const b=p.map(([,I])=>I),_=Math.min(...b),x=b.map(I=>I-_),k=700,N=x.map(I=>Math.min(I,k)).map(I=>Math.exp(-I)),$=N.reduce((I,V)=>I+V,0);let A=Math.random()*$,q=0;for(;A>N[q];)A-=N[q++];y=p[q][0].idx}v.push({a:n[w.idx],b:n[y]})}return v}function Hu(n,o,s){const r=n.a.wealth+n.b.wealth,i=[];for(let c=0;c<2;c++){const l={id:s+c,alleles:[Math.random()<.01?O.normal.sample(0,1):n.a.alleles[Math.floor(Math.random()*2)],Math.random()<.01?O.normal.sample(0,1):n.b.alleles[Math.floor(Math.random()*2)]],parentWealth:r,educationScore:0,parents:[{id:n.a.id,alleles:n.a.alleles,meanAllele:n.a.meanAllele,parentWealth:n.a.parentWealth,env:n.a.env,rawenv:n.a.rawenv,educationScore:n.a.educationScore,wealth:n.a.wealth,parents:null},{id:n.b.id,alleles:n.b.alleles,meanAllele:n.b.meanAllele,parentWealth:n.b.parentWealth,env:n.b.env,rawenv:n.b.rawenv,educationScore:n.b.educationScore,wealth:n.b.wealth,parents:null}]};i.push(l)}return i}function Gu(n,o){const s=Wu(n,o),r=[];let i=0;return s.forEach(c=>{Hu(c,o,i).forEach(h=>{r.push(h),i++})}),Ou(r,o),r.forEach(c=>{const[l,h]=c.alleles;c.meanAllele=(l+h)/2}),r.forEach(c=>{c.educationScore=Lu(c,o),c.wealth=Zr(c,o)}),r}function sr(n,o){let r=[...n].sort((i,c)=>-i.wealth+c.wealth).map(i=>i[o]);return["wealth","parentWealth"].includes(o)&&(r=r.map(i=>Math.log10(i+1))),r}function Bu(n,o,s,r,i,c=!1){const l=n.getContext("2d"),h=n.width/r,d=n.height/s;l.clearRect(0,0,n.width,n.height),o.forEach((f,e)=>{const t=Math.floor(e/r),u=e%r;l.fillStyle=i(f),l.fillRect(u*h,t*d,h,d)})}function Xr(n){const o=[...n].sort((l,h)=>l.wealth-h.wealth),s=o.length,r=pt(o,l=>l.wealth)||0;let i=0;const c=[[0,0]];return o.forEach((l,h)=>{i+=l.wealth,c.push([(h+1)/s,r>0?i/r:0])}),c}function Mr(n){if(n.length===0)return 0;const s=Xr(n.map(i=>({wealth:i})));let r=0;for(let i=1;i<s.length;i++){const[c,l]=s[i-1],[h,d]=s[i];r+=(l+d)/2*(h-c)}return 1-2*r}function Vu(n,o){const s=+n.attr("width"),r=+n.attr("height"),i={top:20,right:20,bottom:30,left:40},c=s-i.left-i.right,l=r-i.top-i.bottom;n.selectAll("*").remove();const h=Xr(o),d=fn().domain([0,1]).range([0,c]),f=fn().domain([0,1]).range([l,0]),e=n.append("g").attr("transform",`translate(${i.left},${i.top})`);e.append("line").attr("x1",d(0)).attr("y1",f(0)).attr("x2",d(1)).attr("y2",f(1)).attr("stroke","#999").attr("stroke-dasharray","4,4");const t=Jr().x(u=>d(u[0])).y(u=>f(u[1]));e.append("path").datum(h).attr("d",t).attr("fill","none").attr("stroke","tomato").attr("stroke-width",2),e.append("g").attr("transform",`translate(0,${l})`).call(Dn(d).ticks(5)),e.append("g").call(Ae(f).ticks(5))}function Du(n,o){const s=+n.attr("width"),r=+n.attr("height"),i={top:20,right:20,bottom:30,left:40},c=s-i.left-i.right,l=r-i.top-i.bottom;n.selectAll("*").remove();const h=fn().domain([0,Math.max(1,o.length-1)]).range([0,c]),d=fn().domain([0,1]).range([l,0]),f=n.append("g").attr("transform",`translate(${i.left},${i.top})`),e=Jr().x((t,u)=>h(u)).y(t=>d(t));f.append("path").datum(o).attr("d",e).attr("fill","none").attr("stroke","steelblue").attr("stroke-width",2),f.append("g").attr("transform",`translate(0,${l})`).call(Dn(h).ticks(5)),f.append("g").call(Ae(d).ticks(5))}function lr(n,o,s=20,r=!1){const i=+n.attr("width"),c=+n.attr("height"),l={top:20,right:20,bottom:75,left:40},h=i-l.left-l.right,d=c-l.top-l.bottom;n.selectAll("*").remove();const f=fn().domain(Nn(o)).nice().range([0,h]),e=mt().domain(f.domain()).thresholds(s)(o),t=fn().domain([0,We(e,a=>a.length)]).nice().range([d,0]),u=n.append("g").attr("transform",`translate(${l.left},${l.top})`);if(u.selectAll("rect").data(e).enter().append("rect").attr("x",a=>f(a.x0)+1).attr("y",a=>t(a.length)).attr("width",a=>Math.max(0,f(a.x1)-f(a.x0)-1)).attr("height",a=>d-t(a.length)).attr("fill","steelblue"),r){const a=vt(o),m=We(o),v=gt(1,15).filter(g=>g>a&&g<m);u.append("g").attr("transform",`translate(0,${d})`).call(Dn(f).tickValues(v).tickFormat(g=>Ce(",")(Math.pow(10,g)))),u.selectAll("text").attr("text-anchor","end").attr("transform","rotate(-45)").attr("dx","-0.8em").attr("dy","0.15em")}else u.append("g").attr("transform",`translate(0,${d})`).call(Dn(f).ticks(5));u.append("g").call(Ae(t).ticks(5))}const _n=[{id:"intro",title:"Overview",content:`
    <p>This interactive model shows how traits and resources flow from one generation to the next through four stages:</p>
    <ol>
      <li><strong>Parent Genes → Genes</strong></li>
      <li><strong>Parent Wealth → Environmental Endowment</strong></li>
      <li><strong>Genes + Environment → Education Level</strong></li>
      <li><strong>Education + Parent Wealth → Child Wealth</strong></li>
    </ol>
    <p>Adjust the sliders to explore how inheritance, environment, education, and chance combine to shape inequality over time.</p>
    <p id="intro-text">Each "pixel" below is one agent. Each agent has it's own genetic
    potential, environmental endowment, education success, and level of
    wealth. To produce each new generation, the agents will be sampled and
    mated to other agents (with some degree of assortative mating), and then
    the offspring will inherit a mix of their parents' traits, and their
    environment will be determined by their parents' wealth. There is some
    random noise you can add into this process too. See the parameters to
    the left, and the help text below for more information.
    </p>
    `},{id:"model",title:"Model Structure",content:`
      <ul>
        <li><strong>Initial population</strong>: most parameters are drawn directly from a Gaussian distribution. Agent properties then evolve with each generation from there.</li>
        <li><strong>Genes</strong>: each agent inherits one randomly chosen "education" gene from each parent, with occasional mutation.</li>
        <li><strong>Environment</strong>: determined by the sum of parents' wealth, with optional noise added in to account for chance.</li>
        <li><strong>Education</strong>: is a function of the agent's average gene value (they inherit 2 alleles), and the environment value, weighted by the gene-environment proportion slider.</li>
        <li><strong>Wealth</strong>: is a function of the agent's education success and parental wealth, weighted by the education-parental-wealth proportion slider.</li>
        <li><strong>Mating Logic</strong>: random or assortative by genes/environment controlled by homophily sliders.</li>
        <li><strong>Inter-generational wealth catastrophe</strong>: there is a small chance that some or all wealth will be lost between generations.</li>
      </ul>
    `},{id:"plots",title:"Plots",content:`
      <ul>
      <li><strong>Population Raster (center)</strong>: grid of agents colored by the selected attribute, always ordered by wealth.</li>
      <li><strong>Histogram</strong>: distribution of genes, environment, education, or wealth. Wealth is log transformed. </li>
      <li><strong>Lorenz Curve</strong>: cumulative share of agents vs. cumulative share of wealth. Perfect wealth equality is a diagonal line.</li>
      <li><strong>Gini Coefficient</strong>: summary statistic (0&ndash;1) of wealth inequality.</li>
      <li><strong>Time Series</strong>: tracks Gini across generations.</li>
      </ul>
    `},{id:"philosophy",title:"Philosophical Presets",content:`
      
    <ul>
      <li>
        <strong>Full Meritocracy</strong>
        <ul style="list-style:none; margin:0 0 0 1.5em; padding:0;">
          <li>Env 0% / 100% Gene → Education Success</li>
          <li>Parent wealth 0% / 100% Education → Agent's Wealth</li>
          <li style="font-style: italic;">We remove any influence of the environment, allowing individuals to realize their full potential through education. 
          And then we allow that education to be the full determinant of their ultimate wealth. 
          This is the meritocratic ideal: one rises or falls exactly in proportion to one's talents and abilities (including the ability to put in hard work).</li>
        </ul>
      </li>

      <li>
        <strong>Full Aristocracy</strong>
        <ul style="list-style:none; margin:0 0 0 1.5em; padding:0;">
          <li>Env --% / --% Gene → Education Success</li>
          <li>Parent wealth 100% / 0% Education → Agent's Wealth</li>
          <li style="font-style: italic;">Genetic or environmental contribution to education success is irrelevant. One's wealth and station is determined entirely by one's parents'</li>
        </ul>
      </li>

      <li>
        <strong>Full Equality...or is it?</strong>
        <ul style="list-style:none; margin:0 0 0 1.5em; padding:0;">
          <li>Env 100% / 0% Gene → Education Success</li>
          <li>Parent wealth 0% / 100% Education → Agent's Wealth</li>
          <li style="font-style: italic;">Education is determined entirely by the environment, and wealth is determined entirely by education. 
          Someone's egalitarian ideal: all individuals are given equal opportunity to succeed, regardless of their genetic or parental background. But when we start with unequal environments, can this work...?</li>
        </ul>
      </li>
      <li>
        <strong>Present-day Reality</strong>
        <ul style="list-style:none; margin:0 0 0 1.5em; padding:0;">
          <li>Env 50% / 50% Gene → Education Success</li>
          <li>Parent wealth 70% / 30% Education → Agent's Wealth</li>
          <li style="font-style: italic;">A somewhat realistic setting that reflects the current state of society, where both genetic and environmental factors contribute to education, and parental wealth plays a significant role in determining an agent's wealth.</li>
        </ul>
      </li>
      </ul>
    `},{id:"extensions",title:"Extensions & Ideas",content:`
      <ul>
        <li>Progressive Education Subsidies: reduce the effect of environment for the bottom decile, either for one-generation or permanently.</li>
        <li>Genetic Compensation Policy: technologies such as eye-glasses reduce or remove the effect of some genetic disadvantages&mdash;boost the genetic scores of the bottom decile.</li>
        <li>Redistribution Schemes: apply progressive/regressive taxes to final wealth and observe Gini changes.</li>
        <li>Universal Basic Endowment: give every newborn a fixed "starter wealth" or "starter education credit" before inheritance and education calculations.</li>
        <li>Environmental Shock: introduce a one-time large Gaussian noise spike in Env for a random subset of agents (e.g., disasters, pandemics).</li>
        <li>Negative Homophily: invert assortative mating logic so agents deliberately pair with those farthest from them in gene/env space.</li>
      </ul>

    `}];document.addEventListener("DOMContentLoaded",()=>{const n=document.getElementById("help-dropdown"),o=document.getElementById("help-container");_n.forEach(r=>{const i=document.createElement("option");i.value=r.id,i.textContent=r.title,n.append(i)});function s(r){const i=_n.find(c=>c.id===r);o.innerHTML=i?i.content:""}n.addEventListener("change",()=>{s(n.value)}),_n.length>0&&(n.value=_n[0].id,s(_n[0].id))});let X={...jn,homophily:{...jn.homophily}},J=[],cn=[],Fe=0,pn=!1;const Uu=750,Qu=document.getElementById("start-btn"),Yu=document.getElementById("pause-btn"),Ku=document.getElementById("reset-btn"),ne=document.getElementById("feature-select"),Ju=document.getElementById("step-btn"),Zu=document.getElementById("status"),Xu=document.getElementById("slider-gene-env"),Mu=document.getElementById("label-gene-env"),Su=document.getElementById("slider-env-noise"),ju=document.getElementById("label-env-noise"),na=document.getElementById("slider-fin-weight"),ea=document.getElementById("label-fin-weight"),ra=document.getElementById("slider-fin-noise"),ta=document.getElementById("label-fin-noise"),ia=document.getElementById("slider-hom-gene"),oa=document.getElementById("label-hom-gene"),fa=document.getElementById("slider-hom-env"),ua=document.getElementById("label-hom-env"),dn=document.getElementById("raster"),Sr=dn.getContext("2d");if(!Sr)throw new Error("Canvas 2D context not available");dn.width=400;dn.height=400;const aa=re("#lorenz"),sa=re("#gini"),la=re("#histogram"),ca=re("#histogram-wealth"),da=document.getElementById("hist-title");function ha(n){const o=Math.ceil(Math.sqrt(n));return{rows:Math.ceil(n/o),cols:o}}function wn(n,o,s,r){const i=()=>{const c=parseFloat(n.value);switch(r(c),s){case"geneEnv":o.textContent=`Env ${((1-c)*100).toFixed(0)}% / ${(c*100).toFixed(0)}% Gene`;break;case"finWeight":o.textContent=`Parent wealth ${((1-c)*100).toFixed(0)}% / ${(c*100).toFixed(0)}% Education`;break;case"homEnv":case"homGene":o.textContent=`Random ${((1-c)*100).toFixed(0)}% / ${(c*100).toFixed(0)}% Homophily`;break;case"envNoise":case"finNoise":o.textContent=`Normal(0, ${c.toFixed(2)})`}};n.addEventListener("input",i),i()}const cr={meanAllele:sn(yu),env:sn(xu),educationScore:sn(_u),wealth:sn(wu),parentWealth:sn(bu)};function jr(){X={...jn,homophily:{...jn.homophily}},J=Fu(X),cn.length=0,Fe=0;const n=J.map(o=>o.wealth);cn.push(Mr(n)),Oe()}function Le(){J=Gu(J,X);const n=J.map(o=>o.wealth);cn.push(Mr(n)),Fe+=1,Oe(),pn&&setTimeout(Le,Uu)}function Oe(){const n=ne.value,o=sr(J,n),s=sr(J,"wealth");Sr.clearRect(0,0,dn.width,dn.height);const{rows:r,cols:i}=ha(o.length),[c,l]=Nn(o);cr[n].domain([c,l]),Bu(dn,o,r,i,cr[n]),Vu(aa,J),Du(sa,cn),da.textContent=`Distribution of Selected Feature: ${n}`,lr(la,o,20,!!["wealth"].includes(n)),lr(ca,s,20,!0);const h=cn[cn.length-1]??0;Zu.textContent=`Gen: ${Fe} | Gini: ${h.toFixed(2)} | Pop: ${J.length} | Feature: ${n}`}Qu.addEventListener("click",()=>{pn||(pn=!0,Le())});Yu.addEventListener("click",()=>{pn=!1});Ku.addEventListener("click",()=>{pn=!1,jr()});Ju.addEventListener("click",()=>{pn||Le()});ne.addEventListener("change",Oe);wn(Xu,Mu,"geneEnv",n=>X.geneEnvWeight=n);wn(Su,ju,"envNoise",n=>X.envNoiseStd=n);wn(na,ea,"finWeight",n=>X.financeWeight=n);wn(ra,ta,"finNoise",n=>X.financeNoise=n);wn(ia,oa,"homGene",n=>X.homophily.gene=n);wn(fa,ua,"homEnv",n=>X.homophily.env=n);(function(){["meanAllele","env","educationScore","wealth","parentWealth"].forEach(o=>{const s=document.createElement("option");s.value=o,s.textContent=o,ne.appendChild(s)}),ne.value="wealth"})();jr();
