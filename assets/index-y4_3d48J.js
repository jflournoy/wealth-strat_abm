(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const s of l.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function c(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(i){if(i.ep)return;i.ep=!0;const l=c(i);fetch(i.href,l)}})();function Ln(n,o){return n==null||o==null?NaN:n<o?-1:n>o?1:n>=o?0:NaN}function Mr(n,o){return n==null||o==null?NaN:o<n?-1:o>n?1:o>=n?0:NaN}function cr(n){let o,c,r;n.length!==2?(o=Ln,c=(h,d)=>Ln(n(h),d),r=(h,d)=>n(h)-d):(o=n===Ln||n===Mr?n:Sr,c=n,r=n);function i(h,d,f=0,e=h.length){if(f<e){if(o(d,d)!==0)return e;do{const t=f+e>>>1;c(h[t],d)<0?f=t+1:e=t}while(f<e)}return f}function l(h,d,f=0,e=h.length){if(f<e){if(o(d,d)!==0)return e;do{const t=f+e>>>1;c(h[t],d)<=0?f=t+1:e=t}while(f<e)}return f}function s(h,d,f=0,e=h.length){const t=i(h,d,f,e-1);return t>f&&r(h[t-1],d)>-r(h[t],d)?t-1:t}return{left:i,center:s,right:l}}function Sr(){return 0}function jr(n){return n===null?NaN:+n}const nt=cr(Ln),sr=nt.right;cr(jr).center;function et(n,o){let c=0;for(let r of n)r!=null&&(r=+r)>=r&&++c;return c}function En(n,o){let c,r;if(o===void 0)for(const i of n)i!=null&&(c===void 0?i>=i&&(c=r=i):(c>i&&(c=i),r<i&&(r=i)));else{let i=-1;for(let l of n)(l=o(l,++i,n))!=null&&(c===void 0?l>=l&&(c=r=l):(c>l&&(c=l),r<l&&(r=l)))}return[c,r]}function rt(n){return n}var tt=Array.prototype,it=tt.slice;function ue(n){return()=>n}const ot=Math.sqrt(50),ft=Math.sqrt(10),ut=Math.sqrt(2);function Gn(n,o,c){const r=(o-n)/Math.max(0,c),i=Math.floor(Math.log10(r)),l=r/Math.pow(10,i),s=l>=ot?10:l>=ft?5:l>=ut?2:1;let h,d,f;return i<0?(f=Math.pow(10,-i)/s,h=Math.round(n*f),d=Math.round(o*f),h/f<n&&++h,d/f>o&&--d,f=-f):(f=Math.pow(10,i)*s,h=Math.round(n/f),d=Math.round(o/f),h*f<n&&++h,d*f>o&&--d),d<h&&.5<=c&&c<2?Gn(n,o,c*2):[h,d,f]}function lr(n,o,c){if(o=+o,n=+n,c=+c,!(c>0))return[];if(n===o)return[n];const r=o<n,[i,l,s]=r?Gn(o,n,c):Gn(n,o,c);if(!(l>=i))return[];const h=l-i+1,d=new Array(h);if(r)if(s<0)for(let f=0;f<h;++f)d[f]=(l-f)/-s;else for(let f=0;f<h;++f)d[f]=(l-f)*s;else if(s<0)for(let f=0;f<h;++f)d[f]=(i+f)/-s;else for(let f=0;f<h;++f)d[f]=(i+f)*s;return d}function hn(n,o,c){return o=+o,n=+n,c=+c,Gn(n,o,c)[2]}function at(n,o,c){o=+o,n=+n,c=+c;const r=o<n,i=r?hn(o,n,c):hn(n,o,c);return(r?-1:1)*(i<0?1/-i:i)}function ct(n,o,c){let r;for(;;){const i=hn(n,o,c);if(i===r||i===0||!isFinite(i))return[n,o];i>0?(n=Math.floor(n/i)*i,o=Math.ceil(o/i)*i):i<0&&(n=Math.ceil(n*i)/i,o=Math.floor(o*i)/i),r=i}}function st(n){return Math.max(1,Math.ceil(Math.log(et(n))/Math.LN2)+1)}function lt(){var n=rt,o=En,c=st;function r(i){Array.isArray(i)||(i=Array.from(i));var l,s=i.length,h,d,f=new Array(s);for(l=0;l<s;++l)f[l]=n(i[l],l,i);var e=o(f),t=e[0],u=e[1],a=c(f,t,u);if(!Array.isArray(a)){const p=u,b=+a;if(o===En&&([t,u]=ct(t,u,b)),a=lr(t,u,b),a[0]<=t&&(d=hn(t,u,b)),a[a.length-1]>=u)if(p>=u&&o===En){const _=hn(t,u,b);isFinite(_)&&(_>0?u=(Math.floor(u/_)+1)*_:_<0&&(u=(Math.ceil(u*-_)+1)/-_))}else a.pop()}for(var m=a.length,v=0,g=m;a[v]<=t;)++v;for(;a[g-1]>u;)--g;(v||g<m)&&(a=a.slice(v,g),m=g-v);var w=new Array(m+1),y;for(l=0;l<=m;++l)y=w[l]=[],y.x0=l>0?a[l-1]:t,y.x1=l<m?a[l]:u;if(isFinite(d)){if(d>0)for(l=0;l<s;++l)(h=f[l])!=null&&t<=h&&h<=u&&w[Math.min(m,Math.floor((h-t)/d))].push(i[l]);else if(d<0){for(l=0;l<s;++l)if((h=f[l])!=null&&t<=h&&h<=u){const p=Math.floor((t-h)*d);w[Math.min(m,p+(a[p]<=h))].push(i[l])}}}else for(l=0;l<s;++l)(h=f[l])!=null&&t<=h&&h<=u&&w[sr(a,h,0,m)].push(i[l]);return w}return r.value=function(i){return arguments.length?(n=typeof i=="function"?i:ue(i),r):n},r.domain=function(i){return arguments.length?(o=typeof i=="function"?i:ue([i[0],i[1]]),r):o},r.thresholds=function(i){return arguments.length?(c=typeof i=="function"?i:ue(Array.isArray(i)?it.call(i):i),r):c},r}function Oe(n,o){let c;if(o===void 0)for(const r of n)r!=null&&(c<r||c===void 0&&r>=r)&&(c=r);else{let r=-1;for(let i of n)(i=o(i,++r,n))!=null&&(c<i||c===void 0&&i>=i)&&(c=i)}return c}function dt(n,o){let c;for(const r of n)r!=null&&(c>r||c===void 0&&r>=r)&&(c=r);return c}function ht(n,o,c){n=+n,o=+o,c=(i=arguments.length)<2?(o=n,n=0,1):i<3?1:+c;for(var r=-1,i=Math.max(0,Math.ceil((o-n)/c))|0,l=new Array(i);++r<i;)l[r]=n+r*c;return l}function mt(n,o){let c=0;if(o===void 0)for(let r of n)(r=+r)&&(c+=r);else{let r=-1;for(let i of n)(i=+o(i,++r,n))&&(c+=i)}return c}function vt(n){return n}var ae=1,ce=2,de=3,_n=4,He=1e-6;function gt(n){return"translate("+n+",0)"}function pt(n){return"translate(0,"+n+")"}function wt(n){return o=>+n(o)}function yt(n,o){return o=Math.max(0,n.bandwidth()-o*2)/2,n.round()&&(o=Math.round(o)),c=>+n(c)+o}function bt(){return!this.__axis}function dr(n,o){var c=[],r=null,i=null,l=6,s=6,h=3,d=typeof window<"u"&&window.devicePixelRatio>1?0:.5,f=n===ae||n===_n?-1:1,e=n===_n||n===ce?"x":"y",t=n===ae||n===de?gt:pt;function u(a){var m=r??(o.ticks?o.ticks.apply(o,c):o.domain()),v=i??(o.tickFormat?o.tickFormat.apply(o,c):vt),g=Math.max(l,0)+h,w=o.range(),y=+w[0]+d,p=+w[w.length-1]+d,b=(o.bandwidth?yt:wt)(o.copy(),d),_=a.selection?a.selection():a,x=_.selectAll(".domain").data([null]),k=_.selectAll(".tick").data(m,o).order(),A=k.exit(),N=k.enter().append("g").attr("class","tick"),$=k.select("line"),E=k.select("text");x=x.merge(x.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),k=k.merge(N),$=$.merge(N.append("line").attr("stroke","currentColor").attr(e+"2",f*l)),E=E.merge(N.append("text").attr("fill","currentColor").attr(e,f*g).attr("dy",n===ae?"0em":n===de?"0.71em":"0.32em")),a!==_&&(x=x.transition(a),k=k.transition(a),$=$.transition(a),E=E.transition(a),A=A.transition(a).attr("opacity",He).attr("transform",function(q){return isFinite(q=b(q))?t(q+d):this.getAttribute("transform")}),N.attr("opacity",He).attr("transform",function(q){var I=this.parentNode.__axis;return t((I&&isFinite(I=I(q))?I:b(q))+d)})),A.remove(),x.attr("d",n===_n||n===ce?s?"M"+f*s+","+y+"H"+d+"V"+p+"H"+f*s:"M"+d+","+y+"V"+p:s?"M"+y+","+f*s+"V"+d+"H"+p+"V"+f*s:"M"+y+","+d+"H"+p),k.attr("opacity",1).attr("transform",function(q){return t(b(q)+d)}),$.attr(e+"2",f*l),E.attr(e,f*g).text(v),_.filter(bt).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",n===ce?"start":n===_n?"end":"middle"),_.each(function(){this.__axis=b})}return u.scale=function(a){return arguments.length?(o=a,u):o},u.ticks=function(){return c=Array.from(arguments),u},u.tickArguments=function(a){return arguments.length?(c=a==null?[]:Array.from(a),u):c.slice()},u.tickValues=function(a){return arguments.length?(r=a==null?null:Array.from(a),u):r&&r.slice()},u.tickFormat=function(a){return arguments.length?(i=a,u):i},u.tickSize=function(a){return arguments.length?(l=s=+a,u):l},u.tickSizeInner=function(a){return arguments.length?(l=+a,u):l},u.tickSizeOuter=function(a){return arguments.length?(s=+a,u):s},u.tickPadding=function(a){return arguments.length?(h=+a,u):h},u.offset=function(a){return arguments.length?(d=+a,u):d},u}function Wn(n){return dr(de,n)}function ke(n){return dr(_n,n)}var _t={value:()=>{}};function hr(){for(var n=0,o=arguments.length,c={},r;n<o;++n){if(!(r=arguments[n]+"")||r in c||/[\s.]/.test(r))throw new Error("illegal type: "+r);c[r]=[]}return new On(c)}function On(n){this._=n}function xt(n,o){return n.trim().split(/^|\s+/).map(function(c){var r="",i=c.indexOf(".");if(i>=0&&(r=c.slice(i+1),c=c.slice(0,i)),c&&!o.hasOwnProperty(c))throw new Error("unknown type: "+c);return{type:c,name:r}})}On.prototype=hr.prototype={constructor:On,on:function(n,o){var c=this._,r=xt(n+"",c),i,l=-1,s=r.length;if(arguments.length<2){for(;++l<s;)if((i=(n=r[l]).type)&&(i=kt(c[i],n.name)))return i;return}if(o!=null&&typeof o!="function")throw new Error("invalid callback: "+o);for(;++l<s;)if(i=(n=r[l]).type)c[i]=Be(c[i],n.name,o);else if(o==null)for(i in c)c[i]=Be(c[i],n.name,null);return this},copy:function(){var n={},o=this._;for(var c in o)n[c]=o[c].slice();return new On(n)},call:function(n,o){if((i=arguments.length-2)>0)for(var c=new Array(i),r=0,i,l;r<i;++r)c[r]=arguments[r+2];if(!this._.hasOwnProperty(n))throw new Error("unknown type: "+n);for(l=this._[n],r=0,i=l.length;r<i;++r)l[r].value.apply(o,c)},apply:function(n,o,c){if(!this._.hasOwnProperty(n))throw new Error("unknown type: "+n);for(var r=this._[n],i=0,l=r.length;i<l;++i)r[i].value.apply(o,c)}};function kt(n,o){for(var c=0,r=n.length,i;c<r;++c)if((i=n[c]).name===o)return i.value}function Be(n,o,c){for(var r=0,i=n.length;r<i;++r)if(n[r].name===o){n[r]=_t,n=n.slice(0,r).concat(n.slice(r+1));break}return c!=null&&n.push({name:o,value:c}),n}var he="http://www.w3.org/1999/xhtml";const Ve={svg:"http://www.w3.org/2000/svg",xhtml:he,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function ne(n){var o=n+="",c=o.indexOf(":");return c>=0&&(o=n.slice(0,c))!=="xmlns"&&(n=n.slice(c+1)),Ve.hasOwnProperty(o)?{space:Ve[o],local:n}:n}function At(n){return function(){var o=this.ownerDocument,c=this.namespaceURI;return c===he&&o.documentElement.namespaceURI===he?o.createElement(n):o.createElementNS(c,n)}}function Et(n){return function(){return this.ownerDocument.createElementNS(n.space,n.local)}}function mr(n){var o=ne(n);return(o.local?Et:At)(o)}function Nt(){}function Ae(n){return n==null?Nt:function(){return this.querySelector(n)}}function $t(n){typeof n!="function"&&(n=Ae(n));for(var o=this._groups,c=o.length,r=new Array(c),i=0;i<c;++i)for(var l=o[i],s=l.length,h=r[i]=new Array(s),d,f,e=0;e<s;++e)(d=l[e])&&(f=n.call(d,d.__data__,e,l))&&("__data__"in d&&(f.__data__=d.__data__),h[e]=f);return new F(r,this._parents)}function qt(n){return n==null?[]:Array.isArray(n)?n:Array.from(n)}function It(){return[]}function vr(n){return n==null?It:function(){return this.querySelectorAll(n)}}function Rt(n){return function(){return qt(n.apply(this,arguments))}}function Pt(n){typeof n=="function"?n=Rt(n):n=vr(n);for(var o=this._groups,c=o.length,r=[],i=[],l=0;l<c;++l)for(var s=o[l],h=s.length,d,f=0;f<h;++f)(d=s[f])&&(r.push(n.call(d,d.__data__,f,s)),i.push(d));return new F(r,i)}function gr(n){return function(){return this.matches(n)}}function pr(n){return function(o){return o.matches(n)}}var Tt=Array.prototype.find;function zt(n){return function(){return Tt.call(this.children,n)}}function Ct(){return this.firstElementChild}function Ft(n){return this.select(n==null?Ct:zt(typeof n=="function"?n:pr(n)))}var Lt=Array.prototype.filter;function Ot(){return Array.from(this.children)}function Ht(n){return function(){return Lt.call(this.children,n)}}function Bt(n){return this.selectAll(n==null?Ot:Ht(typeof n=="function"?n:pr(n)))}function Vt(n){typeof n!="function"&&(n=gr(n));for(var o=this._groups,c=o.length,r=new Array(c),i=0;i<c;++i)for(var l=o[i],s=l.length,h=r[i]=[],d,f=0;f<s;++f)(d=l[f])&&n.call(d,d.__data__,f,l)&&h.push(d);return new F(r,this._parents)}function wr(n){return new Array(n.length)}function Gt(){return new F(this._enter||this._groups.map(wr),this._parents)}function Dn(n,o){this.ownerDocument=n.ownerDocument,this.namespaceURI=n.namespaceURI,this._next=null,this._parent=n,this.__data__=o}Dn.prototype={constructor:Dn,appendChild:function(n){return this._parent.insertBefore(n,this._next)},insertBefore:function(n,o){return this._parent.insertBefore(n,o)},querySelector:function(n){return this._parent.querySelector(n)},querySelectorAll:function(n){return this._parent.querySelectorAll(n)}};function Wt(n){return function(){return n}}function Dt(n,o,c,r,i,l){for(var s=0,h,d=o.length,f=l.length;s<f;++s)(h=o[s])?(h.__data__=l[s],r[s]=h):c[s]=new Dn(n,l[s]);for(;s<d;++s)(h=o[s])&&(i[s]=h)}function Ut(n,o,c,r,i,l,s){var h,d,f=new Map,e=o.length,t=l.length,u=new Array(e),a;for(h=0;h<e;++h)(d=o[h])&&(u[h]=a=s.call(d,d.__data__,h,o)+"",f.has(a)?i[h]=d:f.set(a,d));for(h=0;h<t;++h)a=s.call(n,l[h],h,l)+"",(d=f.get(a))?(r[h]=d,d.__data__=l[h],f.delete(a)):c[h]=new Dn(n,l[h]);for(h=0;h<e;++h)(d=o[h])&&f.get(u[h])===d&&(i[h]=d)}function Qt(n){return n.__data__}function Yt(n,o){if(!arguments.length)return Array.from(this,Qt);var c=o?Ut:Dt,r=this._parents,i=this._groups;typeof n!="function"&&(n=Wt(n));for(var l=i.length,s=new Array(l),h=new Array(l),d=new Array(l),f=0;f<l;++f){var e=r[f],t=i[f],u=t.length,a=Kt(n.call(e,e&&e.__data__,f,r)),m=a.length,v=h[f]=new Array(m),g=s[f]=new Array(m),w=d[f]=new Array(u);c(e,t,v,g,w,a,o);for(var y=0,p=0,b,_;y<m;++y)if(b=v[y]){for(y>=p&&(p=y+1);!(_=g[p])&&++p<m;);b._next=_||null}}return s=new F(s,r),s._enter=h,s._exit=d,s}function Kt(n){return typeof n=="object"&&"length"in n?n:Array.from(n)}function Jt(){return new F(this._exit||this._groups.map(wr),this._parents)}function Zt(n,o,c){var r=this.enter(),i=this,l=this.exit();return typeof n=="function"?(r=n(r),r&&(r=r.selection())):r=r.append(n+""),o!=null&&(i=o(i),i&&(i=i.selection())),c==null?l.remove():c(l),r&&i?r.merge(i).order():i}function Xt(n){for(var o=n.selection?n.selection():n,c=this._groups,r=o._groups,i=c.length,l=r.length,s=Math.min(i,l),h=new Array(i),d=0;d<s;++d)for(var f=c[d],e=r[d],t=f.length,u=h[d]=new Array(t),a,m=0;m<t;++m)(a=f[m]||e[m])&&(u[m]=a);for(;d<i;++d)h[d]=c[d];return new F(h,this._parents)}function Mt(){for(var n=this._groups,o=-1,c=n.length;++o<c;)for(var r=n[o],i=r.length-1,l=r[i],s;--i>=0;)(s=r[i])&&(l&&s.compareDocumentPosition(l)^4&&l.parentNode.insertBefore(s,l),l=s);return this}function St(n){n||(n=jt);function o(t,u){return t&&u?n(t.__data__,u.__data__):!t-!u}for(var c=this._groups,r=c.length,i=new Array(r),l=0;l<r;++l){for(var s=c[l],h=s.length,d=i[l]=new Array(h),f,e=0;e<h;++e)(f=s[e])&&(d[e]=f);d.sort(o)}return new F(i,this._parents).order()}function jt(n,o){return n<o?-1:n>o?1:n>=o?0:NaN}function ni(){var n=arguments[0];return arguments[0]=this,n.apply(null,arguments),this}function ei(){return Array.from(this)}function ri(){for(var n=this._groups,o=0,c=n.length;o<c;++o)for(var r=n[o],i=0,l=r.length;i<l;++i){var s=r[i];if(s)return s}return null}function ti(){let n=0;for(const o of this)++n;return n}function ii(){return!this.node()}function oi(n){for(var o=this._groups,c=0,r=o.length;c<r;++c)for(var i=o[c],l=0,s=i.length,h;l<s;++l)(h=i[l])&&n.call(h,h.__data__,l,i);return this}function fi(n){return function(){this.removeAttribute(n)}}function ui(n){return function(){this.removeAttributeNS(n.space,n.local)}}function ai(n,o){return function(){this.setAttribute(n,o)}}function ci(n,o){return function(){this.setAttributeNS(n.space,n.local,o)}}function si(n,o){return function(){var c=o.apply(this,arguments);c==null?this.removeAttribute(n):this.setAttribute(n,c)}}function li(n,o){return function(){var c=o.apply(this,arguments);c==null?this.removeAttributeNS(n.space,n.local):this.setAttributeNS(n.space,n.local,c)}}function di(n,o){var c=ne(n);if(arguments.length<2){var r=this.node();return c.local?r.getAttributeNS(c.space,c.local):r.getAttribute(c)}return this.each((o==null?c.local?ui:fi:typeof o=="function"?c.local?li:si:c.local?ci:ai)(c,o))}function yr(n){return n.ownerDocument&&n.ownerDocument.defaultView||n.document&&n||n.defaultView}function hi(n){return function(){this.style.removeProperty(n)}}function mi(n,o,c){return function(){this.style.setProperty(n,o,c)}}function vi(n,o,c){return function(){var r=o.apply(this,arguments);r==null?this.style.removeProperty(n):this.style.setProperty(n,r,c)}}function gi(n,o,c){return arguments.length>1?this.each((o==null?hi:typeof o=="function"?vi:mi)(n,o,c??"")):mn(this.node(),n)}function mn(n,o){return n.style.getPropertyValue(o)||yr(n).getComputedStyle(n,null).getPropertyValue(o)}function pi(n){return function(){delete this[n]}}function wi(n,o){return function(){this[n]=o}}function yi(n,o){return function(){var c=o.apply(this,arguments);c==null?delete this[n]:this[n]=c}}function bi(n,o){return arguments.length>1?this.each((o==null?pi:typeof o=="function"?yi:wi)(n,o)):this.node()[n]}function br(n){return n.trim().split(/^|\s+/)}function Ee(n){return n.classList||new _r(n)}function _r(n){this._node=n,this._names=br(n.getAttribute("class")||"")}_r.prototype={add:function(n){var o=this._names.indexOf(n);o<0&&(this._names.push(n),this._node.setAttribute("class",this._names.join(" ")))},remove:function(n){var o=this._names.indexOf(n);o>=0&&(this._names.splice(o,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(n){return this._names.indexOf(n)>=0}};function xr(n,o){for(var c=Ee(n),r=-1,i=o.length;++r<i;)c.add(o[r])}function kr(n,o){for(var c=Ee(n),r=-1,i=o.length;++r<i;)c.remove(o[r])}function _i(n){return function(){xr(this,n)}}function xi(n){return function(){kr(this,n)}}function ki(n,o){return function(){(o.apply(this,arguments)?xr:kr)(this,n)}}function Ai(n,o){var c=br(n+"");if(arguments.length<2){for(var r=Ee(this.node()),i=-1,l=c.length;++i<l;)if(!r.contains(c[i]))return!1;return!0}return this.each((typeof o=="function"?ki:o?_i:xi)(c,o))}function Ei(){this.textContent=""}function Ni(n){return function(){this.textContent=n}}function $i(n){return function(){var o=n.apply(this,arguments);this.textContent=o??""}}function qi(n){return arguments.length?this.each(n==null?Ei:(typeof n=="function"?$i:Ni)(n)):this.node().textContent}function Ii(){this.innerHTML=""}function Ri(n){return function(){this.innerHTML=n}}function Pi(n){return function(){var o=n.apply(this,arguments);this.innerHTML=o??""}}function Ti(n){return arguments.length?this.each(n==null?Ii:(typeof n=="function"?Pi:Ri)(n)):this.node().innerHTML}function zi(){this.nextSibling&&this.parentNode.appendChild(this)}function Ci(){return this.each(zi)}function Fi(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Li(){return this.each(Fi)}function Oi(n){var o=typeof n=="function"?n:mr(n);return this.select(function(){return this.appendChild(o.apply(this,arguments))})}function Hi(){return null}function Bi(n,o){var c=typeof n=="function"?n:mr(n),r=o==null?Hi:typeof o=="function"?o:Ae(o);return this.select(function(){return this.insertBefore(c.apply(this,arguments),r.apply(this,arguments)||null)})}function Vi(){var n=this.parentNode;n&&n.removeChild(this)}function Gi(){return this.each(Vi)}function Wi(){var n=this.cloneNode(!1),o=this.parentNode;return o?o.insertBefore(n,this.nextSibling):n}function Di(){var n=this.cloneNode(!0),o=this.parentNode;return o?o.insertBefore(n,this.nextSibling):n}function Ui(n){return this.select(n?Di:Wi)}function Qi(n){return arguments.length?this.property("__data__",n):this.node().__data__}function Yi(n){return function(o){n.call(this,o,this.__data__)}}function Ki(n){return n.trim().split(/^|\s+/).map(function(o){var c="",r=o.indexOf(".");return r>=0&&(c=o.slice(r+1),o=o.slice(0,r)),{type:o,name:c}})}function Ji(n){return function(){var o=this.__on;if(o){for(var c=0,r=-1,i=o.length,l;c<i;++c)l=o[c],(!n.type||l.type===n.type)&&l.name===n.name?this.removeEventListener(l.type,l.listener,l.options):o[++r]=l;++r?o.length=r:delete this.__on}}}function Zi(n,o,c){return function(){var r=this.__on,i,l=Yi(o);if(r){for(var s=0,h=r.length;s<h;++s)if((i=r[s]).type===n.type&&i.name===n.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=l,i.options=c),i.value=o;return}}this.addEventListener(n.type,l,c),i={type:n.type,name:n.name,value:o,listener:l,options:c},r?r.push(i):this.__on=[i]}}function Xi(n,o,c){var r=Ki(n+""),i,l=r.length,s;if(arguments.length<2){var h=this.node().__on;if(h){for(var d=0,f=h.length,e;d<f;++d)for(i=0,e=h[d];i<l;++i)if((s=r[i]).type===e.type&&s.name===e.name)return e.value}return}for(h=o?Zi:Ji,i=0;i<l;++i)this.each(h(r[i],o,c));return this}function Ar(n,o,c){var r=yr(n),i=r.CustomEvent;typeof i=="function"?i=new i(o,c):(i=r.document.createEvent("Event"),c?(i.initEvent(o,c.bubbles,c.cancelable),i.detail=c.detail):i.initEvent(o,!1,!1)),n.dispatchEvent(i)}function Mi(n,o){return function(){return Ar(this,n,o)}}function Si(n,o){return function(){return Ar(this,n,o.apply(this,arguments))}}function ji(n,o){return this.each((typeof o=="function"?Si:Mi)(n,o))}function*no(){for(var n=this._groups,o=0,c=n.length;o<c;++o)for(var r=n[o],i=0,l=r.length,s;i<l;++i)(s=r[i])&&(yield s)}var Er=[null];function F(n,o){this._groups=n,this._parents=o}function In(){return new F([[document.documentElement]],Er)}function eo(){return this}F.prototype=In.prototype={constructor:F,select:$t,selectAll:Pt,selectChild:Ft,selectChildren:Bt,filter:Vt,data:Yt,enter:Gt,exit:Jt,join:Zt,merge:Xt,selection:eo,order:Mt,sort:St,call:ni,nodes:ei,node:ri,size:ti,empty:ii,each:oi,attr:di,style:gi,property:bi,classed:Ai,text:qi,html:Ti,raise:Ci,lower:Li,append:Oi,insert:Bi,remove:Gi,clone:Ui,datum:Qi,on:Xi,dispatch:ji,[Symbol.iterator]:no};function Ne(n){return typeof n=="string"?new F([[document.querySelector(n)]],[document.documentElement]):new F([[n]],Er)}function $e(n,o,c){n.prototype=o.prototype=c,c.constructor=n}function Nr(n,o){var c=Object.create(n.prototype);for(var r in o)c[r]=o[r];return c}function Rn(){}var Nn=.7,Un=1/Nn,sn="\\s*([+-]?\\d+)\\s*",$n="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Q="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ro=/^#([0-9a-f]{3,8})$/,to=new RegExp(`^rgb\\(${sn},${sn},${sn}\\)$`),io=new RegExp(`^rgb\\(${Q},${Q},${Q}\\)$`),oo=new RegExp(`^rgba\\(${sn},${sn},${sn},${$n}\\)$`),fo=new RegExp(`^rgba\\(${Q},${Q},${Q},${$n}\\)$`),uo=new RegExp(`^hsl\\(${$n},${Q},${Q}\\)$`),ao=new RegExp(`^hsla\\(${$n},${Q},${Q},${$n}\\)$`),Ge={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};$e(Rn,tn,{copy(n){return Object.assign(new this.constructor,this,n)},displayable(){return this.rgb().displayable()},hex:We,formatHex:We,formatHex8:co,formatHsl:so,formatRgb:De,toString:De});function We(){return this.rgb().formatHex()}function co(){return this.rgb().formatHex8()}function so(){return $r(this).formatHsl()}function De(){return this.rgb().formatRgb()}function tn(n){var o,c;return n=(n+"").trim().toLowerCase(),(o=ro.exec(n))?(c=o[1].length,o=parseInt(o[1],16),c===6?Ue(o):c===3?new C(o>>8&15|o>>4&240,o>>4&15|o&240,(o&15)<<4|o&15,1):c===8?Pn(o>>24&255,o>>16&255,o>>8&255,(o&255)/255):c===4?Pn(o>>12&15|o>>8&240,o>>8&15|o>>4&240,o>>4&15|o&240,((o&15)<<4|o&15)/255):null):(o=to.exec(n))?new C(o[1],o[2],o[3],1):(o=io.exec(n))?new C(o[1]*255/100,o[2]*255/100,o[3]*255/100,1):(o=oo.exec(n))?Pn(o[1],o[2],o[3],o[4]):(o=fo.exec(n))?Pn(o[1]*255/100,o[2]*255/100,o[3]*255/100,o[4]):(o=uo.exec(n))?Ke(o[1],o[2]/100,o[3]/100,1):(o=ao.exec(n))?Ke(o[1],o[2]/100,o[3]/100,o[4]):Ge.hasOwnProperty(n)?Ue(Ge[n]):n==="transparent"?new C(NaN,NaN,NaN,0):null}function Ue(n){return new C(n>>16&255,n>>8&255,n&255,1)}function Pn(n,o,c,r){return r<=0&&(n=o=c=NaN),new C(n,o,c,r)}function lo(n){return n instanceof Rn||(n=tn(n)),n?(n=n.rgb(),new C(n.r,n.g,n.b,n.opacity)):new C}function me(n,o,c,r){return arguments.length===1?lo(n):new C(n,o,c,r??1)}function C(n,o,c,r){this.r=+n,this.g=+o,this.b=+c,this.opacity=+r}$e(C,me,Nr(Rn,{brighter(n){return n=n==null?Un:Math.pow(Un,n),new C(this.r*n,this.g*n,this.b*n,this.opacity)},darker(n){return n=n==null?Nn:Math.pow(Nn,n),new C(this.r*n,this.g*n,this.b*n,this.opacity)},rgb(){return this},clamp(){return new C(rn(this.r),rn(this.g),rn(this.b),Qn(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Qe,formatHex:Qe,formatHex8:ho,formatRgb:Ye,toString:Ye}));function Qe(){return`#${en(this.r)}${en(this.g)}${en(this.b)}`}function ho(){return`#${en(this.r)}${en(this.g)}${en(this.b)}${en((isNaN(this.opacity)?1:this.opacity)*255)}`}function Ye(){const n=Qn(this.opacity);return`${n===1?"rgb(":"rgba("}${rn(this.r)}, ${rn(this.g)}, ${rn(this.b)}${n===1?")":`, ${n})`}`}function Qn(n){return isNaN(n)?1:Math.max(0,Math.min(1,n))}function rn(n){return Math.max(0,Math.min(255,Math.round(n)||0))}function en(n){return n=rn(n),(n<16?"0":"")+n.toString(16)}function Ke(n,o,c,r){return r<=0?n=o=c=NaN:c<=0||c>=1?n=o=NaN:o<=0&&(n=NaN),new V(n,o,c,r)}function $r(n){if(n instanceof V)return new V(n.h,n.s,n.l,n.opacity);if(n instanceof Rn||(n=tn(n)),!n)return new V;if(n instanceof V)return n;n=n.rgb();var o=n.r/255,c=n.g/255,r=n.b/255,i=Math.min(o,c,r),l=Math.max(o,c,r),s=NaN,h=l-i,d=(l+i)/2;return h?(o===l?s=(c-r)/h+(c<r)*6:c===l?s=(r-o)/h+2:s=(o-c)/h+4,h/=d<.5?l+i:2-l-i,s*=60):h=d>0&&d<1?0:s,new V(s,h,d,n.opacity)}function mo(n,o,c,r){return arguments.length===1?$r(n):new V(n,o,c,r??1)}function V(n,o,c,r){this.h=+n,this.s=+o,this.l=+c,this.opacity=+r}$e(V,mo,Nr(Rn,{brighter(n){return n=n==null?Un:Math.pow(Un,n),new V(this.h,this.s,this.l*n,this.opacity)},darker(n){return n=n==null?Nn:Math.pow(Nn,n),new V(this.h,this.s,this.l*n,this.opacity)},rgb(){var n=this.h%360+(this.h<0)*360,o=isNaN(n)||isNaN(this.s)?0:this.s,c=this.l,r=c+(c<.5?c:1-c)*o,i=2*c-r;return new C(se(n>=240?n-240:n+120,i,r),se(n,i,r),se(n<120?n+240:n-120,i,r),this.opacity)},clamp(){return new V(Je(this.h),Tn(this.s),Tn(this.l),Qn(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const n=Qn(this.opacity);return`${n===1?"hsl(":"hsla("}${Je(this.h)}, ${Tn(this.s)*100}%, ${Tn(this.l)*100}%${n===1?")":`, ${n})`}`}}));function Je(n){return n=(n||0)%360,n<0?n+360:n}function Tn(n){return Math.max(0,Math.min(1,n||0))}function se(n,o,c){return(n<60?o+(c-o)*n/60:n<180?c:n<240?o+(c-o)*(240-n)/60:o)*255}const qe=n=>()=>n;function vo(n,o){return function(c){return n+c*o}}function go(n,o,c){return n=Math.pow(n,c),o=Math.pow(o,c)-n,c=1/c,function(r){return Math.pow(n+r*o,c)}}function po(n){return(n=+n)==1?qr:function(o,c){return c-o?go(o,c,n):qe(isNaN(o)?c:o)}}function qr(n,o){var c=o-n;return c?vo(n,c):qe(isNaN(n)?o:n)}const Yn=function n(o){var c=po(o);function r(i,l){var s=c((i=me(i)).r,(l=me(l)).r),h=c(i.g,l.g),d=c(i.b,l.b),f=qr(i.opacity,l.opacity);return function(e){return i.r=s(e),i.g=h(e),i.b=d(e),i.opacity=f(e),i+""}}return r.gamma=n,r}(1);function wo(n,o){o||(o=[]);var c=n?Math.min(o.length,n.length):0,r=o.slice(),i;return function(l){for(i=0;i<c;++i)r[i]=n[i]*(1-l)+o[i]*l;return r}}function yo(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function bo(n,o){var c=o?o.length:0,r=n?Math.min(c,n.length):0,i=new Array(r),l=new Array(c),s;for(s=0;s<r;++s)i[s]=ee(n[s],o[s]);for(;s<c;++s)l[s]=o[s];return function(h){for(s=0;s<r;++s)l[s]=i[s](h);return l}}function _o(n,o){var c=new Date;return n=+n,o=+o,function(r){return c.setTime(n*(1-r)+o*r),c}}function B(n,o){return n=+n,o=+o,function(c){return n*(1-c)+o*c}}function xo(n,o){var c={},r={},i;(n===null||typeof n!="object")&&(n={}),(o===null||typeof o!="object")&&(o={});for(i in o)i in n?c[i]=ee(n[i],o[i]):r[i]=o[i];return function(l){for(i in c)r[i]=c[i](l);return r}}var ve=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,le=new RegExp(ve.source,"g");function ko(n){return function(){return n}}function Ao(n){return function(o){return n(o)+""}}function Ir(n,o){var c=ve.lastIndex=le.lastIndex=0,r,i,l,s=-1,h=[],d=[];for(n=n+"",o=o+"";(r=ve.exec(n))&&(i=le.exec(o));)(l=i.index)>c&&(l=o.slice(c,l),h[s]?h[s]+=l:h[++s]=l),(r=r[0])===(i=i[0])?h[s]?h[s]+=i:h[++s]=i:(h[++s]=null,d.push({i:s,x:B(r,i)})),c=le.lastIndex;return c<o.length&&(l=o.slice(c),h[s]?h[s]+=l:h[++s]=l),h.length<2?d[0]?Ao(d[0].x):ko(o):(o=d.length,function(f){for(var e=0,t;e<o;++e)h[(t=d[e]).i]=t.x(f);return h.join("")})}function ee(n,o){var c=typeof o,r;return o==null||c==="boolean"?qe(o):(c==="number"?B:c==="string"?(r=tn(o))?(o=r,Yn):Ir:o instanceof tn?Yn:o instanceof Date?_o:yo(o)?wo:Array.isArray(o)?bo:typeof o.valueOf!="function"&&typeof o.toString!="function"||isNaN(o)?xo:B)(n,o)}function Rr(n,o){return n=+n,o=+o,function(c){return Math.round(n*(1-c)+o*c)}}var Ze=180/Math.PI,ge={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Pr(n,o,c,r,i,l){var s,h,d;return(s=Math.sqrt(n*n+o*o))&&(n/=s,o/=s),(d=n*c+o*r)&&(c-=n*d,r-=o*d),(h=Math.sqrt(c*c+r*r))&&(c/=h,r/=h,d/=h),n*r<o*c&&(n=-n,o=-o,d=-d,s=-s),{translateX:i,translateY:l,rotate:Math.atan2(o,n)*Ze,skewX:Math.atan(d)*Ze,scaleX:s,scaleY:h}}var zn;function Eo(n){const o=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(n+"");return o.isIdentity?ge:Pr(o.a,o.b,o.c,o.d,o.e,o.f)}function No(n){return n==null||(zn||(zn=document.createElementNS("http://www.w3.org/2000/svg","g")),zn.setAttribute("transform",n),!(n=zn.transform.baseVal.consolidate()))?ge:(n=n.matrix,Pr(n.a,n.b,n.c,n.d,n.e,n.f))}function Tr(n,o,c,r){function i(f){return f.length?f.pop()+" ":""}function l(f,e,t,u,a,m){if(f!==t||e!==u){var v=a.push("translate(",null,o,null,c);m.push({i:v-4,x:B(f,t)},{i:v-2,x:B(e,u)})}else(t||u)&&a.push("translate("+t+o+u+c)}function s(f,e,t,u){f!==e?(f-e>180?e+=360:e-f>180&&(f+=360),u.push({i:t.push(i(t)+"rotate(",null,r)-2,x:B(f,e)})):e&&t.push(i(t)+"rotate("+e+r)}function h(f,e,t,u){f!==e?u.push({i:t.push(i(t)+"skewX(",null,r)-2,x:B(f,e)}):e&&t.push(i(t)+"skewX("+e+r)}function d(f,e,t,u,a,m){if(f!==t||e!==u){var v=a.push(i(a)+"scale(",null,",",null,")");m.push({i:v-4,x:B(f,t)},{i:v-2,x:B(e,u)})}else(t!==1||u!==1)&&a.push(i(a)+"scale("+t+","+u+")")}return function(f,e){var t=[],u=[];return f=n(f),e=n(e),l(f.translateX,f.translateY,e.translateX,e.translateY,t,u),s(f.rotate,e.rotate,t,u),h(f.skewX,e.skewX,t,u),d(f.scaleX,f.scaleY,e.scaleX,e.scaleY,t,u),f=e=null,function(a){for(var m=-1,v=u.length,g;++m<v;)t[(g=u[m]).i]=g.x(a);return t.join("")}}}var $o=Tr(Eo,"px, ","px)","deg)"),qo=Tr(No,", ",")",")"),vn=0,xn=0,bn=0,zr=1e3,Kn,kn,Jn=0,on=0,re=0,qn=typeof performance=="object"&&performance.now?performance:Date,Cr=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(n){setTimeout(n,17)};function Ie(){return on||(Cr(Io),on=qn.now()+re)}function Io(){on=0}function Zn(){this._call=this._time=this._next=null}Zn.prototype=Fr.prototype={constructor:Zn,restart:function(n,o,c){if(typeof n!="function")throw new TypeError("callback is not a function");c=(c==null?Ie():+c)+(o==null?0:+o),!this._next&&kn!==this&&(kn?kn._next=this:Kn=this,kn=this),this._call=n,this._time=c,pe()},stop:function(){this._call&&(this._call=null,this._time=1/0,pe())}};function Fr(n,o,c){var r=new Zn;return r.restart(n,o,c),r}function Ro(){Ie(),++vn;for(var n=Kn,o;n;)(o=on-n._time)>=0&&n._call.call(void 0,o),n=n._next;--vn}function Xe(){on=(Jn=qn.now())+re,vn=xn=0;try{Ro()}finally{vn=0,To(),on=0}}function Po(){var n=qn.now(),o=n-Jn;o>zr&&(re-=o,Jn=n)}function To(){for(var n,o=Kn,c,r=1/0;o;)o._call?(r>o._time&&(r=o._time),n=o,o=o._next):(c=o._next,o._next=null,o=n?n._next=c:Kn=c);kn=n,pe(r)}function pe(n){if(!vn){xn&&(xn=clearTimeout(xn));var o=n-on;o>24?(n<1/0&&(xn=setTimeout(Xe,n-qn.now()-re)),bn&&(bn=clearInterval(bn))):(bn||(Jn=qn.now(),bn=setInterval(Po,zr)),vn=1,Cr(Xe))}}function Me(n,o,c){var r=new Zn;return o=o==null?0:+o,r.restart(i=>{r.stop(),n(i+o)},o,c),r}var zo=hr("start","end","cancel","interrupt"),Co=[],Lr=0,Se=1,we=2,Hn=3,je=4,ye=5,Bn=6;function te(n,o,c,r,i,l){var s=n.__transition;if(!s)n.__transition={};else if(c in s)return;Fo(n,c,{name:o,index:r,group:i,on:zo,tween:Co,time:l.time,delay:l.delay,duration:l.duration,ease:l.ease,timer:null,state:Lr})}function Re(n,o){var c=G(n,o);if(c.state>Lr)throw new Error("too late; already scheduled");return c}function Y(n,o){var c=G(n,o);if(c.state>Hn)throw new Error("too late; already running");return c}function G(n,o){var c=n.__transition;if(!c||!(c=c[o]))throw new Error("transition not found");return c}function Fo(n,o,c){var r=n.__transition,i;r[o]=c,c.timer=Fr(l,0,c.time);function l(f){c.state=Se,c.timer.restart(s,c.delay,c.time),c.delay<=f&&s(f-c.delay)}function s(f){var e,t,u,a;if(c.state!==Se)return d();for(e in r)if(a=r[e],a.name===c.name){if(a.state===Hn)return Me(s);a.state===je?(a.state=Bn,a.timer.stop(),a.on.call("interrupt",n,n.__data__,a.index,a.group),delete r[e]):+e<o&&(a.state=Bn,a.timer.stop(),a.on.call("cancel",n,n.__data__,a.index,a.group),delete r[e])}if(Me(function(){c.state===Hn&&(c.state=je,c.timer.restart(h,c.delay,c.time),h(f))}),c.state=we,c.on.call("start",n,n.__data__,c.index,c.group),c.state===we){for(c.state=Hn,i=new Array(u=c.tween.length),e=0,t=-1;e<u;++e)(a=c.tween[e].value.call(n,n.__data__,c.index,c.group))&&(i[++t]=a);i.length=t+1}}function h(f){for(var e=f<c.duration?c.ease.call(null,f/c.duration):(c.timer.restart(d),c.state=ye,1),t=-1,u=i.length;++t<u;)i[t].call(n,e);c.state===ye&&(c.on.call("end",n,n.__data__,c.index,c.group),d())}function d(){c.state=Bn,c.timer.stop(),delete r[o];for(var f in r)return;delete n.__transition}}function Lo(n,o){var c=n.__transition,r,i,l=!0,s;if(c){o=o==null?null:o+"";for(s in c){if((r=c[s]).name!==o){l=!1;continue}i=r.state>we&&r.state<ye,r.state=Bn,r.timer.stop(),r.on.call(i?"interrupt":"cancel",n,n.__data__,r.index,r.group),delete c[s]}l&&delete n.__transition}}function Oo(n){return this.each(function(){Lo(this,n)})}function Ho(n,o){var c,r;return function(){var i=Y(this,n),l=i.tween;if(l!==c){r=c=l;for(var s=0,h=r.length;s<h;++s)if(r[s].name===o){r=r.slice(),r.splice(s,1);break}}i.tween=r}}function Bo(n,o,c){var r,i;if(typeof c!="function")throw new Error;return function(){var l=Y(this,n),s=l.tween;if(s!==r){i=(r=s).slice();for(var h={name:o,value:c},d=0,f=i.length;d<f;++d)if(i[d].name===o){i[d]=h;break}d===f&&i.push(h)}l.tween=i}}function Vo(n,o){var c=this._id;if(n+="",arguments.length<2){for(var r=G(this.node(),c).tween,i=0,l=r.length,s;i<l;++i)if((s=r[i]).name===n)return s.value;return null}return this.each((o==null?Ho:Bo)(c,n,o))}function Pe(n,o,c){var r=n._id;return n.each(function(){var i=Y(this,r);(i.value||(i.value={}))[o]=c.apply(this,arguments)}),function(i){return G(i,r).value[o]}}function Or(n,o){var c;return(typeof o=="number"?B:o instanceof tn?Yn:(c=tn(o))?(o=c,Yn):Ir)(n,o)}function Go(n){return function(){this.removeAttribute(n)}}function Wo(n){return function(){this.removeAttributeNS(n.space,n.local)}}function Do(n,o,c){var r,i=c+"",l;return function(){var s=this.getAttribute(n);return s===i?null:s===r?l:l=o(r=s,c)}}function Uo(n,o,c){var r,i=c+"",l;return function(){var s=this.getAttributeNS(n.space,n.local);return s===i?null:s===r?l:l=o(r=s,c)}}function Qo(n,o,c){var r,i,l;return function(){var s,h=c(this),d;return h==null?void this.removeAttribute(n):(s=this.getAttribute(n),d=h+"",s===d?null:s===r&&d===i?l:(i=d,l=o(r=s,h)))}}function Yo(n,o,c){var r,i,l;return function(){var s,h=c(this),d;return h==null?void this.removeAttributeNS(n.space,n.local):(s=this.getAttributeNS(n.space,n.local),d=h+"",s===d?null:s===r&&d===i?l:(i=d,l=o(r=s,h)))}}function Ko(n,o){var c=ne(n),r=c==="transform"?qo:Or;return this.attrTween(n,typeof o=="function"?(c.local?Yo:Qo)(c,r,Pe(this,"attr."+n,o)):o==null?(c.local?Wo:Go)(c):(c.local?Uo:Do)(c,r,o))}function Jo(n,o){return function(c){this.setAttribute(n,o.call(this,c))}}function Zo(n,o){return function(c){this.setAttributeNS(n.space,n.local,o.call(this,c))}}function Xo(n,o){var c,r;function i(){var l=o.apply(this,arguments);return l!==r&&(c=(r=l)&&Zo(n,l)),c}return i._value=o,i}function Mo(n,o){var c,r;function i(){var l=o.apply(this,arguments);return l!==r&&(c=(r=l)&&Jo(n,l)),c}return i._value=o,i}function So(n,o){var c="attr."+n;if(arguments.length<2)return(c=this.tween(c))&&c._value;if(o==null)return this.tween(c,null);if(typeof o!="function")throw new Error;var r=ne(n);return this.tween(c,(r.local?Xo:Mo)(r,o))}function jo(n,o){return function(){Re(this,n).delay=+o.apply(this,arguments)}}function nf(n,o){return o=+o,function(){Re(this,n).delay=o}}function ef(n){var o=this._id;return arguments.length?this.each((typeof n=="function"?jo:nf)(o,n)):G(this.node(),o).delay}function rf(n,o){return function(){Y(this,n).duration=+o.apply(this,arguments)}}function tf(n,o){return o=+o,function(){Y(this,n).duration=o}}function of(n){var o=this._id;return arguments.length?this.each((typeof n=="function"?rf:tf)(o,n)):G(this.node(),o).duration}function ff(n,o){if(typeof o!="function")throw new Error;return function(){Y(this,n).ease=o}}function uf(n){var o=this._id;return arguments.length?this.each(ff(o,n)):G(this.node(),o).ease}function af(n,o){return function(){var c=o.apply(this,arguments);if(typeof c!="function")throw new Error;Y(this,n).ease=c}}function cf(n){if(typeof n!="function")throw new Error;return this.each(af(this._id,n))}function sf(n){typeof n!="function"&&(n=gr(n));for(var o=this._groups,c=o.length,r=new Array(c),i=0;i<c;++i)for(var l=o[i],s=l.length,h=r[i]=[],d,f=0;f<s;++f)(d=l[f])&&n.call(d,d.__data__,f,l)&&h.push(d);return new J(r,this._parents,this._name,this._id)}function lf(n){if(n._id!==this._id)throw new Error;for(var o=this._groups,c=n._groups,r=o.length,i=c.length,l=Math.min(r,i),s=new Array(r),h=0;h<l;++h)for(var d=o[h],f=c[h],e=d.length,t=s[h]=new Array(e),u,a=0;a<e;++a)(u=d[a]||f[a])&&(t[a]=u);for(;h<r;++h)s[h]=o[h];return new J(s,this._parents,this._name,this._id)}function df(n){return(n+"").trim().split(/^|\s+/).every(function(o){var c=o.indexOf(".");return c>=0&&(o=o.slice(0,c)),!o||o==="start"})}function hf(n,o,c){var r,i,l=df(o)?Re:Y;return function(){var s=l(this,n),h=s.on;h!==r&&(i=(r=h).copy()).on(o,c),s.on=i}}function mf(n,o){var c=this._id;return arguments.length<2?G(this.node(),c).on.on(n):this.each(hf(c,n,o))}function vf(n){return function(){var o=this.parentNode;for(var c in this.__transition)if(+c!==n)return;o&&o.removeChild(this)}}function gf(){return this.on("end.remove",vf(this._id))}function pf(n){var o=this._name,c=this._id;typeof n!="function"&&(n=Ae(n));for(var r=this._groups,i=r.length,l=new Array(i),s=0;s<i;++s)for(var h=r[s],d=h.length,f=l[s]=new Array(d),e,t,u=0;u<d;++u)(e=h[u])&&(t=n.call(e,e.__data__,u,h))&&("__data__"in e&&(t.__data__=e.__data__),f[u]=t,te(f[u],o,c,u,f,G(e,c)));return new J(l,this._parents,o,c)}function wf(n){var o=this._name,c=this._id;typeof n!="function"&&(n=vr(n));for(var r=this._groups,i=r.length,l=[],s=[],h=0;h<i;++h)for(var d=r[h],f=d.length,e,t=0;t<f;++t)if(e=d[t]){for(var u=n.call(e,e.__data__,t,d),a,m=G(e,c),v=0,g=u.length;v<g;++v)(a=u[v])&&te(a,o,c,v,u,m);l.push(u),s.push(e)}return new J(l,s,o,c)}var yf=In.prototype.constructor;function bf(){return new yf(this._groups,this._parents)}function _f(n,o){var c,r,i;return function(){var l=mn(this,n),s=(this.style.removeProperty(n),mn(this,n));return l===s?null:l===c&&s===r?i:i=o(c=l,r=s)}}function Hr(n){return function(){this.style.removeProperty(n)}}function xf(n,o,c){var r,i=c+"",l;return function(){var s=mn(this,n);return s===i?null:s===r?l:l=o(r=s,c)}}function kf(n,o,c){var r,i,l;return function(){var s=mn(this,n),h=c(this),d=h+"";return h==null&&(d=h=(this.style.removeProperty(n),mn(this,n))),s===d?null:s===r&&d===i?l:(i=d,l=o(r=s,h))}}function Af(n,o){var c,r,i,l="style."+o,s="end."+l,h;return function(){var d=Y(this,n),f=d.on,e=d.value[l]==null?h||(h=Hr(o)):void 0;(f!==c||i!==e)&&(r=(c=f).copy()).on(s,i=e),d.on=r}}function Ef(n,o,c){var r=(n+="")=="transform"?$o:Or;return o==null?this.styleTween(n,_f(n,r)).on("end.style."+n,Hr(n)):typeof o=="function"?this.styleTween(n,kf(n,r,Pe(this,"style."+n,o))).each(Af(this._id,n)):this.styleTween(n,xf(n,r,o),c).on("end.style."+n,null)}function Nf(n,o,c){return function(r){this.style.setProperty(n,o.call(this,r),c)}}function $f(n,o,c){var r,i;function l(){var s=o.apply(this,arguments);return s!==i&&(r=(i=s)&&Nf(n,s,c)),r}return l._value=o,l}function qf(n,o,c){var r="style."+(n+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(o==null)return this.tween(r,null);if(typeof o!="function")throw new Error;return this.tween(r,$f(n,o,c??""))}function If(n){return function(){this.textContent=n}}function Rf(n){return function(){var o=n(this);this.textContent=o??""}}function Pf(n){return this.tween("text",typeof n=="function"?Rf(Pe(this,"text",n)):If(n==null?"":n+""))}function Tf(n){return function(o){this.textContent=n.call(this,o)}}function zf(n){var o,c;function r(){var i=n.apply(this,arguments);return i!==c&&(o=(c=i)&&Tf(i)),o}return r._value=n,r}function Cf(n){var o="text";if(arguments.length<1)return(o=this.tween(o))&&o._value;if(n==null)return this.tween(o,null);if(typeof n!="function")throw new Error;return this.tween(o,zf(n))}function Ff(){for(var n=this._name,o=this._id,c=Br(),r=this._groups,i=r.length,l=0;l<i;++l)for(var s=r[l],h=s.length,d,f=0;f<h;++f)if(d=s[f]){var e=G(d,o);te(d,n,c,f,s,{time:e.time+e.delay+e.duration,delay:0,duration:e.duration,ease:e.ease})}return new J(r,this._parents,n,c)}function Lf(){var n,o,c=this,r=c._id,i=c.size();return new Promise(function(l,s){var h={value:s},d={value:function(){--i===0&&l()}};c.each(function(){var f=Y(this,r),e=f.on;e!==n&&(o=(n=e).copy(),o._.cancel.push(h),o._.interrupt.push(h),o._.end.push(d)),f.on=o}),i===0&&l()})}var Of=0;function J(n,o,c,r){this._groups=n,this._parents=o,this._name=c,this._id=r}function Br(){return++Of}var K=In.prototype;J.prototype={constructor:J,select:pf,selectAll:wf,selectChild:K.selectChild,selectChildren:K.selectChildren,filter:sf,merge:lf,selection:bf,transition:Ff,call:K.call,nodes:K.nodes,node:K.node,size:K.size,empty:K.empty,each:K.each,on:mf,attr:Ko,attrTween:So,style:Ef,styleTween:qf,text:Pf,textTween:Cf,remove:gf,tween:Vo,delay:ef,duration:of,ease:uf,easeVarying:cf,end:Lf,[Symbol.iterator]:K[Symbol.iterator]};function Hf(n){return((n*=2)<=1?n*n*n:(n-=2)*n*n+2)/2}var Bf={time:null,delay:0,duration:250,ease:Hf};function Vf(n,o){for(var c;!(c=n.__transition)||!(c=c[o]);)if(!(n=n.parentNode))throw new Error(`transition ${o} not found`);return c}function Gf(n){var o,c;n instanceof J?(o=n._id,n=n._name):(o=Br(),(c=Bf).time=Ie(),n=n==null?null:n+"");for(var r=this._groups,i=r.length,l=0;l<i;++l)for(var s=r[l],h=s.length,d,f=0;f<h;++f)(d=s[f])&&te(d,n,o,f,s,c||Vf(d,o));return new J(r,this._parents,n,o)}In.prototype.interrupt=Oo;In.prototype.transition=Gf;const be=Math.PI,_e=2*be,nn=1e-6,Wf=_e-nn;function Vr(n){this._+=n[0];for(let o=1,c=n.length;o<c;++o)this._+=arguments[o]+n[o]}function Df(n){let o=Math.floor(n);if(!(o>=0))throw new Error(`invalid digits: ${n}`);if(o>15)return Vr;const c=10**o;return function(r){this._+=r[0];for(let i=1,l=r.length;i<l;++i)this._+=Math.round(arguments[i]*c)/c+r[i]}}class Uf{constructor(o){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=o==null?Vr:Df(o)}moveTo(o,c){this._append`M${this._x0=this._x1=+o},${this._y0=this._y1=+c}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(o,c){this._append`L${this._x1=+o},${this._y1=+c}`}quadraticCurveTo(o,c,r,i){this._append`Q${+o},${+c},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(o,c,r,i,l,s){this._append`C${+o},${+c},${+r},${+i},${this._x1=+l},${this._y1=+s}`}arcTo(o,c,r,i,l){if(o=+o,c=+c,r=+r,i=+i,l=+l,l<0)throw new Error(`negative radius: ${l}`);let s=this._x1,h=this._y1,d=r-o,f=i-c,e=s-o,t=h-c,u=e*e+t*t;if(this._x1===null)this._append`M${this._x1=o},${this._y1=c}`;else if(u>nn)if(!(Math.abs(t*d-f*e)>nn)||!l)this._append`L${this._x1=o},${this._y1=c}`;else{let a=r-s,m=i-h,v=d*d+f*f,g=a*a+m*m,w=Math.sqrt(v),y=Math.sqrt(u),p=l*Math.tan((be-Math.acos((v+u-g)/(2*w*y)))/2),b=p/y,_=p/w;Math.abs(b-1)>nn&&this._append`L${o+b*e},${c+b*t}`,this._append`A${l},${l},0,0,${+(t*a>e*m)},${this._x1=o+_*d},${this._y1=c+_*f}`}}arc(o,c,r,i,l,s){if(o=+o,c=+c,r=+r,s=!!s,r<0)throw new Error(`negative radius: ${r}`);let h=r*Math.cos(i),d=r*Math.sin(i),f=o+h,e=c+d,t=1^s,u=s?i-l:l-i;this._x1===null?this._append`M${f},${e}`:(Math.abs(this._x1-f)>nn||Math.abs(this._y1-e)>nn)&&this._append`L${f},${e}`,r&&(u<0&&(u=u%_e+_e),u>Wf?this._append`A${r},${r},0,1,${t},${o-h},${c-d}A${r},${r},0,1,${t},${this._x1=f},${this._y1=e}`:u>nn&&this._append`A${r},${r},0,${+(u>=be)},${t},${this._x1=o+r*Math.cos(l)},${this._y1=c+r*Math.sin(l)}`)}rect(o,c,r,i){this._append`M${this._x0=this._x1=+o},${this._y0=this._y1=+c}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}}function Qf(n){return Math.abs(n=Math.round(n))>=1e21?n.toLocaleString("en").replace(/,/g,""):n.toString(10)}function Xn(n,o){if((c=(n=o?n.toExponential(o-1):n.toExponential()).indexOf("e"))<0)return null;var c,r=n.slice(0,c);return[r.length>1?r[0]+r.slice(2):r,+n.slice(c+1)]}function gn(n){return n=Xn(Math.abs(n)),n?n[1]:NaN}function Yf(n,o){return function(c,r){for(var i=c.length,l=[],s=0,h=n[0],d=0;i>0&&h>0&&(d+h+1>r&&(h=Math.max(1,r-d)),l.push(c.substring(i-=h,i+h)),!((d+=h+1)>r));)h=n[s=(s+1)%n.length];return l.reverse().join(o)}}function Kf(n){return function(o){return o.replace(/[0-9]/g,function(c){return n[+c]})}}var Jf=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Mn(n){if(!(o=Jf.exec(n)))throw new Error("invalid format: "+n);var o;return new Te({fill:o[1],align:o[2],sign:o[3],symbol:o[4],zero:o[5],width:o[6],comma:o[7],precision:o[8]&&o[8].slice(1),trim:o[9],type:o[10]})}Mn.prototype=Te.prototype;function Te(n){this.fill=n.fill===void 0?" ":n.fill+"",this.align=n.align===void 0?">":n.align+"",this.sign=n.sign===void 0?"-":n.sign+"",this.symbol=n.symbol===void 0?"":n.symbol+"",this.zero=!!n.zero,this.width=n.width===void 0?void 0:+n.width,this.comma=!!n.comma,this.precision=n.precision===void 0?void 0:+n.precision,this.trim=!!n.trim,this.type=n.type===void 0?"":n.type+""}Te.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Zf(n){n:for(var o=n.length,c=1,r=-1,i;c<o;++c)switch(n[c]){case".":r=i=c;break;case"0":r===0&&(r=c),i=c;break;default:if(!+n[c])break n;r>0&&(r=0);break}return r>0?n.slice(0,r)+n.slice(i+1):n}var Gr;function Xf(n,o){var c=Xn(n,o);if(!c)return n+"";var r=c[0],i=c[1],l=i-(Gr=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,s=r.length;return l===s?r:l>s?r+new Array(l-s+1).join("0"):l>0?r.slice(0,l)+"."+r.slice(l):"0."+new Array(1-l).join("0")+Xn(n,Math.max(0,o+l-1))[0]}function nr(n,o){var c=Xn(n,o);if(!c)return n+"";var r=c[0],i=c[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const er={"%":(n,o)=>(n*100).toFixed(o),b:n=>Math.round(n).toString(2),c:n=>n+"",d:Qf,e:(n,o)=>n.toExponential(o),f:(n,o)=>n.toFixed(o),g:(n,o)=>n.toPrecision(o),o:n=>Math.round(n).toString(8),p:(n,o)=>nr(n*100,o),r:nr,s:Xf,X:n=>Math.round(n).toString(16).toUpperCase(),x:n=>Math.round(n).toString(16)};function rr(n){return n}var tr=Array.prototype.map,ir=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Mf(n){var o=n.grouping===void 0||n.thousands===void 0?rr:Yf(tr.call(n.grouping,Number),n.thousands+""),c=n.currency===void 0?"":n.currency[0]+"",r=n.currency===void 0?"":n.currency[1]+"",i=n.decimal===void 0?".":n.decimal+"",l=n.numerals===void 0?rr:Kf(tr.call(n.numerals,String)),s=n.percent===void 0?"%":n.percent+"",h=n.minus===void 0?"−":n.minus+"",d=n.nan===void 0?"NaN":n.nan+"";function f(t){t=Mn(t);var u=t.fill,a=t.align,m=t.sign,v=t.symbol,g=t.zero,w=t.width,y=t.comma,p=t.precision,b=t.trim,_=t.type;_==="n"?(y=!0,_="g"):er[_]||(p===void 0&&(p=12),b=!0,_="g"),(g||u==="0"&&a==="=")&&(g=!0,u="0",a="=");var x=v==="$"?c:v==="#"&&/[boxX]/.test(_)?"0"+_.toLowerCase():"",k=v==="$"?r:/[%p]/.test(_)?s:"",A=er[_],N=/[defgprs%]/.test(_);p=p===void 0?6:/[gprs]/.test(_)?Math.max(1,Math.min(21,p)):Math.max(0,Math.min(20,p));function $(E){var q=x,I=k,R,W,H;if(_==="c")I=A(E)+I,E="";else{E=+E;var P=E<0||1/E<0;if(E=isNaN(E)?d:A(Math.abs(E),p),b&&(E=Zf(E)),P&&+E==0&&m!=="+"&&(P=!1),q=(P?m==="("?m:h:m==="-"||m==="("?"":m)+q,I=(_==="s"?ir[8+Gr/3]:"")+I+(P&&m==="("?")":""),N){for(R=-1,W=E.length;++R<W;)if(H=E.charCodeAt(R),48>H||H>57){I=(H===46?i+E.slice(R+1):E.slice(R))+I,E=E.slice(0,R);break}}}y&&!g&&(E=o(E,1/0));var L=q.length+E.length+I.length,T=L<w?new Array(w-L+1).join(u):"";switch(y&&g&&(E=o(T+E,T.length?w-I.length:1/0),T=""),a){case"<":E=q+E+I+T;break;case"=":E=q+T+E+I;break;case"^":E=T.slice(0,L=T.length>>1)+q+E+I+T.slice(L);break;default:E=T+q+E+I;break}return l(E)}return $.toString=function(){return t+""},$}function e(t,u){var a=f((t=Mn(t),t.type="f",t)),m=Math.max(-8,Math.min(8,Math.floor(gn(u)/3)))*3,v=Math.pow(10,-m),g=ir[8+m/3];return function(w){return a(v*w)+g}}return{format:f,formatPrefix:e}}var Cn,ze,Wr;Sf({thousands:",",grouping:[3],currency:["$",""]});function Sf(n){return Cn=Mf(n),ze=Cn.format,Wr=Cn.formatPrefix,Cn}function jf(n){return Math.max(0,-gn(Math.abs(n)))}function nu(n,o){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(gn(o)/3)))*3-gn(Math.abs(n)))}function eu(n,o){return n=Math.abs(n),o=Math.abs(o)-n,Math.max(0,gn(o)-gn(n))+1}function ru(n,o){switch(arguments.length){case 0:break;case 1:this.range(n);break;default:this.range(o).domain(n);break}return this}function tu(n,o){switch(arguments.length){case 0:break;case 1:{typeof n=="function"?this.interpolator(n):this.range(n);break}default:{this.domain(n),typeof o=="function"?this.interpolator(o):this.range(o);break}}return this}function iu(n){return function(){return n}}function ou(n){return+n}var or=[0,1];function M(n){return n}function xe(n,o){return(o-=n=+n)?function(c){return(c-n)/o}:iu(isNaN(o)?NaN:.5)}function fu(n,o){var c;return n>o&&(c=n,n=o,o=c),function(r){return Math.max(n,Math.min(o,r))}}function uu(n,o,c){var r=n[0],i=n[1],l=o[0],s=o[1];return i<r?(r=xe(i,r),l=c(s,l)):(r=xe(r,i),l=c(l,s)),function(h){return l(r(h))}}function au(n,o,c){var r=Math.min(n.length,o.length)-1,i=new Array(r),l=new Array(r),s=-1;for(n[r]<n[0]&&(n=n.slice().reverse(),o=o.slice().reverse());++s<r;)i[s]=xe(n[s],n[s+1]),l[s]=c(o[s],o[s+1]);return function(h){var d=sr(n,h,1,r)-1;return l[d](i[d](h))}}function cu(n,o){return o.domain(n.domain()).range(n.range()).interpolate(n.interpolate()).clamp(n.clamp()).unknown(n.unknown())}function su(){var n=or,o=or,c=ee,r,i,l,s=M,h,d,f;function e(){var u=Math.min(n.length,o.length);return s!==M&&(s=fu(n[0],n[u-1])),h=u>2?au:uu,d=f=null,t}function t(u){return u==null||isNaN(u=+u)?l:(d||(d=h(n.map(r),o,c)))(r(s(u)))}return t.invert=function(u){return s(i((f||(f=h(o,n.map(r),B)))(u)))},t.domain=function(u){return arguments.length?(n=Array.from(u,ou),e()):n.slice()},t.range=function(u){return arguments.length?(o=Array.from(u),e()):o.slice()},t.rangeRound=function(u){return o=Array.from(u),c=Rr,e()},t.clamp=function(u){return arguments.length?(s=u?!0:M,e()):s!==M},t.interpolate=function(u){return arguments.length?(c=u,e()):c},t.unknown=function(u){return arguments.length?(l=u,t):l},function(u,a){return r=u,i=a,e()}}function lu(){return su()(M,M)}function du(n,o,c,r){var i=at(n,o,c),l;switch(r=Mn(r??",f"),r.type){case"s":{var s=Math.max(Math.abs(n),Math.abs(o));return r.precision==null&&!isNaN(l=nu(i,s))&&(r.precision=l),Wr(r,s)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(l=eu(i,Math.max(Math.abs(n),Math.abs(o))))&&(r.precision=l-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(l=jf(i))&&(r.precision=l-(r.type==="%")*2);break}}return ze(r)}function Dr(n){var o=n.domain;return n.ticks=function(c){var r=o();return lr(r[0],r[r.length-1],c??10)},n.tickFormat=function(c,r){var i=o();return du(i[0],i[i.length-1],c??10,r)},n.nice=function(c){c==null&&(c=10);var r=o(),i=0,l=r.length-1,s=r[i],h=r[l],d,f,e=10;for(h<s&&(f=s,s=h,h=f,f=i,i=l,l=f);e-- >0;){if(f=hn(s,h,c),f===d)return r[i]=s,r[l]=h,o(r);if(f>0)s=Math.floor(s/f)*f,h=Math.ceil(h/f)*f;else if(f<0)s=Math.ceil(s*f)/f,h=Math.floor(h*f)/f;else break;d=f}return n},n}function fn(){var n=lu();return n.copy=function(){return cu(n,fn())},ru.apply(n,arguments),Dr(n)}function hu(){var n=0,o=1,c,r,i,l,s=M,h=!1,d;function f(t){return t==null||isNaN(t=+t)?d:s(i===0?.5:(t=(l(t)-c)*i,h?Math.max(0,Math.min(1,t)):t))}f.domain=function(t){return arguments.length?([n,o]=t,c=l(n=+n),r=l(o=+o),i=c===r?0:1/(r-c),f):[n,o]},f.clamp=function(t){return arguments.length?(h=!!t,f):h},f.interpolator=function(t){return arguments.length?(s=t,f):s};function e(t){return function(u){var a,m;return arguments.length?([a,m]=u,s=t(a,m),f):[s(0),s(1)]}}return f.range=e(ee),f.rangeRound=e(Rr),f.unknown=function(t){return arguments.length?(d=t,f):d},function(t){return l=t,c=t(n),r=t(o),i=c===r?0:1/(r-c),f}}function mu(n,o){return o.domain(n.domain()).interpolator(n.interpolator()).clamp(n.clamp()).unknown(n.unknown())}function cn(){var n=Dr(hu()(M));return n.copy=function(){return mu(n,cn())},tu.apply(n,arguments)}function ie(n){for(var o=n.length/6|0,c=new Array(o),r=0;r<o;)c[r]="#"+n.slice(r*6,++r*6);return c}function vu(n){return n=Math.max(0,Math.min(1,n)),"rgb("+Math.max(0,Math.min(255,Math.round(-4.54-n*(35.34-n*(2381.73-n*(6402.7-n*(7024.72-n*2710.57)))))))+", "+Math.max(0,Math.min(255,Math.round(32.49+n*(170.73+n*(52.82-n*(131.46-n*(176.58-n*67.37)))))))+", "+Math.max(0,Math.min(255,Math.round(81.24+n*(442.36-n*(2482.43-n*(6167.24-n*(6614.94-n*2475.67)))))))+")"}function oe(n){var o=n.length;return function(c){return n[Math.max(0,Math.min(o-1,Math.floor(c*o)))]}}const gu=oe(ie("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725"));var pu=oe(ie("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),wu=oe(ie("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),yu=oe(ie("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));function an(n){return function(){return n}}function bu(n){let o=3;return n.digits=function(c){if(!arguments.length)return o;if(c==null)o=null;else{const r=Math.floor(c);if(!(r>=0))throw new RangeError(`invalid digits: ${c}`);o=r}return n},()=>new Uf(o)}function _u(n){return typeof n=="object"&&"length"in n?n:Array.from(n)}function Ur(n){this._context=n}Ur.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(n,o){switch(n=+n,o=+o,this._point){case 0:this._point=1,this._line?this._context.lineTo(n,o):this._context.moveTo(n,o);break;case 1:this._point=2;default:this._context.lineTo(n,o);break}}};function xu(n){return new Ur(n)}function ku(n){return n[0]}function Au(n){return n[1]}function Qr(n,o){var c=an(!0),r=null,i=xu,l=null,s=bu(h);n=typeof n=="function"?n:n===void 0?ku:an(n),o=typeof o=="function"?o:o===void 0?Au:an(o);function h(d){var f,e=(d=_u(d)).length,t,u=!1,a;for(r==null&&(l=i(a=s())),f=0;f<=e;++f)!(f<e&&c(t=d[f],f,d))===u&&((u=!u)?l.lineStart():l.lineEnd()),u&&l.point(+n(t,f,d),+o(t,f,d));if(a)return l=null,a+""||null}return h.x=function(d){return arguments.length?(n=typeof d=="function"?d:an(+d),h):n},h.y=function(d){return arguments.length?(o=typeof d=="function"?d:an(+d),h):o},h.defined=function(d){return arguments.length?(c=typeof d=="function"?d:an(!!d),h):c},h.curve=function(d){return arguments.length?(i=d,r!=null&&(l=i(r)),h):i},h.context=function(d){return arguments.length?(d==null?r=l=null:l=i(r=d),h):r},h}function An(n,o,c){this.k=n,this.x=o,this.y=c}An.prototype={constructor:An,scale:function(n){return n===1?this:new An(this.k*n,this.x,this.y)},translate:function(n,o){return n===0&o===0?this:new An(this.k,this.x+this.k*n,this.y+this.k*o)},apply:function(n){return[n[0]*this.k+this.x,n[1]*this.k+this.y]},applyX:function(n){return n*this.k+this.x},applyY:function(n){return n*this.k+this.y},invert:function(n){return[(n[0]-this.x)/this.k,(n[1]-this.y)/this.k]},invertX:function(n){return(n-this.x)/this.k},invertY:function(n){return(n-this.y)/this.k},rescaleX:function(n){return n.copy().domain(n.range().map(this.invertX,this).map(n.invert,n))},rescaleY:function(n){return n.copy().domain(n.range().map(this.invertY,this).map(n.invert,n))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};An.prototype;var Fn={};/**
 * k-d Tree JavaScript - V 1.01
 *
 * https://github.com/ubilabs/kd-tree-javascript
 *
 * @author Mircea Pricop <pricop@ubilabs.net>, 2012
 * @author Martin Kleppe <kleppe@ubilabs.net>, 2012
 * @author Ubilabs http://ubilabs.net, 2012
 * @license MIT License <http://www.opensource.org/licenses/mit-license.php>
 */var fr;function Eu(){return fr||(fr=1,function(n){(function(o,c){c(n)})(Fn,function(o){function c(i,l,s){this.obj=i,this.left=null,this.right=null,this.parent=s,this.dimension=l}function r(i){this.content=[],this.scoreFunction=i}r.prototype={push:function(i){this.content.push(i),this.bubbleUp(this.content.length-1)},pop:function(){var i=this.content[0],l=this.content.pop();return this.content.length>0&&(this.content[0]=l,this.sinkDown(0)),i},peek:function(){return this.content[0]},remove:function(i){for(var l=this.content.length,s=0;s<l;s++)if(this.content[s]==i){var h=this.content.pop();return void(s!=l-1&&(this.content[s]=h,this.scoreFunction(h)<this.scoreFunction(i)?this.bubbleUp(s):this.sinkDown(s)))}throw new Error("Node not found.")},size:function(){return this.content.length},bubbleUp:function(i){for(var l=this.content[i];i>0;){var s=Math.floor((i+1)/2)-1,h=this.content[s];if(!(this.scoreFunction(l)<this.scoreFunction(h)))break;this.content[s]=l,this.content[i]=h,i=s}},sinkDown:function(i){for(var l=this.content.length,s=this.content[i],h=this.scoreFunction(s);;){var d=2*(i+1),f=d-1,e=null;if(f<l){var t=this.content[f],u=this.scoreFunction(t);u<h&&(e=f)}if(d<l){var a=this.content[d];this.scoreFunction(a)<(e==null?h:u)&&(e=d)}if(e==null)break;this.content[i]=this.content[e],this.content[e]=s,i=e}}},o.kdTree=function(i,l,s){function h(f,e,t){var u,a,m=e%s.length;return f.length===0?null:f.length===1?new c(f[0],m,t):(f.sort(function(v,g){return v[s[m]]-g[s[m]]}),u=Math.floor(f.length/2),a=new c(f[u],m,t),a.left=h(f.slice(0,u),e+1,a),a.right=h(f.slice(u+1),e+1,a),a)}var d=this;Array.isArray(i)?this.root=h(i,0,null):function(f){function e(t){t.left&&(t.left.parent=t,e(t.left)),t.right&&(t.right.parent=t,e(t.right))}d.root=f,e(d.root)}(i),this.toJSON=function(f){f||(f=this.root);var e=new c(f.obj,f.dimension,null);return f.left&&(e.left=d.toJSON(f.left)),f.right&&(e.right=d.toJSON(f.right)),e},this.insert=function(f){function e(m,v){if(m===null)return v;var g=s[m.dimension];return f[g]<m.obj[g]?e(m.left,m):e(m.right,m)}var t,u,a=e(this.root,null);a!==null?(t=new c(f,(a.dimension+1)%s.length,a),u=s[a.dimension],f[u]<a.obj[u]?a.left=t:a.right=t):this.root=new c(f,0,null)},this.remove=function(f){function e(a){if(a===null)return null;if(a.obj===f)return a;var m=s[a.dimension];return f[m]<a.obj[m]?e(a.left):e(a.right)}function t(a){function m(y,p){var b,_,x,k,A;return y===null?null:(b=s[p],y.dimension===p?y.left!==null?m(y.left,p):y:(_=y.obj[b],x=m(y.left,p),k=m(y.right,p),A=y,x!==null&&x.obj[b]<_&&(A=x),k!==null&&k.obj[b]<A.obj[b]&&(A=k),A))}var v,g,w;if(a.left===null&&a.right===null)return a.parent===null?void(d.root=null):(w=s[a.parent.dimension],void(a.obj[w]<a.parent.obj[w]?a.parent.left=null:a.parent.right=null));a.right!==null?(g=(v=m(a.right,a.dimension)).obj,t(v),a.obj=g):(g=(v=m(a.left,a.dimension)).obj,t(v),a.right=a.left,a.left=null,a.obj=g)}var u;(u=e(d.root))!==null&&t(u)},this.nearest=function(f,e,t){function u(g){function w(N,$){v.push([N,$]),v.size()>e&&v.pop()}var y,p,b,_,x=s[g.dimension],k=l(f,g.obj),A={};for(_=0;_<s.length;_+=1)_===g.dimension?A[s[_]]=f[s[_]]:A[s[_]]=g.obj[s[_]];p=l(A,g.obj),g.right!==null||g.left!==null?(u(y=g.right===null?g.left:g.left===null?g.right:f[x]<g.obj[x]?g.left:g.right),(v.size()<e||k<v.peek()[1])&&w(g,k),(v.size()<e||Math.abs(p)<v.peek()[1])&&(b=y===g.left?g.right:g.left)!==null&&u(b)):(v.size()<e||k<v.peek()[1])&&w(g,k)}var a,m,v;if(v=new r(function(g){return-g[1]}),t)for(a=0;a<e;a+=1)v.push([null,t]);for(d.root&&u(d.root),m=[],a=0;a<Math.min(e,v.content.length);a+=1)v.content[a][0]&&m.push([v.content[a][0].obj,v.content[a][1]]);return m},this.balanceFactor=function(){function f(t){return t===null?0:Math.max(f(t.left),f(t.right))+1}function e(t){return t===null?0:e(t.left)+e(t.right)+1}return f(d.root)/(Math.log(e(d.root))/Math.log(2))}},o.BinaryHeap=r})}(Fn)),Fn}var Nu=Eu(),Vn={exports:{}},$u=Vn.exports,ur;function qu(){return ur||(ur=1,function(n,o){(function(c,r){n.exports=r()})($u,function(){var c=function(r,i){var l=Array.prototype.concat,s=Array.prototype.slice,h=Object.prototype.toString;function d(y,p){var b=y>p?y:p;return r.pow(10,17-~~(r.log(b>0?b:-b)*r.LOG10E))}var f=Array.isArray||function(p){return h.call(p)==="[object Array]"};function e(y){return h.call(y)==="[object Function]"}function t(y){return typeof y=="number"?y-y===0:!1}function u(y){return l.apply([],y)}function a(){return new a._init(arguments)}a.fn=a.prototype,a._init=function(p){if(f(p[0]))if(f(p[0][0])){e(p[1])&&(p[0]=a.map(p[0],p[1]));for(var b=0;b<p[0].length;b++)this[b]=p[0][b];this.length=p[0].length}else this[0]=e(p[1])?a.map(p[0],p[1]):p[0],this.length=1;else if(t(p[0]))this[0]=a.seq.apply(null,p),this.length=1;else{if(p[0]instanceof a)return a(p[0].toArray());this[0]=[],this.length=1}return this},a._init.prototype=a.prototype,a._init.constructor=a,a.utils={calcRdx:d,isArray:f,isFunction:e,isNumber:t,toVector:u},a._random_fn=r.random,a.setRandom=function(p){if(typeof p!="function")throw new TypeError("fn is not a function");a._random_fn=p},a.extend=function(p){var b,_;if(arguments.length===1){for(_ in p)a[_]=p[_];return this}for(b=1;b<arguments.length;b++)for(_ in arguments[b])p[_]=arguments[b][_];return p},a.rows=function(p){return p.length||1},a.cols=function(p){return p[0].length||1},a.dimensions=function(p){return{rows:a.rows(p),cols:a.cols(p)}},a.row=function(p,b){return f(b)?b.map(function(_){return a.row(p,_)}):p[b]},a.rowa=function(p,b){return a.row(p,b)},a.col=function(p,b){if(f(b)){var _=a.arange(p.length).map(function(){return new Array(b.length)});return b.forEach(function(A,N){a.arange(p.length).forEach(function($){_[$][N]=p[$][A]})}),_}for(var x=new Array(p.length),k=0;k<p.length;k++)x[k]=[p[k][b]];return x},a.cola=function(p,b){return a.col(p,b).map(function(_){return _[0]})},a.diag=function(p){for(var b=a.rows(p),_=new Array(b),x=0;x<b;x++)_[x]=[p[x][x]];return _},a.antidiag=function(p){for(var b=a.rows(p)-1,_=new Array(b),x=0;b>=0;b--,x++)_[x]=[p[x][b]];return _},a.transpose=function(p){var b=[],_,x,k,A,N;for(f(p[0])||(p=[p]),x=p.length,k=p[0].length,N=0;N<k;N++){for(_=new Array(x),A=0;A<x;A++)_[A]=p[A][N];b.push(_)}return b.length===1?b[0]:b},a.map=function(p,b,_){var x,k,A,N,$;for(f(p[0])||(p=[p]),k=p.length,A=p[0].length,N=_?p:new Array(k),x=0;x<k;x++)for(N[x]||(N[x]=new Array(A)),$=0;$<A;$++)N[x][$]=b(p[x][$],x,$);return N.length===1?N[0]:N},a.cumreduce=function(p,b,_){var x,k,A,N,$;for(f(p[0])||(p=[p]),k=p.length,A=p[0].length,N=_?p:new Array(k),x=0;x<k;x++)for(N[x]||(N[x]=new Array(A)),A>0&&(N[x][0]=p[x][0]),$=1;$<A;$++)N[x][$]=b(N[x][$-1],p[x][$]);return N.length===1?N[0]:N},a.alter=function(p,b){return a.map(p,b,!0)},a.create=function(p,b,_){var x=new Array(p),k,A;for(e(b)&&(_=b,b=p),k=0;k<p;k++)for(x[k]=new Array(b),A=0;A<b;A++)x[k][A]=_(k,A);return x};function m(){return 0}a.zeros=function(p,b){return t(b)||(b=p),a.create(p,b,m)};function v(){return 1}a.ones=function(p,b){return t(b)||(b=p),a.create(p,b,v)},a.rand=function(p,b){return t(b)||(b=p),a.create(p,b,a._random_fn)};function g(y,p){return y===p?1:0}a.identity=function(p,b){return t(b)||(b=p),a.create(p,b,g)},a.symmetric=function(p){var b=p.length,_,x;if(p.length!==p[0].length)return!1;for(_=0;_<b;_++)for(x=0;x<b;x++)if(p[x][_]!==p[_][x])return!1;return!0},a.clear=function(p){return a.alter(p,m)},a.seq=function(p,b,_,x){e(x)||(x=!1);var k=[],A=d(p,b),N=(b*A-p*A)/((_-1)*A),$=p,E;for(E=0;$<=b&&E<_;E++,$=(p*A+N*A*E)/A)k.push(x?x($,E):$);return k},a.arange=function(p,b,_){var x=[],k;if(_=_||1,b===i&&(b=p,p=0),p===b||_===0)return[];if(p<b&&_<0)return[];if(p>b&&_>0)return[];if(_>0)for(k=p;k<b;k+=_)x.push(k);else for(k=p;k>b;k+=_)x.push(k);return x},a.slice=function(){function y(b,_,x,k){var A,N=[],$=b.length;if(_===i&&x===i&&k===i)return a.copy(b);if(_=_||0,x=x||b.length,_=_>=0?_:$+_,x=x>=0?x:$+x,k=k||1,_===x||k===0)return[];if(_<x&&k<0)return[];if(_>x&&k>0)return[];if(k>0)for(A=_;A<x;A+=k)N.push(b[A]);else for(A=_;A>x;A+=k)N.push(b[A]);return N}function p(b,_){var x,k;if(_=_||{},t(_.row)){if(t(_.col))return b[_.row][_.col];var A=a.rowa(b,_.row);return x=_.col||{},y(A,x.start,x.end,x.step)}if(t(_.col)){var N=a.cola(b,_.col);return k=_.row||{},y(N,k.start,k.end,k.step)}k=_.row||{},x=_.col||{};var $=y(b,k.start,k.end,k.step);return $.map(function(E){return y(E,x.start,x.end,x.step)})}return p}(),a.sliceAssign=function(p,b,_){var x,k;if(t(b.row)){if(t(b.col))return p[b.row][b.col]=_;b.col=b.col||{},b.col.start=b.col.start||0,b.col.end=b.col.end||p[0].length,b.col.step=b.col.step||1,x=a.arange(b.col.start,r.min(p.length,b.col.end),b.col.step);var A=b.row;return x.forEach(function($,E){p[A][$]=_[E]}),p}if(t(b.col)){b.row=b.row||{},b.row.start=b.row.start||0,b.row.end=b.row.end||p.length,b.row.step=b.row.step||1,k=a.arange(b.row.start,r.min(p[0].length,b.row.end),b.row.step);var N=b.col;return k.forEach(function($,E){p[$][N]=_[E]}),p}return _[0].length===i&&(_=[_]),b.row.start=b.row.start||0,b.row.end=b.row.end||p.length,b.row.step=b.row.step||1,b.col.start=b.col.start||0,b.col.end=b.col.end||p[0].length,b.col.step=b.col.step||1,k=a.arange(b.row.start,r.min(p.length,b.row.end),b.row.step),x=a.arange(b.col.start,r.min(p[0].length,b.col.end),b.col.step),k.forEach(function($,E){x.forEach(function(q,I){p[$][q]=_[E][I]})}),p},a.diagonal=function(p){var b=a.zeros(p.length,p.length);return p.forEach(function(_,x){b[x][x]=_}),b},a.copy=function(p){return p.map(function(b){return t(b)?b:b.map(function(_){return _})})};var w=a.prototype;return w.length=0,w.push=Array.prototype.push,w.sort=Array.prototype.sort,w.splice=Array.prototype.splice,w.slice=Array.prototype.slice,w.toArray=function(){return this.length>1?s.call(this):s.call(this)[0]},w.map=function(p,b){return a(a.map(this,p,b))},w.cumreduce=function(p,b){return a(a.cumreduce(this,p,b))},w.alter=function(p){return a.alter(this,p),this},function(y){for(var p=0;p<y.length;p++)(function(b){w[b]=function(_){var x=this,k;return _?(setTimeout(function(){_.call(x,w[b].call(x))}),this):(k=a[b](this),f(k)?a(k):k)}})(y[p])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(y){for(var p=0;p<y.length;p++)(function(b){w[b]=function(_,x){var k=this;return x?(setTimeout(function(){x.call(k,w[b].call(k,_))}),this):a(a[b](this,_))}})(y[p])}("row col".split(" ")),function(y){for(var p=0;p<y.length;p++)(function(b){w[b]=function(){return a(a[b].apply(null,arguments))}})(y[p])}("create zeros ones rand identity".split(" ")),a}(Math);return function(r,i){var l=r.utils.isFunction;function s(f,e){return f-e}function h(f,e,t){return i.max(e,i.min(f,t))}r.sum=function(e){for(var t=0,u=e.length;--u>=0;)t+=e[u];return t},r.sumsqrd=function(e){for(var t=0,u=e.length;--u>=0;)t+=e[u]*e[u];return t},r.sumsqerr=function(e){for(var t=r.mean(e),u=0,a=e.length,m;--a>=0;)m=e[a]-t,u+=m*m;return u},r.sumrow=function(e){for(var t=0,u=e.length;--u>=0;)t+=e[u];return t},r.product=function(e){for(var t=1,u=e.length;--u>=0;)t*=e[u];return t},r.min=function(e){for(var t=e[0],u=0;++u<e.length;)e[u]<t&&(t=e[u]);return t},r.max=function(e){for(var t=e[0],u=0;++u<e.length;)e[u]>t&&(t=e[u]);return t},r.unique=function(e){for(var t={},u=[],a=0;a<e.length;a++)t[e[a]]||(t[e[a]]=!0,u.push(e[a]));return u},r.mean=function(e){return r.sum(e)/e.length},r.meansqerr=function(e){return r.sumsqerr(e)/e.length},r.geomean=function(e){var t=e.map(i.log),u=r.mean(t);return i.exp(u)},r.median=function(e){var t=e.length,u=e.slice().sort(s);return t&1?u[t/2|0]:(u[t/2-1]+u[t/2])/2},r.cumsum=function(e){return r.cumreduce(e,function(t,u){return t+u})},r.cumprod=function(e){return r.cumreduce(e,function(t,u){return t*u})},r.diff=function(e){var t=[],u=e.length,a;for(a=1;a<u;a++)t.push(e[a]-e[a-1]);return t},r.rank=function(f){var e,t=[],u={};for(e=0;e<f.length;e++){var a=f[e];u[a]?u[a]++:(u[a]=1,t.push(a))}var m=t.sort(s),v={},g=1;for(e=0;e<m.length;e++){var a=m[e],w=u[a],y=g,p=g+w-1,b=(y+p)/2;v[a]=b,g+=w}return f.map(function(_){return v[_]})},r.mode=function(e){var t=e.length,u=e.slice().sort(s),a=1,m=0,v=0,g=[],w;for(w=0;w<t;w++)u[w]===u[w+1]?a++:(a>m?(g=[u[w]],m=a,v=0):a===m&&(g.push(u[w]),v++),a=1);return v===0?g[0]:g},r.range=function(e){return r.max(e)-r.min(e)},r.variance=function(e,t){return r.sumsqerr(e)/(e.length-(t?1:0))},r.pooledvariance=function(e){var t=e.reduce(function(a,m){return a+r.sumsqerr(m)},0),u=e.reduce(function(a,m){return a+m.length},0);return t/(u-e.length)},r.deviation=function(f){for(var e=r.mean(f),t=f.length,u=new Array(t),a=0;a<t;a++)u[a]=f[a]-e;return u},r.stdev=function(e,t){return i.sqrt(r.variance(e,t))},r.pooledstdev=function(e){return i.sqrt(r.pooledvariance(e))},r.meandev=function(e){for(var t=r.mean(e),u=[],a=e.length-1;a>=0;a--)u.push(i.abs(e[a]-t));return r.mean(u)},r.meddev=function(e){for(var t=r.median(e),u=[],a=e.length-1;a>=0;a--)u.push(i.abs(e[a]-t));return r.median(u)},r.coeffvar=function(e){return r.stdev(e)/r.mean(e)},r.quartiles=function(e){var t=e.length,u=e.slice().sort(s);return[u[i.round(t/4)-1],u[i.round(t/2)-1],u[i.round(t*3/4)-1]]},r.quantiles=function(e,t,u,a){var m=e.slice().sort(s),v=[t.length],g=e.length,w,y,p,b,_,x;for(typeof u>"u"&&(u=3/8),typeof a>"u"&&(a=3/8),w=0;w<t.length;w++)y=t[w],p=u+y*(1-u-a),b=g*y+p,_=i.floor(h(b,1,g-1)),x=h(b-_,0,1),v[w]=(1-x)*m[_-1]+x*m[_];return v},r.percentile=function(e,t,u){var a=e.slice().sort(s),m=t*(a.length+(u?1:-1))+(u?0:1),v=parseInt(m),g=m-v;return v+1<a.length?a[v-1]+g*(a[v]-a[v-1]):a[v-1]},r.percentileOfScore=function(e,t,u){var a=0,m=e.length,v=!1,g,w;for(u==="strict"&&(v=!0),w=0;w<m;w++)g=e[w],(v&&g<t||!v&&g<=t)&&a++;return a/m},r.histogram=function(e,t){t=t||4;var u=r.min(e),a=(r.max(e)-u)/t,m=e.length,v=[],g;for(g=0;g<t;g++)v[g]=0;for(g=0;g<m;g++)v[i.min(i.floor((e[g]-u)/a),t-1)]+=1;return v},r.covariance=function(e,t){var u=r.mean(e),a=r.mean(t),m=e.length,v=new Array(m),g;for(g=0;g<m;g++)v[g]=(e[g]-u)*(t[g]-a);return r.sum(v)/(m-1)},r.corrcoeff=function(e,t){return r.covariance(e,t)/r.stdev(e,1)/r.stdev(t,1)},r.spearmancoeff=function(f,e){return f=r.rank(f),e=r.rank(e),r.corrcoeff(f,e)},r.stanMoment=function(e,t){for(var u=r.mean(e),a=r.stdev(e),m=e.length,v=0,g=0;g<m;g++)v+=i.pow((e[g]-u)/a,t);return v/e.length},r.skewness=function(e){return r.stanMoment(e,3)},r.kurtosis=function(e){return r.stanMoment(e,4)-3};var d=r.prototype;(function(f){for(var e=0;e<f.length;e++)(function(t){d[t]=function(u,a){var m=[],v=0,g=this;if(l(u)&&(a=u,u=!1),a)return setTimeout(function(){a.call(g,d[t].call(g,u))}),this;if(this.length>1){for(g=u===!0?this:this.transpose();v<g.length;v++)m[v]=r[t](g[v]);return m}return r[t](this[0],u)}})(f[e])})("cumsum cumprod".split(" ")),function(f){for(var e=0;e<f.length;e++)(function(t){d[t]=function(u,a){var m=[],v=0,g=this;if(l(u)&&(a=u,u=!1),a)return setTimeout(function(){a.call(g,d[t].call(g,u))}),this;if(this.length>1){for(t!=="sumrow"&&(g=u===!0?this:this.transpose());v<g.length;v++)m[v]=r[t](g[v]);return u===!0?r[t](r.utils.toVector(m)):m}return r[t](this[0],u)}})(f[e])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(f){for(var e=0;e<f.length;e++)(function(t){d[t]=function(){var u=[],a=0,m=this,v=Array.prototype.slice.call(arguments),g;if(l(v[v.length-1])){g=v[v.length-1];var w=v.slice(0,v.length-1);return setTimeout(function(){g.call(m,d[t].apply(m,w))}),this}else{g=void 0;var y=function(b){return r[t].apply(m,[b].concat(v))}}if(this.length>1){for(m=m.transpose();a<m.length;a++)u[a]=y(m[a]);return u}return y(this[0])}})(f[e])}("quantiles percentileOfScore".split(" "))}(c,Math),function(r,i){r.gammaln=function(s){var h=0,d=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],f=1.000000000190015,e,t,u;for(u=(t=e=s)+5.5,u-=(e+.5)*i.log(u);h<6;h++)f+=d[h]/++t;return i.log(2.5066282746310007*f/e)-u},r.loggam=function(s){var h,d,f,e,t,u,a,m=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(h=s,a=0,s==1||s==2)return 0;for(s<=7&&(a=i.floor(7-s),h=s+a),d=1/(h*h),f=2*i.PI,t=m[9],u=8;u>=0;u--)t*=d,t+=m[u];if(e=t/h+.5*i.log(f)+(h-.5)*i.log(h)-h,s<=7)for(u=1;u<=a;u++)e-=i.log(h-1),h-=1;return e},r.gammafn=function(s){var h=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],d=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],f=!1,e=0,t=0,u=0,a=s,m,v,g,w;if(s>171.6243769536076)return 1/0;if(a<=0)if(w=a%1+36e-17,w)f=(a&1?-1:1)*i.PI/i.sin(i.PI*w),a=1-a;else return 1/0;for(g=a,a<1?v=a++:v=(a-=e=(a|0)-1)-1,m=0;m<8;++m)u=(u+h[m])*v,t=t*v+d[m];if(w=u/t+1,g<a)w/=g;else if(g>a)for(m=0;m<e;++m)w*=a,a++;return f&&(w=f/w),w},r.gammap=function(s,h){return r.lowRegGamma(s,h)*r.gammafn(s)},r.lowRegGamma=function(s,h){var d=r.gammaln(s),f=s,e=1/s,t=e,u=h+1-s,a=1/1e-30,m=1/u,v=m,g=1,w=-~(i.log(s>=1?s:1/s)*8.5+s*.4+17),y;if(h<0||s<=0)return NaN;if(h<s+1){for(;g<=w;g++)e+=t*=h/++f;return e*i.exp(-h+s*i.log(h)-d)}for(;g<=w;g++)y=-g*(g-s),u+=2,m=y*m+u,a=u+y/a,m=1/m,v*=m*a;return 1-v*i.exp(-h+s*i.log(h)-d)},r.factorialln=function(s){return s<0?NaN:r.gammaln(s+1)},r.factorial=function(s){return s<0?NaN:r.gammafn(s+1)},r.combination=function(s,h){return s>170||h>170?i.exp(r.combinationln(s,h)):r.factorial(s)/r.factorial(h)/r.factorial(s-h)},r.combinationln=function(s,h){return r.factorialln(s)-r.factorialln(h)-r.factorialln(s-h)},r.permutation=function(s,h){return r.factorial(s)/r.factorial(s-h)},r.betafn=function(s,h){if(!(s<=0||h<=0))return s+h>170?i.exp(r.betaln(s,h)):r.gammafn(s)*r.gammafn(h)/r.gammafn(s+h)},r.betaln=function(s,h){return r.gammaln(s)+r.gammaln(h)-r.gammaln(s+h)},r.betacf=function(s,h,d){var f=1e-30,e=1,t=h+d,u=h+1,a=h-1,m=1,v=1-t*s/u,g,w,y,p;for(i.abs(v)<f&&(v=f),v=1/v,p=v;e<=100&&(g=2*e,w=e*(d-e)*s/((a+g)*(h+g)),v=1+w*v,i.abs(v)<f&&(v=f),m=1+w/m,i.abs(m)<f&&(m=f),v=1/v,p*=v*m,w=-(h+e)*(t+e)*s/((h+g)*(u+g)),v=1+w*v,i.abs(v)<f&&(v=f),m=1+w/m,i.abs(m)<f&&(m=f),v=1/v,y=v*m,p*=y,!(i.abs(y-1)<3e-7));e++);return p},r.gammapinv=function(s,h){var d=0,f=h-1,e=1e-8,t=r.gammaln(h),u,a,m,v,g,w,y;if(s>=1)return i.max(100,h+100*i.sqrt(h));if(s<=0)return 0;for(h>1?(w=i.log(f),y=i.exp(f*(w-1)-t),g=s<.5?s:1-s,m=i.sqrt(-2*i.log(g)),u=(2.30753+m*.27061)/(1+m*(.99229+m*.04481))-m,s<.5&&(u=-u),u=i.max(.001,h*i.pow(1-1/(9*h)-u/(3*i.sqrt(h)),3))):(m=1-h*(.253+h*.12),s<m?u=i.pow(s/m,1/h):u=1-i.log(1-(s-m)/(1-m)));d<12;d++){if(u<=0)return 0;if(a=r.lowRegGamma(h,u)-s,h>1?m=y*i.exp(-(u-f)+f*(i.log(u)-w)):m=i.exp(-u+f*i.log(u)-t),v=a/m,u-=m=v/(1-.5*i.min(1,v*((h-1)/u-1))),u<=0&&(u=.5*(u+m)),i.abs(m)<e*u)break}return u},r.erf=function(s){var h=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],d=h.length-1,f=!1,e=0,t=0,u,a,m,v;for(s<0&&(s=-s,f=!0),u=2/(2+s),a=4*u-2;d>0;d--)m=e,e=a*e-t+h[d],t=m;return v=u*i.exp(-s*s+.5*(h[0]+a*e)-t),f?v-1:1-v},r.erfc=function(s){return 1-r.erf(s)},r.erfcinv=function(s){var h=0,d,f,e,t;if(s>=2)return-100;if(s<=0)return 100;for(t=s<1?s:2-s,e=i.sqrt(-2*i.log(t/2)),d=-.70711*((2.30753+e*.27061)/(1+e*(.99229+e*.04481))-e);h<2;h++)f=r.erfc(d)-t,d+=f/(1.1283791670955126*i.exp(-d*d)-d*f);return s<1?d:-d},r.ibetainv=function(s,h,d){var f=1e-8,e=h-1,t=d-1,u=0,a,m,v,g,w,y,p,b,_,x,k;if(s<=0)return 0;if(s>=1)return 1;for(h>=1&&d>=1?(v=s<.5?s:1-s,g=i.sqrt(-2*i.log(v)),p=(2.30753+g*.27061)/(1+g*(.99229+g*.04481))-g,s<.5&&(p=-p),b=(p*p-3)/6,_=2/(1/(2*h-1)+1/(2*d-1)),x=p*i.sqrt(b+_)/_-(1/(2*d-1)-1/(2*h-1))*(b+5/6-2/(3*_)),p=h/(h+d*i.exp(2*x))):(a=i.log(h/(h+d)),m=i.log(d/(h+d)),g=i.exp(h*a)/h,w=i.exp(d*m)/d,x=g+w,s<g/x?p=i.pow(h*x*s,1/h):p=1-i.pow(d*x*(1-s),1/d)),k=-r.gammaln(h)-r.gammaln(d)+r.gammaln(h+d);u<10;u++){if(p===0||p===1)return p;if(y=r.ibeta(p,h,d)-s,g=i.exp(e*i.log(p)+t*i.log(1-p)+k),w=y/g,p-=g=w/(1-.5*i.min(1,w*(e/p-t/(1-p)))),p<=0&&(p=.5*(p+g)),p>=1&&(p=.5*(p+g+1)),i.abs(g)<f*p&&u>0)break}return p},r.ibeta=function(s,h,d){var f=s===0||s===1?0:i.exp(r.gammaln(h+d)-r.gammaln(h)-r.gammaln(d)+h*i.log(s)+d*i.log(1-s));return s<0||s>1?!1:s<(h+1)/(h+d+2)?f*r.betacf(s,h,d)/h:1-f*r.betacf(1-s,d,h)/d},r.randn=function(s,h){var d,f,e,t,u;if(h||(h=s),s)return r.create(s,h,function(){return r.randn()});do d=r._random_fn(),f=1.7156*(r._random_fn()-.5),e=d-.449871,t=i.abs(f)+.386595,u=e*e+t*(.196*t-.25472*e);while(u>.27597&&(u>.27846||f*f>-4*i.log(d)*d*d));return f/d},r.randg=function(s,h,d){var f=s,e,t,u,a,m,v;if(d||(d=h),s||(s=1),h)return v=r.zeros(h,d),v.alter(function(){return r.randg(s)}),v;s<1&&(s+=1),e=s-1/3,t=1/i.sqrt(9*e);do{do m=r.randn(),a=1+t*m;while(a<=0);a=a*a*a,u=r._random_fn()}while(u>1-.331*i.pow(m,4)&&i.log(u)>.5*m*m+e*(1-a+i.log(a)));if(s==f)return e*a;do u=r._random_fn();while(u===0);return i.pow(u,1/f)*e*a},function(l){for(var s=0;s<l.length;s++)(function(h){r.fn[h]=function(){return r(r.map(this,function(d){return r[h](d)}))}})(l[s])}("gammaln gammafn factorial factorialln".split(" ")),function(l){for(var s=0;s<l.length;s++)(function(h){r.fn[h]=function(){return r(r[h].apply(null,arguments))}})(l[s])}("randn".split(" "))}(c,Math),function(r,i){(function(f){for(var e=0;e<f.length;e++)(function(t){r[t]=function u(a,m,v){return this instanceof u?(this._a=a,this._b=m,this._c=v,this):new u(a,m,v)},r.fn[t]=function(u,a,m){var v=r[t](u,a,m);return v.data=this,v},r[t].prototype.sample=function(u){var a=this._a,m=this._b,v=this._c;return u?r.alter(u,function(){return r[t].sample(a,m,v)}):r[t].sample(a,m,v)},function(u){for(var a=0;a<u.length;a++)(function(m){r[t].prototype[m]=function(v){var g=this._a,w=this._b,y=this._c;return!v&&v!==0&&(v=this.data),typeof v!="number"?r.fn.map.call(v,function(p){return r[t][m](p,g,w,y)}):r[t][m](v,g,w,y)}})(u[a])}("pdf cdf inv".split(" ")),function(u){for(var a=0;a<u.length;a++)(function(m){r[t].prototype[m]=function(){return r[t][m](this._a,this._b,this._c)}})(u[a])}("mean median mode variance".split(" "))})(f[e])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),r.extend(r.beta,{pdf:function(e,t,u){return e>1||e<0?0:t==1&&u==1?1:t<512&&u<512?i.pow(e,t-1)*i.pow(1-e,u-1)/r.betafn(t,u):i.exp((t-1)*i.log(e)+(u-1)*i.log(1-e)-r.betaln(t,u))},cdf:function(e,t,u){return e>1||e<0?(e>1)*1:r.ibeta(e,t,u)},inv:function(e,t,u){return r.ibetainv(e,t,u)},mean:function(e,t){return e/(e+t)},median:function(e,t){return r.ibetainv(.5,e,t)},mode:function(e,t){return(e-1)/(e+t-2)},sample:function(e,t){var u=r.randg(e);return u/(u+r.randg(t))},variance:function(e,t){return e*t/(i.pow(e+t,2)*(e+t+1))}}),r.extend(r.centralF,{pdf:function(e,t,u){var a,m,v;return e<0?0:t<=2?e===0&&t<2?1/0:e===0&&t===2?1:1/r.betafn(t/2,u/2)*i.pow(t/u,t/2)*i.pow(e,t/2-1)*i.pow(1+t/u*e,-(t+u)/2):(a=t*e/(u+e*t),m=u/(u+e*t),v=t*m/2,v*r.binomial.pdf((t-2)/2,(t+u-2)/2,a))},cdf:function(e,t,u){return e<0?0:r.ibeta(t*e/(t*e+u),t/2,u/2)},inv:function(e,t,u){return u/(t*(1/r.ibetainv(e,t/2,u/2)-1))},mean:function(e,t){return t>2?t/(t-2):void 0},mode:function(e,t){return e>2?t*(e-2)/(e*(t+2)):void 0},sample:function(e,t){var u=r.randg(e/2)*2,a=r.randg(t/2)*2;return u/e/(a/t)},variance:function(e,t){if(!(t<=4))return 2*t*t*(e+t-2)/(e*(t-2)*(t-2)*(t-4))}}),r.extend(r.cauchy,{pdf:function(e,t,u){return u<0?0:u/(i.pow(e-t,2)+i.pow(u,2))/i.PI},cdf:function(e,t,u){return i.atan((e-t)/u)/i.PI+.5},inv:function(f,e,t){return e+t*i.tan(i.PI*(f-.5))},median:function(e){return e},mode:function(e){return e},sample:function(e,t){return r.randn()*i.sqrt(1/(2*r.randg(.5)))*t+e}}),r.extend(r.chisquare,{pdf:function(e,t){return e<0?0:e===0&&t===2?.5:i.exp((t/2-1)*i.log(e)-e/2-t/2*i.log(2)-r.gammaln(t/2))},cdf:function(e,t){return e<0?0:r.lowRegGamma(t/2,e/2)},inv:function(f,e){return 2*r.gammapinv(f,.5*e)},mean:function(f){return f},median:function(e){return e*i.pow(1-2/(9*e),3)},mode:function(e){return e-2>0?e-2:0},sample:function(e){return r.randg(e/2)*2},variance:function(e){return 2*e}}),r.extend(r.exponential,{pdf:function(e,t){return e<0?0:t*i.exp(-t*e)},cdf:function(e,t){return e<0?0:1-i.exp(-t*e)},inv:function(f,e){return-i.log(1-f)/e},mean:function(f){return 1/f},median:function(f){return 1/f*i.log(2)},mode:function(){return 0},sample:function(e){return-1/e*i.log(r._random_fn())},variance:function(f){return i.pow(f,-2)}}),r.extend(r.gamma,{pdf:function(e,t,u){return e<0?0:e===0&&t===1?1/u:i.exp((t-1)*i.log(e)-e/u-r.gammaln(t)-t*i.log(u))},cdf:function(e,t,u){return e<0?0:r.lowRegGamma(t,e/u)},inv:function(f,e,t){return r.gammapinv(f,e)*t},mean:function(f,e){return f*e},mode:function(e,t){if(e>1)return(e-1)*t},sample:function(e,t){return r.randg(e)*t},variance:function(e,t){return e*t*t}}),r.extend(r.invgamma,{pdf:function(e,t,u){return e<=0?0:i.exp(-(t+1)*i.log(e)-u/e-r.gammaln(t)+t*i.log(u))},cdf:function(e,t,u){return e<=0?0:1-r.lowRegGamma(t,u/e)},inv:function(f,e,t){return t/r.gammapinv(1-f,e)},mean:function(f,e){return f>1?e/(f-1):void 0},mode:function(e,t){return t/(e+1)},sample:function(e,t){return t/r.randg(e)},variance:function(e,t){if(!(e<=2))return t*t/((e-1)*(e-1)*(e-2))}}),r.extend(r.kumaraswamy,{pdf:function(e,t,u){return e===0&&t===1?u:e===1&&u===1?t:i.exp(i.log(t)+i.log(u)+(t-1)*i.log(e)+(u-1)*i.log(1-i.pow(e,t)))},cdf:function(e,t,u){return e<0?0:e>1?1:1-i.pow(1-i.pow(e,t),u)},inv:function(e,t,u){return i.pow(1-i.pow(1-e,1/u),1/t)},mean:function(f,e){return e*r.gammafn(1+1/f)*r.gammafn(e)/r.gammafn(1+1/f+e)},median:function(e,t){return i.pow(1-i.pow(2,-1/t),1/e)},mode:function(e,t){if(e>=1&&t>=1&&e!==1&&t!==1)return i.pow((e-1)/(e*t-1),1/e)},variance:function(){throw new Error("variance not yet implemented")}}),r.extend(r.lognormal,{pdf:function(e,t,u){return e<=0?0:i.exp(-i.log(e)-.5*i.log(2*i.PI)-i.log(u)-i.pow(i.log(e)-t,2)/(2*u*u))},cdf:function(e,t,u){return e<0?0:.5+.5*r.erf((i.log(e)-t)/i.sqrt(2*u*u))},inv:function(f,e,t){return i.exp(-1.4142135623730951*t*r.erfcinv(2*f)+e)},mean:function(e,t){return i.exp(e+t*t/2)},median:function(e){return i.exp(e)},mode:function(e,t){return i.exp(e-t*t)},sample:function(e,t){return i.exp(r.randn()*t+e)},variance:function(e,t){return(i.exp(t*t)-1)*i.exp(2*e+t*t)}}),r.extend(r.noncentralt,{pdf:function(e,t,u){var a=1e-14;return i.abs(u)<a?r.studentt.pdf(e,t):i.abs(e)<a?i.exp(r.gammaln((t+1)/2)-u*u/2-.5*i.log(i.PI*t)-r.gammaln(t/2)):t/e*(r.noncentralt.cdf(e*i.sqrt(1+2/t),t+2,u)-r.noncentralt.cdf(e,t,u))},cdf:function(e,t,u){var a=1e-14,m=200;if(i.abs(u)<a)return r.studentt.cdf(e,t);var v=!1;e<0&&(v=!0,u=-u);for(var g=r.normal.cdf(-u,0,1),w=a+1,y=w,p=e*e/(e*e+t),b=0,_=i.exp(-u*u/2),x=i.exp(-u*u/2-.5*i.log(2)-r.gammaln(3/2))*u;b<m||y>a||w>a;)y=w,b>0&&(_*=u*u/(2*b),x*=u*u/(2*(b+1/2))),w=_*r.beta.cdf(p,b+.5,t/2)+x*r.beta.cdf(p,b+1,t/2),g+=.5*w,b++;return v?1-g:g}}),r.extend(r.normal,{pdf:function(e,t,u){return i.exp(-.5*i.log(2*i.PI)-i.log(u)-i.pow(e-t,2)/(2*u*u))},cdf:function(e,t,u){return .5*(1+r.erf((e-t)/i.sqrt(2*u*u)))},inv:function(f,e,t){return-1.4142135623730951*t*r.erfcinv(2*f)+e},mean:function(f){return f},median:function(e){return e},mode:function(f){return f},sample:function(e,t){return r.randn()*t+e},variance:function(f,e){return e*e}}),r.extend(r.pareto,{pdf:function(e,t,u){return e<t?0:u*i.pow(t,u)/i.pow(e,u+1)},cdf:function(e,t,u){return e<t?0:1-i.pow(t/e,u)},inv:function(e,t,u){return t/i.pow(1-e,1/u)},mean:function(e,t){if(!(t<=1))return t*i.pow(e,t)/(t-1)},median:function(e,t){return e*(t*i.SQRT2)},mode:function(e){return e},variance:function(f,e){if(!(e<=2))return f*f*e/(i.pow(e-1,2)*(e-2))}}),r.extend(r.studentt,{pdf:function(e,t){return t=t>1e100?1e100:t,1/(i.sqrt(t)*r.betafn(.5,t/2))*i.pow(1+e*e/t,-((t+1)/2))},cdf:function(e,t){var u=t/2;return r.ibeta((e+i.sqrt(e*e+t))/(2*i.sqrt(e*e+t)),u,u)},inv:function(f,e){var t=r.ibetainv(2*i.min(f,1-f),.5*e,.5);return t=i.sqrt(e*(1-t)/t),f>.5?t:-t},mean:function(e){return e>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(e){return r.randn()*i.sqrt(e/(2*r.randg(e/2)))},variance:function(e){return e>2?e/(e-2):e>1?1/0:void 0}}),r.extend(r.weibull,{pdf:function(e,t,u){return e<0||t<0||u<0?0:u/t*i.pow(e/t,u-1)*i.exp(-i.pow(e/t,u))},cdf:function(e,t,u){return e<0?0:1-i.exp(-i.pow(e/t,u))},inv:function(f,e,t){return e*i.pow(-i.log(1-f),1/t)},mean:function(f,e){return f*r.gammafn(1+1/e)},median:function(e,t){return e*i.pow(i.log(2),1/t)},mode:function(e,t){return t<=1?0:e*i.pow((t-1)/t,1/t)},sample:function(e,t){return e*i.pow(-i.log(r._random_fn()),1/t)},variance:function(e,t){return e*e*r.gammafn(1+2/t)-i.pow(r.weibull.mean(e,t),2)}}),r.extend(r.uniform,{pdf:function(e,t,u){return e<t||e>u?0:1/(u-t)},cdf:function(e,t,u){return e<t?0:e<u?(e-t)/(u-t):1},inv:function(f,e,t){return e+f*(t-e)},mean:function(e,t){return .5*(e+t)},median:function(e,t){return r.mean(e,t)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(e,t){return e/2+t/2+(t/2-e/2)*(2*r._random_fn()-1)},variance:function(e,t){return i.pow(t-e,2)/12}});function l(f,e,t,u){for(var a=0,m=1,v=1,g=1,w=0,y=0,p;i.abs((v-y)/v)>u;)y=v,p=-(e+w)*(e+t+w)*f/(e+2*w)/(e+2*w+1),a=v+p*a,m=g+p*m,w=w+1,p=w*(t-w)*f/(e+2*w-1)/(e+2*w),v=a+p*v,g=m+p*g,a=a/g,m=m/g,v=v/g,g=1;return v/e}r.extend(r.binomial,{pdf:function(e,t,u){return u===0||u===1?t*u===e?1:0:r.combination(t,e)*i.pow(u,e)*i.pow(1-u,t-e)},cdf:function(e,t,u){var a,m=1e-10;if(e<0)return 0;if(e>=t)return 1;if(u<0||u>1||t<=0)return NaN;e=i.floor(e);var v=u,g=e+1,w=t-e,y=g+w,p=i.exp(r.gammaln(y)-r.gammaln(w)-r.gammaln(g)+g*i.log(v)+w*i.log(1-v));return v<(g+1)/(y+2)?a=p*l(v,g,w,m):a=1-p*l(1-v,w,g,m),i.round((1-a)*(1/m))/(1/m)}}),r.extend(r.negbin,{pdf:function(e,t,u){return e!==e>>>0?!1:e<0?0:r.combination(e+t-1,t-1)*i.pow(1-u,e)*i.pow(u,t)},cdf:function(e,t,u){var a=0,m=0;if(e<0)return 0;for(;m<=e;m++)a+=r.negbin.pdf(m,t,u);return a}}),r.extend(r.hypgeom,{pdf:function(e,t,u,a){if(e!==e|0)return!1;if(e<0||e<u-(t-a))return 0;if(e>a||e>u)return 0;if(u*2>t)return a*2>t?r.hypgeom.pdf(t-u-a+e,t,t-u,t-a):r.hypgeom.pdf(a-e,t,t-u,a);if(a*2>t)return r.hypgeom.pdf(u-e,t,u,t-a);if(u<a)return r.hypgeom.pdf(e,t,a,u);for(var m=1,v=0,g=0;g<e;g++){for(;m>1&&v<a;)m*=1-u/(t-v),v++;m*=(a-g)*(u-g)/((g+1)*(t-u-a+g+1))}for(;v<a;v++)m*=1-u/(t-v);return i.min(1,i.max(0,m))},cdf:function(e,t,u,a){if(e<0||e<u-(t-a))return 0;if(e>=a||e>=u)return 1;if(u*2>t)return a*2>t?r.hypgeom.cdf(t-u-a+e,t,t-u,t-a):1-r.hypgeom.cdf(a-e-1,t,t-u,a);if(a*2>t)return 1-r.hypgeom.cdf(u-e-1,t,u,t-a);if(u<a)return r.hypgeom.cdf(e,t,a,u);for(var m=1,v=1,g=0,w=0;w<e;w++){for(;m>1&&g<a;){var y=1-u/(t-g);v*=y,m*=y,g++}v*=(a-w)*(u-w)/((w+1)*(t-u-a+w+1)),m+=v}for(;g<a;g++)m*=1-u/(t-g);return i.min(1,i.max(0,m))}}),r.extend(r.poisson,{pdf:function(e,t){return t<0||e%1!==0||e<0?0:i.pow(t,e)*i.exp(-t)/r.factorial(e)},cdf:function(e,t){var u=[],a=0;if(e<0)return 0;for(;a<=e;a++)u.push(r.poisson.pdf(a,t));return r.sum(u)},mean:function(f){return f},variance:function(f){return f},sampleSmall:function(e){var t=1,u=0,a=i.exp(-e);do u++,t*=r._random_fn();while(t>a);return u-1},sampleLarge:function(e){var t=e,u,a,m,v,g,w,y,p,b,_;for(v=i.sqrt(t),g=i.log(t),y=.931+2.53*v,w=-.059+.02483*y,p=1.1239+1.1328/(y-3.4),b=.9277-3.6224/(y-2);;){if(a=i.random()-.5,m=i.random(),_=.5-i.abs(a),u=i.floor((2*w/_+y)*a+t+.43),_>=.07&&m<=b)return u;if(!(u<0||_<.013&&m>_)&&i.log(m)+i.log(p)-i.log(w/(_*_)+y)<=-t+u*g-r.loggam(u+1))return u}},sample:function(e){return e<10?this.sampleSmall(e):this.sampleLarge(e)}}),r.extend(r.triangular,{pdf:function(e,t,u,a){return u<=t||a<t||a>u?NaN:e<t||e>u?0:e<a?2*(e-t)/((u-t)*(a-t)):e===a?2/(u-t):2*(u-e)/((u-t)*(u-a))},cdf:function(e,t,u,a){return u<=t||a<t||a>u?NaN:e<=t?0:e>=u?1:e<=a?i.pow(e-t,2)/((u-t)*(a-t)):1-i.pow(u-e,2)/((u-t)*(u-a))},inv:function(e,t,u,a){return u<=t||a<t||a>u?NaN:e<=(a-t)/(u-t)?t+(u-t)*i.sqrt(e*((a-t)/(u-t))):t+(u-t)*(1-i.sqrt((1-e)*(1-(a-t)/(u-t))))},mean:function(e,t,u){return(e+t+u)/3},median:function(e,t,u){if(u<=(e+t)/2)return t-i.sqrt((t-e)*(t-u))/i.sqrt(2);if(u>(e+t)/2)return e+i.sqrt((t-e)*(u-e))/i.sqrt(2)},mode:function(e,t,u){return u},sample:function(e,t,u){var a=r._random_fn();return a<(u-e)/(t-e)?e+i.sqrt(a*(t-e)*(u-e)):t-i.sqrt((1-a)*(t-e)*(t-u))},variance:function(e,t,u){return(e*e+t*t+u*u-e*t-e*u-t*u)/18}}),r.extend(r.arcsine,{pdf:function(e,t,u){return u<=t?NaN:e<=t||e>=u?0:2/i.PI*i.pow(i.pow(u-t,2)-i.pow(2*e-t-u,2),-.5)},cdf:function(e,t,u){return e<t?0:e<u?2/i.PI*i.asin(i.sqrt((e-t)/(u-t))):1},inv:function(f,e,t){return e+(.5-.5*i.cos(i.PI*f))*(t-e)},mean:function(e,t){return t<=e?NaN:(e+t)/2},median:function(e,t){return t<=e?NaN:(e+t)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(e,t){return(e+t)/2+(t-e)/2*i.sin(2*i.PI*r.uniform.sample(0,1))},variance:function(e,t){return t<=e?NaN:i.pow(t-e,2)/8}});function s(f){return f/i.abs(f)}r.extend(r.laplace,{pdf:function(e,t,u){return u<=0?0:i.exp(-i.abs(e-t)/u)/(2*u)},cdf:function(e,t,u){return u<=0?0:e<t?.5*i.exp((e-t)/u):1-.5*i.exp(-(e-t)/u)},mean:function(f){return f},median:function(f){return f},mode:function(f){return f},variance:function(f,e){return 2*e*e},sample:function(e,t){var u=r._random_fn()-.5;return e-t*s(u)*i.log(1-2*i.abs(u))}});function h(f,e,t){var u=12,a=6,m=-30,v=-50,g=60,w=8,y=3,p=2,b=3,_=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],x=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],k=f*.5;if(k>=w)return 1;var A=2*r.normal.cdf(k,0,1,1,0)-1;A>=i.exp(v/t)?A=i.pow(A,t):A=0;var N;f>y?N=p:N=b;for(var $=k,E=(w-k)/N,q=$+E,I=0,R=t-1,W=1;W<=N;W++){for(var H=0,P=.5*(q+$),L=.5*(q-$),T=1;T<=u;T++){var D,U;a<T?(D=u-T+1,U=_[D-1]):(D=T,U=-_[D-1]);var X=L*U,z=P+X,j=z*z;if(j>g)break;var yn=2*r.normal.cdf(z,0,1,1,0),fe=2*r.normal.cdf(z,f,1,1,0),un=yn*.5-fe*.5;un>=i.exp(m/R)&&(un=x[D-1]*i.exp(-(.5*j))*i.pow(un,R),H+=un)}H*=2*L*t/i.sqrt(2*i.PI),I+=H,$=q,q+=E}return A+=I,A<=i.exp(m/e)?0:(A=i.pow(A,e),A>=1?1:A)}function d(f,e,t){var u=.322232421088,a=.099348462606,m=-1,v=.588581570495,g=-.342242088547,w=.531103462366,y=-.204231210125,p=.10353775285,b=-453642210148e-16,_=.0038560700634,x=.8832,k=.2368,A=1.208,N=1.4142,$=120,E=.5-.5*f,q=i.sqrt(i.log(1/(E*E))),I=q+((((q*b+y)*q+g)*q+m)*q+u)/((((q*_+p)*q+w)*q+v)*q+a);t<$&&(I+=(I*I*I+I)/t/4);var R=x-k*I;return t<$&&(R+=-1.214/t+A*I/t),I*(R*i.log(e-1)+N)}r.extend(r.tukey,{cdf:function(e,t,u){var a=1,m=t,v=16,g=8,w=-30,y=1e-14,p=100,b=800,_=5e3,x=25e3,k=1,A=.5,N=.25,$=.125,E=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],q=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(e<=0)return 0;if(u<2||a<1||m<2)return NaN;if(!Number.isFinite(e))return 1;if(u>x)return h(e,a,m);var I=u*.5,R=I*i.log(u)-u*i.log(2)-r.gammaln(I),W=I-1,H=u*.25,P;u<=p?P=k:u<=b?P=A:u<=_?P=N:P=$,R+=i.log(P);for(var L=0,T=1;T<=50;T++){for(var D=0,U=(2*T-1)*P,X=1;X<=v;X++){var z,j;g<X?(z=X-g-1,j=R+W*i.log(U+E[z]*P)-(E[z]*P+U)*H):(z=X-1,j=R+W*i.log(U-E[z]*P)+(E[z]*P-U)*H);var yn;if(j>=w){g<X?yn=e*i.sqrt((E[z]*P+U)*.5):yn=e*i.sqrt((-(E[z]*P)+U)*.5);var fe=h(yn,a,m),un=fe*q[z]*i.exp(j);D+=un}}if(T*P>=1&&D<=y)break;L+=D}if(D>y)throw new Error("tukey.cdf failed to converge");return L>1&&(L=1),L},inv:function(f,e,t){var u=1,a=e,m=1e-4,v=50;if(t<2||u<1||a<2)return NaN;if(f<0||f>1)return NaN;if(f===0)return 0;if(f===1)return 1/0;var g=d(f,a,t),w=r.tukey.cdf(g,e,t)-f,y;w>0?y=i.max(0,g-1):y=g+1;for(var p=r.tukey.cdf(y,e,t)-f,b,_=1;_<v;_++){b=y-p*(y-g)/(p-w),w=p,g=y,b<0&&(b=0,p=-f),p=r.tukey.cdf(b,e,t)-f,y=b;var x=i.abs(y-g);if(x<m)return b}throw new Error("tukey.inv failed to converge")}})}(c,Math),function(r,i){var l=Array.prototype.push,s=r.utils.isArray;function h(d){return s(d)||d instanceof r}r.extend({add:function(f,e){return h(e)?(h(e[0])||(e=[e]),r.map(f,function(t,u,a){return t+e[u][a]})):r.map(f,function(t){return t+e})},subtract:function(f,e){return h(e)?(h(e[0])||(e=[e]),r.map(f,function(t,u,a){return t-e[u][a]||0})):r.map(f,function(t){return t-e})},divide:function(f,e){return h(e)?(h(e[0])||(e=[e]),r.multiply(f,r.inv(e))):r.map(f,function(t){return t/e})},multiply:function(f,e){var t,u,a,m,v,g,w,y;if(f.length===void 0&&e.length===void 0)return f*e;if(v=f.length,g=f[0].length,w=r.zeros(v,a=h(e)?e[0].length:g),y=0,h(e)){for(;y<a;y++)for(t=0;t<v;t++){for(m=0,u=0;u<g;u++)m+=f[t][u]*e[u][y];w[t][y]=m}return v===1&&y===1?w[0][0]:w}return r.map(f,function(p){return p*e})},outer:function(f,e){return r.multiply(f.map(function(t){return[t]}),[e])},dot:function(f,e){h(f[0])||(f=[f]),h(e[0])||(e=[e]);for(var t=f[0].length===1&&f.length!==1?r.transpose(f):f,u=e[0].length===1&&e.length!==1?r.transpose(e):e,a=[],m=0,v=t.length,g=t[0].length,w,y;m<v;m++){for(a[m]=[],w=0,y=0;y<g;y++)w+=t[m][y]*u[m][y];a[m]=w}return a.length===1?a[0]:a},pow:function(f,e){return r.map(f,function(t){return i.pow(t,e)})},exp:function(f){return r.map(f,function(e){return i.exp(e)})},log:function(f){return r.map(f,function(e){return i.log(e)})},abs:function(f){return r.map(f,function(e){return i.abs(e)})},norm:function(f,e){var t=0,u=0;for(isNaN(e)&&(e=2),h(f[0])&&(f=f[0]);u<f.length;u++)t+=i.pow(i.abs(f[u]),e);return i.pow(t,1/e)},angle:function(f,e){return i.acos(r.dot(f,e)/(r.norm(f)*r.norm(e)))},aug:function(f,e){var t=[],u;for(u=0;u<f.length;u++)t.push(f[u].slice());for(u=0;u<t.length;u++)l.apply(t[u],e[u]);return t},inv:function(f){for(var e=f.length,t=f[0].length,u=r.identity(e,t),a=r.gauss_jordan(f,u),m=[],v=0,g;v<e;v++)for(m[v]=[],g=t;g<a[0].length;g++)m[v][g-t]=a[v][g];return m},det:function d(f){if(f.length===2)return f[0][0]*f[1][1]-f[0][1]*f[1][0];for(var e=0,t=0;t<f.length;t++){for(var u=[],a=1;a<f.length;a++){u[a-1]=[];for(var m=0;m<f.length;m++)m<t?u[a-1][m]=f[a][m]:m>t&&(u[a-1][m-1]=f[a][m])}var v=t%2?-1:1;e+=d(u)*f[0][t]*v}return e},gauss_elimination:function(f,e){var t=0,u=0,a=f.length,m=f[0].length,v=1,g=0,w=[],y,p,b,_;for(f=r.aug(f,e),y=f[0].length,t=0;t<a;t++){for(p=f[t][t],u=t,_=t+1;_<m;_++)p<i.abs(f[_][t])&&(p=f[_][t],u=_);if(u!=t)for(_=0;_<y;_++)b=f[t][_],f[t][_]=f[u][_],f[u][_]=b;for(u=t+1;u<a;u++)for(v=f[u][t]/f[t][t],_=t;_<y;_++)f[u][_]=f[u][_]-v*f[t][_]}for(t=a-1;t>=0;t--){for(g=0,u=t+1;u<=a-1;u++)g=g+w[u]*f[t][u];w[t]=(f[t][y-1]-g)/f[t][t]}return w},gauss_jordan:function(f,e){var t=r.aug(f,e),u=t.length,a=t[0].length,m=0,v,g,w;for(g=0;g<u;g++){var y=g;for(w=g+1;w<u;w++)i.abs(t[w][g])>i.abs(t[y][g])&&(y=w);var p=t[g];for(t[g]=t[y],t[y]=p,w=g+1;w<u;w++)for(m=t[w][g]/t[g][g],v=g;v<a;v++)t[w][v]-=t[g][v]*m}for(g=u-1;g>=0;g--){for(m=t[g][g],w=0;w<g;w++)for(v=a-1;v>g-1;v--)t[w][v]-=t[g][v]*t[w][g]/m;for(t[g][g]/=m,v=u;v<a;v++)t[g][v]/=m}return t},triaUpSolve:function(f,e){var t=f[0].length,u=r.zeros(1,t)[0],a,m=!1;return e[0].length!=null&&(e=e.map(function(v){return v[0]}),m=!0),r.arange(t-1,-1,-1).forEach(function(v){a=r.arange(v+1,t).map(function(g){return u[g]*f[v][g]}),u[v]=(e[v]-r.sum(a))/f[v][v]}),m?u.map(function(v){return[v]}):u},triaLowSolve:function(f,e){var t=f[0].length,u=r.zeros(1,t)[0],a,m=!1;return e[0].length!=null&&(e=e.map(function(v){return v[0]}),m=!0),r.arange(t).forEach(function(v){a=r.arange(v).map(function(g){return f[v][g]*u[g]}),u[v]=(e[v]-r.sum(a))/f[v][v]}),m?u.map(function(v){return[v]}):u},lu:function(f){var e=f.length,t=r.identity(e),u=r.zeros(f.length,f[0].length),a;return r.arange(e).forEach(function(m){u[0][m]=f[0][m]}),r.arange(1,e).forEach(function(m){r.arange(m).forEach(function(v){a=r.arange(v).map(function(g){return t[m][g]*u[g][v]}),t[m][v]=(f[m][v]-r.sum(a))/u[v][v]}),r.arange(m,e).forEach(function(v){a=r.arange(m).map(function(g){return t[m][g]*u[g][v]}),u[m][v]=f[a.length][v]-r.sum(a)})}),[t,u]},cholesky:function(f){var e=f.length,t=r.zeros(f.length,f[0].length),u;return r.arange(e).forEach(function(a){u=r.arange(a).map(function(m){return i.pow(t[a][m],2)}),t[a][a]=i.sqrt(f[a][a]-r.sum(u)),r.arange(a+1,e).forEach(function(m){u=r.arange(a).map(function(v){return t[a][v]*t[m][v]}),t[m][a]=(f[a][m]-r.sum(u))/t[a][a]})}),t},gauss_jacobi:function(f,e,t,u){for(var a=0,m=0,v=f.length,g=[],w=[],y=[],p,b,_,x;a<v;a++)for(g[a]=[],w[a]=[],y[a]=[],m=0;m<v;m++)a>m?(g[a][m]=f[a][m],w[a][m]=y[a][m]=0):a<m?(w[a][m]=f[a][m],g[a][m]=y[a][m]=0):(y[a][m]=f[a][m],g[a][m]=w[a][m]=0);for(_=r.multiply(r.multiply(r.inv(y),r.add(g,w)),-1),b=r.multiply(r.inv(y),e),p=t,x=r.add(r.multiply(_,t),b),a=2;i.abs(r.norm(r.subtract(x,p)))>u;)p=x,x=r.add(r.multiply(_,p),b),a++;return x},gauss_seidel:function(f,e,t,u){for(var a=0,m=f.length,v=[],g=[],w=[],y,p,b,_,x;a<m;a++)for(v[a]=[],g[a]=[],w[a]=[],y=0;y<m;y++)a>y?(v[a][y]=f[a][y],g[a][y]=w[a][y]=0):a<y?(g[a][y]=f[a][y],v[a][y]=w[a][y]=0):(w[a][y]=f[a][y],v[a][y]=g[a][y]=0);for(_=r.multiply(r.multiply(r.inv(r.add(w,v)),g),-1),b=r.multiply(r.inv(r.add(w,v)),e),p=t,x=r.add(r.multiply(_,t),b),a=2;i.abs(r.norm(r.subtract(x,p)))>u;)p=x,x=r.add(r.multiply(_,p),b),a=a+1;return x},SOR:function(f,e,t,u,a){for(var m=0,v=f.length,g=[],w=[],y=[],p,b,_,x,k;m<v;m++)for(g[m]=[],w[m]=[],y[m]=[],p=0;p<v;p++)m>p?(g[m][p]=f[m][p],w[m][p]=y[m][p]=0):m<p?(w[m][p]=f[m][p],g[m][p]=y[m][p]=0):(y[m][p]=f[m][p],g[m][p]=w[m][p]=0);for(x=r.multiply(r.inv(r.add(y,r.multiply(g,a))),r.subtract(r.multiply(y,1-a),r.multiply(w,a))),_=r.multiply(r.multiply(r.inv(r.add(y,r.multiply(g,a))),e),a),b=t,k=r.add(r.multiply(x,t),_),m=2;i.abs(r.norm(r.subtract(k,b)))>u;)b=k,k=r.add(r.multiply(x,b),_),m++;return k},householder:function(f){for(var e=f.length,t=f[0].length,u=0,a=[],m=[],v,g,w,y,p;u<e-1;u++){for(v=0,y=u+1;y<t;y++)v+=f[y][u]*f[y][u];for(p=f[u+1][u]>0?-1:1,v=p*i.sqrt(v),g=i.sqrt((v*v-f[u+1][u]*v)/2),a=r.zeros(e,1),a[u+1][0]=(f[u+1][u]-v)/(2*g),w=u+2;w<e;w++)a[w][0]=f[w][u]/(2*g);m=r.subtract(r.identity(e,t),r.multiply(r.multiply(a,r.transpose(a)),2)),f=r.multiply(m,r.multiply(f,m))}return f},QR:function(){var d=r.sum,f=r.arange;function e(t){var u=t.length,a=t[0].length,m=r.zeros(a,a);t=r.copy(t);var v,g,w;for(g=0;g<a;g++){for(m[g][g]=i.sqrt(d(f(u).map(function(y){return t[y][g]*t[y][g]}))),v=0;v<u;v++)t[v][g]=t[v][g]/m[g][g];for(w=g+1;w<a;w++)for(m[g][w]=d(f(u).map(function(y){return t[y][g]*t[y][w]})),v=0;v<u;v++)t[v][w]=t[v][w]-t[v][g]*m[g][w]}return[t,m]}return e}(),lstsq:function(){function d(e){e=r.copy(e);var t=e.length,u=r.identity(t);return r.arange(t-1,-1,-1).forEach(function(a){r.sliceAssign(u,{row:a},r.divide(r.slice(u,{row:a}),e[a][a])),r.sliceAssign(e,{row:a},r.divide(r.slice(e,{row:a}),e[a][a])),r.arange(a).forEach(function(m){var v=r.multiply(e[m][a],-1),g=r.slice(e,{row:m}),w=r.multiply(r.slice(e,{row:a}),v);r.sliceAssign(e,{row:m},r.add(g,w));var y=r.slice(u,{row:m}),p=r.multiply(r.slice(u,{row:a}),v);r.sliceAssign(u,{row:m},r.add(y,p))})}),u}function f(e,t){var u=!1;t[0].length===void 0&&(t=t.map(function(x){return[x]}),u=!0);var a=r.QR(e),m=a[0],v=a[1],g=e[0].length,w=r.slice(m,{col:{end:g}}),y=r.slice(v,{row:{end:g}}),p=d(y),b=r.transpose(w);b[0].length===void 0&&(b=[b]);var _=r.multiply(r.multiply(p,b),t);return _.length===void 0&&(_=[[_]]),u?_.map(function(x){return x[0]}):_}return f}(),jacobi:function(f){for(var e=1,t=f.length,u=r.identity(t,t),a=[],m,v,g,w,y,p,b,_;e===1;){for(p=f[0][1],w=0,y=1,v=0;v<t;v++)for(g=0;g<t;g++)v!=g&&p<i.abs(f[v][g])&&(p=i.abs(f[v][g]),w=v,y=g);for(f[w][w]===f[y][y]?b=f[w][y]>0?i.PI/4:-i.PI/4:b=i.atan(2*f[w][y]/(f[w][w]-f[y][y]))/2,_=r.identity(t,t),_[w][w]=i.cos(b),_[w][y]=-i.sin(b),_[y][w]=i.sin(b),_[y][y]=i.cos(b),u=r.multiply(u,_),m=r.multiply(r.multiply(r.inv(_),f),_),f=m,e=0,v=1;v<t;v++)for(g=1;g<t;g++)v!=g&&i.abs(f[v][g])>.001&&(e=1)}for(v=0;v<t;v++)a.push(f[v][v]);return[u,a]},rungekutta:function(f,e,t,u,a,m){var v,g,w,y,p;if(m===2)for(;u<=t;)v=e*f(u,a),g=e*f(u+e,a+v),w=a+(v+g)/2,a=w,u=u+e;if(m===4)for(;u<=t;)v=e*f(u,a),g=e*f(u+e/2,a+v/2),y=e*f(u+e/2,a+g/2),p=e*f(u+e,a+y),w=a+(v+2*g+2*y+p)/6,a=w,u=u+e;return a},romberg:function(f,e,t,u){for(var a=0,m=(t-e)/2,v=[],g=[],w=[],y,p,b,_,x;a<u/2;){for(x=f(e),b=e,_=0;b<=t;b=b+m,_++)v[_]=b;for(y=v.length,b=1;b<y-1;b++)x+=(b%2!==0?4:2)*f(v[b]);x=m/3*(x+f(t)),w[a]=x,m/=2,a++}for(p=w.length,y=1;p!==1;){for(b=0;b<p-1;b++)g[b]=(i.pow(4,y)*w[b+1]-w[b])/(i.pow(4,y)-1);p=g.length,w=g,g=[],y++}return w},richardson:function(f,e,t,u){function a(k,A){for(var N=0,$=k.length,E;N<$;N++)k[N]===A&&(E=N);return E}for(var m=i.abs(t-f[a(f,t)+1]),v=0,g=[],w=[],y,p,b,_,x;u>=m;)y=a(f,t+u),p=a(f,t),g[v]=(e[y]-2*e[p]+e[2*p-y])/(u*u),u/=2,v++;for(_=g.length,b=1;_!=1;){for(x=0;x<_-1;x++)w[x]=(i.pow(4,b)*g[x+1]-g[x])/(i.pow(4,b)-1);_=w.length,g=w,w=[],b++}return g},simpson:function(f,e,t,u){for(var a=(t-e)/u,m=f(e),v=[],g=e,w=0,y=1,p;g<=t;g=g+a,w++)v[w]=g;for(p=v.length;y<p-1;y++)m+=(y%2!==0?4:2)*f(v[y]);return a/3*(m+f(t))},hermite:function(f,e,t,u){for(var a=f.length,m=0,v=0,g=[],w=[],y=[],p=[],b;v<a;v++){for(g[v]=1,b=0;b<a;b++)v!=b&&(g[v]*=(u-f[b])/(f[v]-f[b]));for(w[v]=0,b=0;b<a;b++)v!=b&&(w[v]+=1/(f[v]-f[b]));y[v]=(1-2*(u-f[v])*w[v])*(g[v]*g[v]),p[v]=(u-f[v])*(g[v]*g[v]),m+=y[v]*e[v]+p[v]*t[v]}return m},lagrange:function(f,e,t){for(var u=0,a=0,m,v,g=f.length;a<g;a++){for(v=e[a],m=0;m<g;m++)a!=m&&(v*=(t-f[m])/(f[a]-f[m]));u+=v}return u},cubic_spline:function(f,e,t){for(var u=f.length,a=0,m,v=[],g=[],w=[],y=[],p=[],b=[],_=[];a<u-1;a++)p[a]=f[a+1]-f[a];for(w[0]=0,a=1;a<u-1;a++)w[a]=3/p[a]*(e[a+1]-e[a])-3/p[a-1]*(e[a]-e[a-1]);for(a=1;a<u-1;a++)v[a]=[],g[a]=[],v[a][a-1]=p[a-1],v[a][a]=2*(p[a-1]+p[a]),v[a][a+1]=p[a],g[a][0]=w[a];for(y=r.multiply(r.inv(v),g),m=0;m<u-1;m++)b[m]=(e[m+1]-e[m])/p[m]-p[m]*(y[m+1][0]+2*y[m][0])/3,_[m]=(y[m+1][0]-y[m][0])/(3*p[m]);for(m=0;m<u&&!(f[m]>t);m++);return m-=1,e[m]+(t-f[m])*b[m]+r.sq(t-f[m])*y[m]+(t-f[m])*r.sq(t-f[m])*_[m]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(f){var e=f.length,t=f[0].length,u=0,a,m,v=[],g=[],w=[],y=[],p=[],b=[],_=[],x=[],k=[],A=[];for(u=0;u<e;u++)v[u]=r.sum(f[u])/t;for(u=0;u<t;u++)for(_[u]=[],a=0;a<e;a++)_[u][a]=f[a][u]-v[a];for(_=r.transpose(_),u=0;u<e;u++)for(x[u]=[],a=0;a<e;a++)x[u][a]=r.dot([_[u]],[_[a]])/(t-1);for(w=r.jacobi(x),k=w[0],g=w[1],A=r.transpose(k),u=0;u<g.length;u++)for(a=u;a<g.length;a++)g[u]<g[a]&&(m=g[u],g[u]=g[a],g[a]=m,y=A[u],A[u]=A[a],A[a]=y);for(b=r.transpose(_),u=0;u<e;u++)for(p[u]=[],a=0;a<b.length;a++)p[u][a]=r.dot([A[u]],[b[a]]);return[f,g,A,p]}}),function(d){for(var f=0;f<d.length;f++)(function(e){r.fn[e]=function(t,u){var a=this;return u?(setTimeout(function(){u.call(a,r.fn[e].call(a,t))},15),this):typeof r[e](this,t)=="number"?r[e](this,t):r(r[e](this,t))}})(d[f])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(c,Math),function(r,i){var l=[].slice,s=r.utils.isNumber,h=r.utils.isArray;r.extend({zscore:function(){var e=l.call(arguments);return s(e[1])?(e[0]-e[1])/e[2]:(e[0]-r.mean(e[1]))/r.stdev(e[1],e[2])},ztest:function(){var e=l.call(arguments),t;return h(e[1])?(t=r.zscore(e[0],e[1],e[3]),e[2]===1?r.normal.cdf(-i.abs(t),0,1):r.normal.cdf(-i.abs(t),0,1)*2):e.length>2?(t=r.zscore(e[0],e[1],e[2]),e[3]===1?r.normal.cdf(-i.abs(t),0,1):r.normal.cdf(-i.abs(t),0,1)*2):(t=e[0],e[1]===1?r.normal.cdf(-i.abs(t),0,1):r.normal.cdf(-i.abs(t),0,1)*2)}}),r.extend(r.fn,{zscore:function(e,t){return(e-this.mean())/this.stdev(t)},ztest:function(e,t,u){var a=i.abs(this.zscore(e,u));return t===1?r.normal.cdf(-a,0,1):r.normal.cdf(-a,0,1)*2}}),r.extend({tscore:function(){var e=l.call(arguments);return e.length===4?(e[0]-e[1])/(e[2]/i.sqrt(e[3])):(e[0]-r.mean(e[1]))/(r.stdev(e[1],!0)/i.sqrt(e[1].length))},ttest:function(){var e=l.call(arguments),t;return e.length===5?(t=i.abs(r.tscore(e[0],e[1],e[2],e[3])),e[4]===1?r.studentt.cdf(-t,e[3]-1):r.studentt.cdf(-t,e[3]-1)*2):s(e[1])?(t=i.abs(e[0]),e[2]==1?r.studentt.cdf(-t,e[1]-1):r.studentt.cdf(-t,e[1]-1)*2):(t=i.abs(r.tscore(e[0],e[1])),e[2]==1?r.studentt.cdf(-t,e[1].length-1):r.studentt.cdf(-t,e[1].length-1)*2)}}),r.extend(r.fn,{tscore:function(e){return(e-this.mean())/(this.stdev(!0)/i.sqrt(this.cols()))},ttest:function(e,t){return t===1?1-r.studentt.cdf(i.abs(this.tscore(e)),this.cols()-1):r.studentt.cdf(-i.abs(this.tscore(e)),this.cols()-1)*2}}),r.extend({anovafscore:function(){var e=l.call(arguments),t,u,a,m,v,g,w,y;if(e.length===1){for(v=new Array(e[0].length),w=0;w<e[0].length;w++)v[w]=e[0][w];e=v}for(u=new Array,w=0;w<e.length;w++)u=u.concat(e[w]);for(a=r.mean(u),t=0,w=0;w<e.length;w++)t=t+e[w].length*i.pow(r.mean(e[w])-a,2);for(t/=e.length-1,g=0,w=0;w<e.length;w++)for(m=r.mean(e[w]),y=0;y<e[w].length;y++)g+=i.pow(e[w][y]-m,2);return g/=u.length-e.length,t/g},anovaftest:function(){var e=l.call(arguments),t,u,a,m;if(s(e[0]))return 1-r.centralF.cdf(e[0],e[1],e[2]);var v=r.anovafscore(e);for(t=e.length-1,a=0,m=0;m<e.length;m++)a=a+e[m].length;return u=a-t-1,1-r.centralF.cdf(v,t,u)},ftest:function(e,t,u){return 1-r.centralF.cdf(e,t,u)}}),r.extend(r.fn,{anovafscore:function(){return r.anovafscore(this.toArray())},anovaftes:function(){var e=0,t;for(t=0;t<this.length;t++)e=e+this[t].length;return r.ftest(this.anovafscore(),this.length-1,e-this.length)}}),r.extend({qscore:function(){var e=l.call(arguments),t,u,a,m,v;return s(e[0])?(t=e[0],u=e[1],a=e[2],m=e[3],v=e[4]):(t=r.mean(e[0]),u=r.mean(e[1]),a=e[0].length,m=e[1].length,v=e[2]),i.abs(t-u)/(v*i.sqrt((1/a+1/m)/2))},qtest:function(){var e=l.call(arguments),t;e.length===3?(t=e[0],e=e.slice(1)):e.length===7?(t=r.qscore(e[0],e[1],e[2],e[3],e[4]),e=e.slice(5)):(t=r.qscore(e[0],e[1],e[2]),e=e.slice(3));var u=e[0],a=e[1];return 1-r.tukey.cdf(t,a,u-a)},tukeyhsd:function(e){for(var t=r.pooledstdev(e),u=e.map(function(y){return r.mean(y)}),a=e.reduce(function(y,p){return y+p.length},0),m=[],v=0;v<e.length;++v)for(var g=v+1;g<e.length;++g){var w=r.qtest(u[v],u[g],e[v].length,e[g].length,t,a,e.length);m.push([[v,g],w])}return m}}),r.extend({normalci:function(){var e=l.call(arguments),t=new Array(2),u;return e.length===4?u=i.abs(r.normal.inv(e[1]/2,0,1)*e[2]/i.sqrt(e[3])):u=i.abs(r.normal.inv(e[1]/2,0,1)*r.stdev(e[2])/i.sqrt(e[2].length)),t[0]=e[0]-u,t[1]=e[0]+u,t},tci:function(){var e=l.call(arguments),t=new Array(2),u;return e.length===4?u=i.abs(r.studentt.inv(e[1]/2,e[3]-1)*e[2]/i.sqrt(e[3])):u=i.abs(r.studentt.inv(e[1]/2,e[2].length-1)*r.stdev(e[2],!0)/i.sqrt(e[2].length)),t[0]=e[0]-u,t[1]=e[0]+u,t},significant:function(e,t){return e<t}}),r.extend(r.fn,{normalci:function(e,t){return r.normalci(e,t,this.toArray())},tci:function(e,t){return r.tci(e,t,this.toArray())}});function d(f,e,t,u){if(f>1||t>1||f<=0||t<=0)throw new Error("Proportions should be greater than 0 and less than 1");var a=(f*e+t*u)/(e+u),m=i.sqrt(a*(1-a)*(1/e+1/u));return(f-t)/m}r.extend(r.fn,{oneSidedDifferenceOfProportions:function(e,t,u,a){var m=d(e,t,u,a);return r.ztest(m,1)},twoSidedDifferenceOfProportions:function(e,t,u,a){var m=d(e,t,u,a);return r.ztest(m,2)}})}(c,Math),c.models=function(){function r(d){var f=d[0].length,e=c.arange(f).map(function(t){var u=c.arange(f).filter(function(a){return a!==t});return i(c.col(d,t).map(function(a){return a[0]}),c.col(d,u))});return e}function i(d,f){var e=d.length,t=f[0].length-1,u=e-t-1,a=c.lstsq(f,d),m=c.multiply(f,a.map(function(_){return[_]})).map(function(_){return _[0]}),v=c.subtract(d,m),g=c.mean(d),w=c.sum(m.map(function(_){return Math.pow(_-g,2)})),y=c.sum(d.map(function(_,x){return Math.pow(_-m[x],2)})),p=w+y,b=w/p;return{exog:f,endog:d,nobs:e,df_model:t,df_resid:u,coef:a,predict:m,resid:v,ybar:g,SST:p,SSE:w,SSR:y,R2:b}}function l(d){var f=r(d.exog),e=Math.sqrt(d.SSR/d.df_resid),t=f.map(function(g){var w=g.SST,y=g.R2;return e/Math.sqrt(w*(1-y))}),u=d.coef.map(function(g,w){return(g-0)/t[w]}),a=u.map(function(g){var w=c.studentt.cdf(g,d.df_resid);return(w>.5?1-w:w)*2}),m=c.studentt.inv(.975,d.df_resid),v=d.coef.map(function(g,w){var y=m*t[w];return[g-y,g+y]});return{se:t,t:u,p:a,sigmaHat:e,interval95:v}}function s(d){var f=d.R2/d.df_model/((1-d.R2)/d.df_resid),e=function(u,a,m){return c.beta.cdf(u/(m/a+u),a/2,m/2)},t=1-e(f,d.df_model,d.df_resid);return{F_statistic:f,pvalue:t}}function h(d,f){var e=i(d,f),t=l(e),u=s(e),a=1-(1-e.R2)*((e.nobs-1)/e.df_resid);return e.t=t,e.f=u,e.adjust_R2=a,e}return{ols:h}}(),c.extend({buildxmatrix:function(){for(var i=new Array(arguments.length),l=0;l<arguments.length;l++){var s=[1];i[l]=s.concat(arguments[l])}return c(i)},builddxmatrix:function(){for(var i=new Array(arguments[0].length),l=0;l<arguments[0].length;l++){var s=[1];i[l]=s.concat(arguments[0][l])}return c(i)},buildjxmatrix:function(i){for(var l=new Array(i.length),s=0;s<i.length;s++)l[s]=i[s];return c.builddxmatrix(l)},buildymatrix:function(i){return c(i).transpose()},buildjymatrix:function(i){return i.transpose()},matrixmult:function(i,l){var s,h,d,f,e;if(i.cols()==l.rows()){if(l.rows()>1){for(f=[],s=0;s<i.rows();s++)for(f[s]=[],h=0;h<l.cols();h++){for(e=0,d=0;d<i.cols();d++)e+=i.toArray()[s][d]*l.toArray()[d][h];f[s][h]=e}return c(f)}for(f=[],s=0;s<i.rows();s++)for(f[s]=[],h=0;h<l.cols();h++){for(e=0,d=0;d<i.cols();d++)e+=i.toArray()[s][d]*l.toArray()[h];f[s][h]=e}return c(f)}},regress:function(i,l){var s=c.xtranspxinv(i),h=i.transpose(),d=c.matrixmult(c(s),h);return c.matrixmult(d,l)},regresst:function(i,l,s){var h=c.regress(i,l),d={};d.anova={};var f=c.jMatYBar(i,h);d.yBar=f;var e=l.mean();d.anova.residuals=c.residuals(l,f),d.anova.ssr=c.ssr(f,e),d.anova.msr=d.anova.ssr/(i[0].length-1),d.anova.sse=c.sse(l,f),d.anova.mse=d.anova.sse/(l.length-(i[0].length-1)-1),d.anova.sst=c.sst(l,e),d.anova.mst=d.anova.sst/(l.length-1),d.anova.r2=1-d.anova.sse/d.anova.sst,d.anova.r2<0&&(d.anova.r2=0),d.anova.fratio=d.anova.msr/d.anova.mse,d.anova.pvalue=c.anovaftest(d.anova.fratio,i[0].length-1,l.length-(i[0].length-1)-1),d.anova.rmse=Math.sqrt(d.anova.mse),d.anova.r2adj=1-d.anova.mse/d.anova.mst,d.anova.r2adj<0&&(d.anova.r2adj=0),d.stats=new Array(i[0].length);for(var t=c.xtranspxinv(i),u,a,m,v=0;v<h.length;v++)u=Math.sqrt(d.anova.mse*Math.abs(t[v][v])),a=Math.abs(h[v]/u),m=c.ttest(a,l.length-i[0].length-1,s),d.stats[v]=[h[v],u,a,m];return d.regress=h,d},xtranspx:function(i){return c.matrixmult(i.transpose(),i)},xtranspxinv:function(i){var l=c.matrixmult(i.transpose(),i),s=c.inv(l);return s},jMatYBar:function(i,l){var s=c.matrixmult(i,l);return new c(s)},residuals:function(i,l){return c.matrixsubtract(i,l)},ssr:function(i,l){for(var s=0,h=0;h<i.length;h++)s+=Math.pow(i[h]-l,2);return s},sse:function(i,l){for(var s=0,h=0;h<i.length;h++)s+=Math.pow(i[h]-l[h],2);return s},sst:function(i,l){for(var s=0,h=0;h<i.length;h++)s+=Math.pow(i[h]-l,2);return s},matrixsubtract:function(i,l){for(var s=new Array(i.length),h=0;h<i.length;h++){s[h]=new Array(i[h].length);for(var d=0;d<i[h].length;d++)s[h][d]=i[h][d]-l[h][d]}return c(s)}}),c.jStat=c,c})}(Vn)),Vn.exports}var O=qu();const Iu=Math.log(1e3),Ru=.5,Pu=1,Sn={populationSize:1e4,geneEnvWeight:.5,envNoiseStd:.1,financeWeight:.7,financeNoise:.1,homophily:{gene:0,env:0}};function Tu(n){const o=[];for(let c=0;c<n.populationSize;c++){const r=[O.normal.sample(0,1),O.normal.sample(0,1)],i=O.normal.sample(0,1),l={id:c,alleles:r,meanAllele:(r[0]+r[1])/2,parentIncome:1e5,env:i,rawenv:i,educationScore:O.normal.sample(0,1),parents:null,income:0};l.income=Yr(l,n),o.push(l)}return o}function zu(n,o){return o.geneEnvWeight*n.meanAllele+(1-o.geneEnvWeight)*n.env}function Cu(n,o){const c=n.map(h=>h.parentIncome),r=O.rank(c),l=c.length+1,s=1/l;n.forEach((h,d)=>{const f=Math.max(r[d]/l,s);h.rawenv=O.normal.inv(f,0,1),h.env=h.rawenv+O.normal.sample(0,o.envNoiseStd)})}function Yr(n,o){function c(l,s){const h=s===0?0:O.normal.sample(0,s),d=Math.exp(Iu+Ru*l+h),f=O.normal.cdf(l,0,1),e=Math.min(Math.max(1-f,Number.EPSILON),1),t=Math.pow(e,-1/Pu);return d*t}const r=c(n.educationScore,o.financeNoise);return o.financeWeight*r+(1-o.financeWeight)*(c(n.rawenv,0)+n.parentIncome*O.beta.sample(.01,1))}function Fu(n,o){const c=n.length;if(n.length<2)throw new Error(`selectMatingPool: need at least two agents, got ${n.length}`);const{homophily:r,kd:i}=o,l=(i==null?void 0:i.kNeighbors)??10,s=125,h=r.gene===1?s:r.gene/(1-r.gene),d=r.env===1?s:r.env/(1-r.env),f=n.map((w,y)=>({meanAllele:w.meanAllele,env:w.env,idx:y})),e=(w,y)=>h*Math.abs(w.meanAllele-y.meanAllele)+d*Math.abs(w.env-y.env),t=new Nu.kdTree(f,e,["meanAllele","env"]);function u(w){const y=w.slice();for(let p=y.length-1;p>0;p--){const b=Math.floor(Math.random()*(p+1));[y[p],y[b]]=[y[b],y[p]]}return y}const a=Math.floor(c/2),m=u(f).slice(0,a),v=[],g=(r.gene+r.env)/2;for(const w of m){let y=-1;if(Math.random()>g)y=Math.floor(Math.random()*c);else{let p=t.nearest(w,l+1).filter(([R])=>R.idx!==w.idx);if(p.length===0)throw new Error(`selectMatingPool: no available mates for agent index ${w.idx}`);const b=p.map(([,R])=>R),_=Math.min(...b),x=b.map(R=>R-_),k=700,N=x.map(R=>Math.min(R,k)).map(R=>Math.exp(-R)),$=N.reduce((R,W)=>R+W,0);let E=Math.random()*$,q=0;for(;E>N[q];)E-=N[q++];y=p[q][0].idx}v.push({a:n[w.idx],b:n[y]})}return v}function Lu(n,o,c){const r=n.a.income+n.b.income,i=[];for(let l=0;l<2;l++){const s={id:c+l,alleles:[Math.random()<.01?O.normal.sample(0,1):n.a.alleles[Math.floor(Math.random()*2)],Math.random()<.01?O.normal.sample(0,1):n.b.alleles[Math.floor(Math.random()*2)]],parentIncome:r,educationScore:0,parents:[{id:n.a.id,alleles:n.a.alleles,meanAllele:n.a.meanAllele,parentIncome:n.a.parentIncome,env:n.a.env,rawenv:n.a.rawenv,educationScore:n.a.educationScore,income:n.a.income,parents:null},{id:n.b.id,alleles:n.b.alleles,meanAllele:n.b.meanAllele,parentIncome:n.b.parentIncome,env:n.b.env,rawenv:n.b.rawenv,educationScore:n.b.educationScore,income:n.b.income,parents:null}]};i.push(s)}return i}function Ou(n,o){const c=Fu(n,o),r=[];let i=0;return c.forEach(l=>{Lu(l,o,i).forEach(h=>{r.push(h),i++})}),Cu(r,o),r.forEach(l=>{const[s,h]=l.alleles;l.meanAllele=(s+h)/2}),r.forEach(l=>{l.educationScore=zu(l,o),l.income=Yr(l,o)}),r}function Hu(n,o){let r=[...n].sort((i,l)=>-i.income+l.income).map(i=>i[o]);return["income","parentIncome"].includes(o)&&(r=r.map(i=>Math.log10(i+1))),r}function Bu(n,o,c,r,i,l=!1){const s=n.getContext("2d"),h=n.width/r,d=n.height/c;s.clearRect(0,0,n.width,n.height),o.forEach((f,e)=>{const t=Math.floor(e/r),u=e%r;s.fillStyle=i(f),s.fillRect(u*h,t*d,h,d)})}function Kr(n){const o=[...n].sort((s,h)=>s.income-h.income),c=o.length,r=mt(o,s=>s.income)||0;let i=0;const l=[[0,0]];return o.forEach((s,h)=>{i+=s.income,l.push([(h+1)/c,r>0?i/r:0])}),l}function Jr(n){if(n.length===0)return 0;const c=Kr(n.map(i=>({income:i})));let r=0;for(let i=1;i<c.length;i++){const[l,s]=c[i-1],[h,d]=c[i];r+=(s+d)/2*(h-l)}return 1-2*r}function Vu(n,o){const c=+n.attr("width"),r=+n.attr("height"),i={top:20,right:20,bottom:30,left:40},l=c-i.left-i.right,s=r-i.top-i.bottom;n.selectAll("*").remove();const h=Kr(o),d=fn().domain([0,1]).range([0,l]),f=fn().domain([0,1]).range([s,0]),e=n.append("g").attr("transform",`translate(${i.left},${i.top})`);e.append("line").attr("x1",d(0)).attr("y1",f(0)).attr("x2",d(1)).attr("y2",f(1)).attr("stroke","#999").attr("stroke-dasharray","4,4");const t=Qr().x(u=>d(u[0])).y(u=>f(u[1]));e.append("path").datum(h).attr("d",t).attr("fill","none").attr("stroke","tomato").attr("stroke-width",2),e.append("g").attr("transform",`translate(0,${s})`).call(Wn(d).ticks(5)),e.append("g").call(ke(f).ticks(5))}function Gu(n,o){const c=+n.attr("width"),r=+n.attr("height"),i={top:20,right:20,bottom:30,left:40},l=c-i.left-i.right,s=r-i.top-i.bottom;n.selectAll("*").remove();const h=fn().domain([0,Math.max(1,o.length-1)]).range([0,l]),d=fn().domain([0,1]).range([s,0]),f=n.append("g").attr("transform",`translate(${i.left},${i.top})`),e=Qr().x((t,u)=>h(u)).y(t=>d(t));f.append("path").datum(o).attr("d",e).attr("fill","none").attr("stroke","steelblue").attr("stroke-width",2),f.append("g").attr("transform",`translate(0,${s})`).call(Wn(h).ticks(5)),f.append("g").call(ke(d).ticks(5))}function Wu(n,o,c=20,r=!1){const i=+n.attr("width"),l=+n.attr("height"),s={top:20,right:20,bottom:75,left:40},h=i-s.left-s.right,d=l-s.top-s.bottom;n.selectAll("*").remove();const f=fn().domain(En(o)).nice().range([0,h]),e=lt().domain(f.domain()).thresholds(c)(o),t=fn().domain([0,Oe(e,a=>a.length)]).nice().range([d,0]),u=n.append("g").attr("transform",`translate(${s.left},${s.top})`);if(u.selectAll("rect").data(e).enter().append("rect").attr("x",a=>f(a.x0)+1).attr("y",a=>t(a.length)).attr("width",a=>Math.max(0,f(a.x1)-f(a.x0)-1)).attr("height",a=>d-t(a.length)).attr("fill","steelblue"),r){const a=dt(o),m=Oe(o),v=ht(1,15).filter(g=>g>a&&g<m);u.append("g").attr("transform",`translate(0,${d})`).call(Wn(f).tickValues(v).tickFormat(g=>ze(",")(Math.pow(10,g)))),u.selectAll("text").attr("text-anchor","end").attr("transform","rotate(-45)").attr("dx","-0.8em").attr("dy","0.15em")}else u.append("g").attr("transform",`translate(0,${d})`).call(Wn(f).ticks(5));u.append("g").call(ke(t).ticks(5))}let Z={...Sn,homophily:{...Sn.homophily}},S=[],ln=[],Ce=0,pn=!1;const Du=750,Uu=document.getElementById("start-btn"),Qu=document.getElementById("pause-btn"),Yu=document.getElementById("reset-btn"),jn=document.getElementById("feature-select"),Ku=document.getElementById("step-btn"),Ju=document.getElementById("status"),Zu=document.getElementById("slider-gene-env"),Xu=document.getElementById("label-gene-env"),Mu=document.getElementById("slider-env-noise"),Su=document.getElementById("label-env-noise"),ju=document.getElementById("slider-fin-weight"),na=document.getElementById("label-fin-weight"),ea=document.getElementById("slider-fin-noise"),ra=document.getElementById("label-fin-noise"),ta=document.getElementById("slider-hom-gene"),ia=document.getElementById("label-hom-gene"),oa=document.getElementById("slider-hom-env"),fa=document.getElementById("label-hom-env"),dn=document.getElementById("raster"),Zr=dn.getContext("2d");if(!Zr)throw new Error("Canvas 2D context not available");dn.width=400;dn.height=400;const ua=Ne("#lorenz"),aa=Ne("#gini"),ca=Ne("#histogram"),sa=document.getElementById("hist-title");function la(n){const o=Math.ceil(Math.sqrt(n));return{rows:Math.ceil(n/o),cols:o}}function wn(n,o,c,r){const i=()=>{const l=parseFloat(n.value);switch(r(l),c){case"geneEnv":o.textContent=`Env ${((1-l)*100).toFixed(0)}% / ${(l*100).toFixed(0)}% Gene`;break;case"finWeight":o.textContent=`Parent wealth ${((1-l)*100).toFixed(0)}% / ${(l*100).toFixed(0)}% Education`;break;case"homEnv":case"homGene":o.textContent=`Random ${((1-l)*100).toFixed(0)}% / ${(l*100).toFixed(0)}% Homophily`;break;case"envNoise":case"finNoise":o.textContent=`Normal(0, ${l.toFixed(2)})`}};n.addEventListener("input",i),i()}const ar={meanAllele:cn(gu),env:cn(yu),educationScore:cn(wu),income:cn(vu),parentIncome:cn(pu)};function Xr(){Z={...Sn,homophily:{...Sn.homophily}},S=Tu(Z),ln.length=0,Ce=0;const n=S.map(o=>o.income);ln.push(Jr(n)),Le()}function Fe(){S=Ou(S,Z);const n=S.map(o=>o.income);ln.push(Jr(n)),Ce+=1,Le(),pn&&setTimeout(Fe,Du)}function Le(){const n=jn.value,o=Hu(S,n);Zr.clearRect(0,0,dn.width,dn.height);const{rows:c,cols:r}=la(o.length),[i,l]=En(o);ar[n].domain([i,l]),Bu(dn,o,c,r,ar[n]),Vu(ua,S),Gu(aa,ln),sa.textContent=`Distribution of ${n}`,Wu(ca,o,20,!!["income","educationScore"].includes(n));const s=ln[ln.length-1]??0;Ju.textContent=`Gen: ${Ce} | Gini: ${s.toFixed(2)} | Pop: ${S.length} | Feature: ${n}`}Uu.addEventListener("click",()=>{pn||(pn=!0,Fe())});Qu.addEventListener("click",()=>{pn=!1});Yu.addEventListener("click",()=>{pn=!1,Xr()});Ku.addEventListener("click",()=>{pn||Fe()});jn.addEventListener("change",Le);wn(Zu,Xu,"geneEnv",n=>Z.geneEnvWeight=n);wn(Mu,Su,"envNoise",n=>Z.envNoiseStd=n);wn(ju,na,"finWeight",n=>Z.financeWeight=n);wn(ea,ra,"finNoise",n=>Z.financeNoise=n);wn(ta,ia,"homGene",n=>Z.homophily.gene=n);wn(oa,fa,"homEnv",n=>Z.homophily.env=n);(function(){["meanAllele","env","educationScore","income","parentIncome"].forEach(o=>{const c=document.createElement("option");c.value=o,c.textContent=o,jn.appendChild(c)}),jn.value="income"})();Xr();
